(self.AMP=self.AMP||[]).push({n:"amp-share-tracking",i:["_base_i","_base_misc"],v:"1904281823091",f:(function(AMP,_){
var $AmpShareTracking$$module$extensions$amp_share_tracking$0_1$amp_share_tracking$$=function($$jscomp$super$this$jscomp$93_element$jscomp$601$$){$$jscomp$super$this$jscomp$93_element$jscomp$601$$=AMP.BaseElement.call(this,$$jscomp$super$this$jscomp$93_element$jscomp$601$$)||this;$$jscomp$super$this$jscomp$93_element$jscomp$601$$.$F$="";$$jscomp$super$this$jscomp$93_element$jscomp$601$$.$D$="";return $$jscomp$super$this$jscomp$93_element$jscomp$601$$},$JSCompiler_StaticMethods_getIncomingFragment_$$=
function($JSCompiler_StaticMethods_getIncomingFragment_$self$$){return $JSCompiler_StaticMethods_getOriginalViewerFragment_$$($JSCompiler_StaticMethods_getIncomingFragment_$self$$).then(function($JSCompiler_StaticMethods_getIncomingFragment_$self$$){return($JSCompiler_StaticMethods_getIncomingFragment_$self$$=$JSCompiler_StaticMethods_getIncomingFragment_$self$$.match(/^\.([^&]*)/))?$JSCompiler_StaticMethods_getIncomingFragment_$self$$[1]:""})},$JSCompiler_StaticMethods_getOriginalViewerFragment_$$=
function($JSCompiler_StaticMethods_getOriginalViewerFragment_$self$$){return _.$Services$$module$src$services$historyForDoc$$($JSCompiler_StaticMethods_getOriginalViewerFragment_$self$$.$getAmpDoc$()).$D$.$HistoryBindingInterface$$module$src$service$history_impl_prototype$getFragment$().then(function($fragment$jscomp$12$$){return $JSCompiler_StaticMethods_getOriginalViewerFragment_$self$$.$D$=$fragment$jscomp$12$$})},$JSCompiler_StaticMethods_getOutgoingFragment_$$=function($JSCompiler_StaticMethods_getOutgoingFragment_$self$$){return $JSCompiler_StaticMethods_getOutgoingFragment_$self$$.$F$?
$JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$$($JSCompiler_StaticMethods_getOutgoingFragment_$self$$,$JSCompiler_StaticMethods_getOutgoingFragment_$self$$.$F$):_.$tryResolve$$module$src$utils$promise$$(function(){var $bytes$jscomp$inline_4241$$=_.$getCryptoRandomBytesArray$$module$src$utils$bytes$$($JSCompiler_StaticMethods_getOutgoingFragment_$self$$.$win$,6);if(!$bytes$jscomp$inline_4241$$){$bytes$jscomp$inline_4241$$=new Uint8Array(6);for(var $random$jscomp$inline_4242$$=Math.random(),
$i$320$jscomp$inline_4243$$=0;6>$i$320$jscomp$inline_4243$$;$i$320$jscomp$inline_4243$$++)$random$jscomp$inline_4242$$*=256,$bytes$jscomp$inline_4241$$[$i$320$jscomp$inline_4243$$]=Math.floor($random$jscomp$inline_4242$$),$random$jscomp$inline_4242$$-=$bytes$jscomp$inline_4241$$[$i$320$jscomp$inline_4243$$]}return _.$base64UrlEncodeFromBytes$$module$src$utils$base64$$($bytes$jscomp$inline_4241$$)})},$JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$$=function($JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$,
$vendorUrl$$){return _.$JSCompiler_StaticMethods_fetchJson$$(_.$Services$$module$src$services$xhrFor$$($JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$.$win$),$vendorUrl$$,{method:"POST",credentials:"include",body:{}}).then(function($JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$){return $JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$.json()}).then(function($json$jscomp$23$$){if($json$jscomp$23$$.$fragment$)return $json$jscomp$23$$.$fragment$;$JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$.$user$().error("amp-share-tracking",
"The response from ["+$vendorUrl$$+"] does not have a fragment value.");return""},function($vendorUrl$$){$JSCompiler_StaticMethods_getOutgoingFragmentFromVendor_$self$$.$user$().error("amp-share-tracking","The request to share-tracking endpoint failed:",$vendorUrl$$);return""})};_.$HistoryBindingNatural_$$module$src$service$history_impl$$.prototype.$HistoryBindingInterface$$module$src$service$history_impl_prototype$updateFragment$=_.$JSCompiler_unstubMethod$$(31,function($fragment$jscomp$3$$){this.replace({$fragment$:$fragment$jscomp$3$$})});
_.$HistoryBindingVirtual_$$module$src$service$history_impl$$.prototype.$HistoryBindingInterface$$module$src$service$history_impl_prototype$updateFragment$=_.$JSCompiler_unstubMethod$$(30,function($fragment$jscomp$4$$){_.$JSCompiler_StaticMethods_hasCapability$$(this.$F$,"fragment")?_.$JSCompiler_StaticMethods_sendMessageAwaitResponse$$(this.$F$,"replaceHistory",_.$dict$$module$src$utils$object$$({fragment:$fragment$jscomp$4$$}),!0):Promise.resolve()});
_.$HistoryBindingNatural_$$module$src$service$history_impl$$.prototype.$HistoryBindingInterface$$module$src$service$history_impl_prototype$getFragment$=_.$JSCompiler_unstubMethod$$(29,function(){var $hash$jscomp$2$$=this.$win$.location.hash;$hash$jscomp$2$$=$hash$jscomp$2$$.substr(1);return Promise.resolve($hash$jscomp$2$$)});
_.$HistoryBindingVirtual_$$module$src$service$history_impl$$.prototype.$HistoryBindingInterface$$module$src$service$history_impl_prototype$getFragment$=_.$JSCompiler_unstubMethod$$(28,function(){return _.$JSCompiler_StaticMethods_hasCapability$$(this.$F$,"fragment")?_.$JSCompiler_StaticMethods_sendMessageAwaitResponse$$(this.$F$,"getFragment",void 0,!0).then(function($data$jscomp$79_hash$jscomp$3$$){if(!$data$jscomp$79_hash$jscomp$3$$)return"";"#"==$data$jscomp$79_hash$jscomp$3$$[0]&&($data$jscomp$79_hash$jscomp$3$$=
$data$jscomp$79_hash$jscomp$3$$.substr(1));return $data$jscomp$79_hash$jscomp$3$$}):Promise.resolve("")});_.$$jscomp$inherits$$($AmpShareTracking$$module$extensions$amp_share_tracking$0_1$amp_share_tracking$$,AMP.BaseElement);$AmpShareTracking$$module$extensions$amp_share_tracking$0_1$amp_share_tracking$$.prototype.$isLayoutSupported$=function($layout$jscomp$101$$){return"nodisplay"==$layout$jscomp$101$$||"container"==$layout$jscomp$101$$};
$AmpShareTracking$$module$extensions$amp_share_tracking$0_1$amp_share_tracking$$.prototype.$buildCallback$=function(){var $$jscomp$this$jscomp$875$$=this;_.$isExperimentOn$$module$src$experiments$$(this.$win$,"amp-share-tracking")||_.$registerServiceBuilder$$module$src$service$$(this.$win$,"share-tracking",function(){return Promise.reject(_.$user$$module$src$log$$().$createError$("%s disabled","amp-share-tracking"))});this.$F$=this.element.getAttribute("data-href");"amp-share-tracking";var $shareTrackingFragments$$=
Promise.all([$JSCompiler_StaticMethods_getIncomingFragment_$$(this),$JSCompiler_StaticMethods_getOutgoingFragment_$$(this)]).then(function($shareTrackingFragments$$){var $outgoingFragment_results$jscomp$26$$=$shareTrackingFragments$$[0];$shareTrackingFragments$$=$shareTrackingFragments$$[1];"amp-share-tracking";"amp-share-tracking";if($shareTrackingFragments$$&&""!=$shareTrackingFragments$$){var $JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$=
$outgoingFragment_results$jscomp$26$$?$$jscomp$this$jscomp$875$$.$D$.substr($outgoingFragment_results$jscomp$26$$.length+1):$$jscomp$this$jscomp$875$$.$D$;var $JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$="."+$shareTrackingFragments$$;$JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$&&("&"!=$JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$[0]&&
($JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$+="&"),$JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$+=$JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$);$JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$=
_.$Services$$module$src$services$historyForDoc$$($$jscomp$this$jscomp$875$$.$getAmpDoc$());"#"==$JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$[0]&&($JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$=$JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$.substr(1));$JSCompiler_StaticMethods_History$$module$src$service$history_impl_prototype$updateFragment$self$jscomp$inline_4237_fragmentResidual$jscomp$inline_4234$$.$D$.$HistoryBindingInterface$$module$src$service$history_impl_prototype$updateFragment$($JSCompiler_inline_result$jscomp$921_fragment$jscomp$inline_4238_result$jscomp$inline_4235$$)}return{$incomingFragment$:$outgoingFragment_results$jscomp$26$$,
$outgoingFragment$:$shareTrackingFragments$$}});_.$registerServiceBuilder$$module$src$service$$(this.$win$,"share-tracking",function(){return $shareTrackingFragments$$})};self.AMP.registerElement("amp-share-tracking",$AmpShareTracking$$module$extensions$amp_share_tracking$0_1$amp_share_tracking$$);
})});

//# sourceMappingURL=amp-share-tracking-0.1.js.map
