(self.AMP=self.AMP||[]).push({n:"amp-viewer-assistance",i:["_base_i","_base_misc"],v:"1904281823091",f:(function(AMP,_){
var $AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$=function($ampdoc$jscomp$260$$){var $assistanceElement$$=$ampdoc$jscomp$260$$.getElementById("amp-viewer-assistance");if(this.$G$=!!$assistanceElement$$)this.$ampdoc_$=$ampdoc$jscomp$260$$,this.$F$=$assistanceElement$$,this.$J$=_.$tryParseJson$$module$src$json$$(this.$F$.textContent,function($ampdoc$jscomp$260$$){throw _.$user$$module$src$log$$().$createError$('Failed to parse "amp-viewer-assistance" JSON: '+
$ampdoc$jscomp$260$$);}),this.$D$=_.$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$260$$),this.$I$=_.$Services$$module$src$services$actionServiceForDoc$$(this.$F$),this.$K$=_.$Services$$module$src$services$vsyncFor$$($ampdoc$jscomp$260$$.$win$)},$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$$=function($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$){return $JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$G$?
_.$JSCompiler_StaticMethods_isTrustedViewer$$($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$D$).then(function($isTrustedViewer$jscomp$1$$){if(!$isTrustedViewer$jscomp$1$$&&!_.$isExperimentOn$$module$src$experiments$$($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$ampdoc_$.$win$,"amp-viewer-assistance-untrusted"))return $JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$G$=
!1,_.$user$$module$src$log$$().error("amp-viewer-assistance","amp-viewer-assistance is currently only supported on trusted viewers."),$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$;_.$JSCompiler_StaticMethods_installActionHandler$$(0,$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$F$,$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$M$.bind($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$));
$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$H$();_.$JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$sendMessage$$($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$D$,"viewerAssistanceConfig",_.$dict$$module$src$utils$object$$({config:$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$.$J$}));
return $JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$}):(_.$user$$module$src$log$$().error("amp-viewer-assistance","Could not find #amp-viewer-assistance element."),$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$self$$)},$JSCompiler_StaticMethods_requestSignIn_$$=function($JSCompiler_StaticMethods_requestSignIn_$self$$){_.$JSCompiler_StaticMethods_sendMessageAwaitResponse$$($JSCompiler_StaticMethods_requestSignIn_$self$$.$D$,
"requestSignIn",_.$dict$$module$src$utils$object$$({providers:["actions-on-google-gsi"]})).then(function($token$jscomp$42$$){_.$user$$module$src$log$$().$Log$$module$src$log_prototype$info$("amp-viewer-assistance","Token: "+$token$jscomp$42$$);$token$jscomp$42$$?($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$$($JSCompiler_StaticMethods_requestSignIn_$self$$,!0),$JSCompiler_StaticMethods_requestSignIn_$self$$.$I$.$trigger$($JSCompiler_StaticMethods_requestSignIn_$self$$.$F$,
"signedIn",null,100)):$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$$($JSCompiler_StaticMethods_requestSignIn_$self$$,!1)})},$JSCompiler_StaticMethods_validateAndTransformUpdateArgs_$$=function($args$jscomp$66$$){if(!$args$jscomp$66$$)return Promise.reject('"updateActionState" was called with no arguments!"');var $actionStatus_update$jscomp$2$$=$args$jscomp$66$$.update,$error$jscomp$117$$=$args$jscomp$66$$.error;
return $error$jscomp$117$$&&$actionStatus_update$jscomp$2$$?Promise.reject('"updateActionState" must have only one of the parameters "error" and "update".'):$error$jscomp$117$$?$error$jscomp$117$$&&"function"===typeof $error$jscomp$117$$.text?$error$jscomp$117$$.text().then(function($args$jscomp$66$$){return _.$dict$$module$src$utils$object$$({update:{actionStatus:"FAILED_ACTION_STATUS",result:{code:$error$jscomp$117$$.status,message:$args$jscomp$66$$}}})}):Promise.reject('"updateActionState" action "error" parameter must contain a valid "response" object.'):
$actionStatus_update$jscomp$2$$?($actionStatus_update$jscomp$2$$=$actionStatus_update$jscomp$2$$&&$actionStatus_update$jscomp$2$$.actionStatus)&&$ACTION_STATUS_WHITELIST$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$.includes($actionStatus_update$jscomp$2$$)?Promise.resolve($args$jscomp$66$$):Promise.reject('"updateActionState" action "update" parameter must contain a valid "actionStatus" field.'):Promise.reject('"updateActionState" action must have an "update" or "error" parameter.')},
$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$$=function($JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$self$$,$on$jscomp$12$$){$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$self$$.$K$.$mutate$(function(){var $root$jscomp$inline_5596$$=
$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$self$$.$ampdoc_$.getRootNode();($root$jscomp$inline_5596$$.documentElement||$root$jscomp$inline_5596$$.body||$root$jscomp$inline_5596$$).classList.toggle("amp-viewer-assistance-identity-available",$on$jscomp$12$$)})},$ACTION_STATUS_WHITELIST$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$=["ACTIVE_ACTION_STATUS","FAILED_ACTION_STATUS","COMPLETED_ACTION_STATUS"];
$AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$.prototype.$M$=function($invocation$jscomp$50$$){var $$jscomp$this$jscomp$1396$$=this,$method$jscomp$36$$=$invocation$jscomp$50$$.method,$args$jscomp$64$$=$invocation$jscomp$50$$.args;"updateActionState"==$method$jscomp$36$$?_.$JSCompiler_StaticMethods_satisfiesTrust$$($invocation$jscomp$50$$,1)&&$JSCompiler_StaticMethods_validateAndTransformUpdateArgs_$$($args$jscomp$64$$).then(function($invocation$jscomp$50$$){return _.$JSCompiler_StaticMethods_sendMessageAwaitResponse$$($$jscomp$this$jscomp$1396$$.$D$,
$method$jscomp$36$$,$invocation$jscomp$50$$)}).catch(function($invocation$jscomp$50$$){_.$user$$module$src$log$$().error("amp-viewer-assistance",$invocation$jscomp$50$$.toString())}):"signIn"==$method$jscomp$36$$&&_.$JSCompiler_StaticMethods_satisfiesTrust$$($invocation$jscomp$50$$,100)&&$JSCompiler_StaticMethods_requestSignIn_$$(this);return null};
$AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$.prototype.$H$=function(){var $$jscomp$this$jscomp$1398$$=this;return _.$JSCompiler_StaticMethods_sendMessageAwaitResponse$$(this.$D$,"getAccessTokenPassive",_.$dict$$module$src$utils$object$$({providers:["actions-on-google-gsi"]})).then(function($token$jscomp$41$$){$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$$($$jscomp$this$jscomp$1398$$,
!!$token$jscomp$41$$);return $token$jscomp$41$$}).catch(function(){$JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$toggleTopClass_$$($$jscomp$this$jscomp$1398$$,!1)})};(function($AMP$jscomp$122$$){$AMP$jscomp$122$$.registerServiceForDoc("amp-viewer-assistance",function($AMP$jscomp$122$$){return $JSCompiler_StaticMethods_AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance_prototype$start_$$(new $AmpViewerAssistance$$module$extensions$amp_viewer_assistance$0_1$amp_viewer_assistance$$($AMP$jscomp$122$$))})})(self.AMP);
})});

//# sourceMappingURL=amp-viewer-assistance-0.1.js.map
