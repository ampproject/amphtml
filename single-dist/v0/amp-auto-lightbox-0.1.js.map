{"version":3,"sources":["/extensions/amp-auto-lightbox/0.1/utils/promise.js","/extensions/amp-auto-lightbox/0.1/carousel-criteria.js","/extensions/amp-auto-lightbox/0.1/amp-auto-lightbox.js","/src/common-signals.js","/src/custom-element.js","/src/auto-lightbox.js","/src/amp-events.js"],"names":["resolveFalse","tryResolve","resolveTrue","meetsAll","element","isExperimentOn","ownerDocument","defaultView","slides","querySelectorAll","images","length","promise","iterateCursor","slide","then","previousWasAccepted","SlideCriteria$$module$extensions$amp_auto_lightbox$0_1$carousel_criteria.meetsAll","tagName","isActionableByTap","img","querySelector","SlideCriteria$$module$extensions$amp_auto_lightbox$0_1$carousel_criteria.meetsSizingCriteria","slideMeetsSizingPromise","slideMeetsSizingCriteria","meetsSizingCriteria","getImpl","impl","Promise","resolve","measureElement","getLayoutBox","imgWidth","imgHeight","getBoundingClientRect","MIN_IMG_SLIDE_AREA_RATIO","slideWidth","slideHeight","NOOP","toUpperCase","naturalWidth","naturalHeight","renderWidth","renderHeight","Services$$module$src$services.viewportForDoc","viewport","getSize","vw","vh","renderArea","RENDER_AREA_RATIO","VIEWPORT_AREA_RATIO","disabledAncestor","closestAncestorElementBySelector","disabledSelector","matches","DISABLED_BY_ATTR","hasResolvableAction","Services$$module$src$services.actionServiceForDoc","actions","CarouselCriteria$$module$extensions$amp_auto_lightbox$0_1$carousel_criteria.meetsAll","markAsVisited","candidate","Mutation$$module$extensions$amp_auto_lightbox$0_1$amp_auto_lightbox.mutate","setAttribute","VISITED_ATTR","candidateSelector","whenLoaded","whenUpgradedToCustomElement","signals","whenSignal","LOAD_END","getAllLdJsonTypes","ampdoc","toArray","getRootNode","SCRIPT_LD_JSON","map","tryParseJson","textContent","filter","typeOrUndefined","hasValidLdJsonType","DocMetaAnnotations$$module$extensions$amp_auto_lightbox$0_1$amp_auto_lightbox.getAllLdJsonTypes","some","type","ENABLED_LD_JSON_TYPES","mutate","ampEl","mutator","resources_","mutateElement","apply","LIGHTBOXABLE_ATTR","uid","installExtensionForDoc","Services$$module$src$services.extensionsFor","win","REQUIRED_EXTENSION","dispatchCustomEvent","NEWLY_SET","runCandidates","candidates","Criteria$$module$extensions$amp_auto_lightbox$0_1$amp_auto_lightbox.meetsAll","dev","info","TAG","scan","opt_root","requiredExtensionSelector","lightboxedElementsSelector","tag","META_OG_TYPE","getAttribute","getMode","localDev","test","firstElementChild","getBody","isProxyOrigin","Services$$module$src$services.urlForDoc","location","root","document","selector","CANDIDATES","join","forEach","whenReady","addEventListener","DOM_UPDATE","target"],"mappings":"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","file":"amp-auto-lightbox-0.1.js","sourcesContent":[]}