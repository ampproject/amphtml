{"version":3,"sources":["/extensions/amp-share-tracking/0.1/amp-share-tracking.js","/src/service/history-impl.js","/src/utils/object.js","/src/layout.js"],"names":["constructor","element","vendorHref_","originalViewerFragment_","getIncomingFragment_","getOriginalViewerFragment_","then","fragment","match","Services$$module$src$services.historyForDoc","getFragment","getHistory_","getAmpDoc","binding_","getOutgoingFragment_","getOutgoingFragmentFromVendor_","tryResolve","bytes","getCryptoRandomBytesArray","getShareTrackingRandomBytes_","win","SHARE_TRACKING_NUMBER_OF_BYTES","Uint8Array","random","Math","i","floor","base64UrlEncodeFromBytes","vendorUrl","fetchJson","Services$$module$src$services.xhrFor","postReq","method","credentials","body","res","json","user","error","TAG","err","updateFragment","replace","hasCapability","viewer_","sendMessageAwaitResponse","dict","Promise","resolve","hash","location","substr","undefined","data","$jscomp.inherits","BaseElement","AmpShareTracking","AMP","isLayoutSupported","layout","NODISPLAY","CONTAINER","buildCallback","isExperimentOn","isExperimentOn_","registerServiceBuilder","reject","createError","getAttribute","shareTrackingFragments","all","results","incomingFragment","outgoingFragment","fragmentResidual","getNewViewerFragment_","length","result","registerElement"],"mappings":"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","file":"amp-share-tracking-0.1.js","sourcesContent":[]}