<!doctype html>
<html âš¡>
<head>
  <meta charset="utf-8">
  <title>Ad visible repeat examples</title>
  <link rel="canonical" href="http://nonblocking.io/" >
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <style amp-custom>
    amp-ad {
      border: 2px solid red;
      padding: 0;
      margin: 0;
    }
    /* Included here to make sure it does not render. */
    .fixed {
      position: fixed;
      bottom: 0;
      right: 0;
      background-color: #eee;
      opacity: .8;
    }

    .fill {
      height: 750px;
      width: 10px;
      background-color: yellow;
      opacity: 0.2;
    }
  </style>
  <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src="https://cdn.ampproject.org/v0.js"></script>

</head>

<body>
  <amp-analytics>
    <script type="application/json">
      {
        "transport": {"beacon": false, "xhrpost": false},
        "requests": {
          "base": "fake.com/ad1?repeat=true"
        },
        "triggers": {
          "repeat": {
            "on": "visible",
            "request": "base",
            "visibilitySpec": {
              "selector": "#ad1",
              "visiblePercentageMin": "0",
              "repeat": true
            }
          }
        }
      }
    </script>
  </amp-analytics>
  <!-- `"selector": [".myClass", "#ad2"]` will only fire 1 request for ad2 -->
  <!-- `"selector": [".myClass"]` will not pick up ad1 because it does not have the specifed class -->
  <!-- `"selector": [".myClass"]` will not pick up ad4 because it has not data-vars-* attribute -->
  <amp-analytics>
    <script type="application/json">
      {
        "transport": {"beacon": false, "xhrpost": false},
        "requests": {
          "base": "fake.com/ad?multiVisible=true&adId=${id}",
          "queryAll": "fake.com/ad?querySelectorAll=true&adId=${id}"
        },
        "triggers": {
          "multiVisible": {
            "on": "visible",
            "request": "base",
            "selector": ["#ad1","#ad2"]
          },
          "querySelectorAll": {
            "on": "visible",
            "request": "queryAll",
            "selector": [".myClass"]
          }
        }
      }
    </script>
  </amp-analytics>
  <amp-analytics>
    <script type="application/json">
      {
        "transport": {"beacon": false, "xhrpost": false},
        "requests": {
          "base": "fake.com/ad1?repeat=true&continuousTimeMin=2000"
        },
        "triggers": {
          "repeat": {
            "on": "visible",
            "request": "base",
            "visibilitySpec": {
              "visiblePercentageMin": "0",
              "continuousTimeMin": 2000
            }
          }
        }
      }
    </script>
  </amp-analytics>
  <amp-analytics>
    <script type="application/json">
      {
        "transport": {"beacon": false, "xhrpost": false},
        "requests": {
          "base": "fake.com/ad1?repeat=true&continuousTimeMin=2000"
        },
        "triggers": {
          "repeat": {
            "on": "visible",
            "request": "base",
            "visibilitySpec": {
              "selector": "#ad1",
              "visiblePercentageMin": "0",
              "continuousTimeMin": 2000,
              "repeat": true
            }
          }
        }
      }
    </script>
  </amp-analytics>
  <amp-analytics>
    <script type="application/json">
      {
        "transport": {"beacon": false, "xhrpost": false},
        "requests": {
          "base": "fake.com/ad2?repeat=true&totalTimeMin=250"
        },
        "triggers": {
          "repeat": {
            "on": "visible",
            "request": "base",
            "visibilitySpec": {
              "selector": "#ad2",
              "visiblePercentageMin": "0",
              "totalTimeMin": 250,
              "repeat": true
            }
          }
        }
      }
    </script>
  </amp-analytics>
  <div class='fill'></div>
  <div>
    <amp-ad id='ad1' width=300 height=250
        type="_ping_"
        data-url='https://lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n'
        data-valid='true'
        data-vars-id='ad1'
        data-ad-width=300
        data-ad-height=250>
    </amp-ad>

    <amp-ad id='ad2' width=300 height=250
        type="_ping_"
        data-url='https://lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n'
        data-valid='true'
        data-vars-id='ad2'
        data-ad-width=300
        data-ad-height=250
        class="myClass">
    </amp-ad>

    <amp-ad id='ad3' width=300 height=250
        type="_ping_"
        data-url='https://lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n'
        data-valid='true'
        data-vars-id='ad3'
        data-ad-width=300
        data-ad-height=250
        class="myClass">
    </amp-ad>

    <amp-ad id='ad4' width=300 height=250
        type="_ping_"
        data-url='https://lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n'
        data-valid='true'
        data-ad-width=300
        data-ad-height=250
        class="myClass">
    </amp-ad>


  </div>
  <script>
    setTimeout(() => {
      AMP.toggleExperiment('multi-selector-visibility-trigger', true);
    }, 500);
  </script>
</body>
</html>
