<!doctype html>
<html âš¡ lang="en">
<head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-list" src="https://cdn.ampproject.org/v0/amp-list-0.1.js"></script>
    <script async custom-element="amp-script" src="https://cdn.ampproject.org/v0/amp-script-0.1.js"></script>
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
    <style amp4email-boilerplate>body{visibility:hidden}</style>
</head>
<body>
    <amp-script id="fns" script="local-script" nodom data-ampdevmode ></amp-script>
    <script type="text/plain" target="amp-script" id="local-script">
      let count = 0;
      function fetchData() {
        if (count >= 5) {
          return {items: []};
        }
        count++;
        const items = [{name: 'apple'}, {name: 'banana'}, {name: 'pear'}];
        return Promise.resolve({items, "load-more-src": "amp-script:fns.fetchData"});
      }

      exportFunction('fetchData', fetchData);
    </script>
    <amp-list
      id="list1"
      width="auto"
      height="100"
      layout="fixed-height"
      src="amp-script:fns.fetchData"
      load-more="auto"
    >
      <template type="amp-mustache" id="amp-template-id">
        <div>{{name}}</div>
      </template>
    </amp-list>
  </body>

</html>
