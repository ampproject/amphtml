version: 2.1

push_and_pr_builds: &push_and_pr_builds
  filters:
    branches:
      ignore:
        - nightly

executors:
  base-docker-small:
    docker:
      - image: cimg/base:stable
    resource_class: small

jobs:
  test_context_unusable:
    executor:
      name: base-docker-small
    steps:
      - run:
          name: 'SECRET_VAR'
          command: echo "${SECRET_VAR}"

workflows:
  version: 2

  'CircleCI':
    jobs:
      - test_context_unusable:
          name: 'Test Context Unusable'
          <<: *push_and_pr_builds
          context:
            - release-build-uploader
