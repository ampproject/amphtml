# Bento Stream Gallery

## Использование

Компонент Bento Stream Gallery предназначен для отображения нескольких похожих фрагментов содержимого по горизонтальной оси. Для реализации более персонализированного UX используйте [`bento-base-carousel`](../../amp-base-carousel/1.0/README.md).

Используйте Bento Stream Gallery в виде веб-компонента ([`<bento-stream-gallery>`](#web-component)) или как функциональный компонент Preact/React ([`<BentoStreamGallery>`](#preactreact-component)).

### Веб-компонент

Чтобы гарантировать правильную загрузку, вы должны подключить необходимые CSS-библиотеки всех компонентов Bento (это нужно сделать перед добавлением пользовательских стилей). Как вариант, вы можете использовать встраиваемые облегченные стили от предыдущей версии компонента. См. [Макет и стиль](#layout-and-style).

Представленные ниже примеры демонстрируют использование веб-компонента `<bento-stream-gallery>`.

#### Пример: импорт через npm

[example preview="top-frame" playground="false"]

Установка через npm:

```sh
npm install @ampproject/bento-stream-gallery
```

```javascript
import '@ampproject/bento-stream-gallery';
```

[/example]

#### Пример: подключение через `<script>`

В примере ниже представлен компонент `bento-stream-gallery` с тремя разделами. Атрибут `expanded` в третьем разделе разворачивает его при загрузке страницы.

[example preview="top-frame" playground="false"]

```html
<head>
  <script src="https://cdn.ampproject.org/custom-elements-polyfill.js"></script>
  <script async src="https://cdn.ampproject.org/v0/bento-stream-gallery-1.0.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.ampproject.org/v0/amp-streamGallery-1.0.css">

</head>
<body>
  <bento-stream-gallery>
    <img src="img1.png">
    <img src="img2.png">
    <img src="img3.png">
    <img src="img4.png">
    <img src="img5.png">
    <img src="img6.png">
    <img src="img7.png">
  </bento-stream-gallery>
  <script>
    (async () => {
      const streamGallery = document.querySelector('#my-stream-gallery');
      await customElements.whenDefined('bento-stream-gallery');
      const api = await streamGallery.getApi();

      // programatically expand all sections
      api.next();
      // programatically collapse all sections
      api.prev();
      // programatically go to slide
      api.goToSlide(4);
    })();
  </script>
</body>
```

[/example]

#### Интерактивность и использование API

API компонентов с поддержкой Bento позволяет обеспечить высокий уровень интерактивности при использовании их в качестве автономных веб-компонентов. Чтобы получить доступ к API компонента `bento-stream-gallery`, включите в документ тег script со следующим содержимым:

```javascript
await customElements.whenDefined('bento-stream-gallery');
const api = await streamGallery.getApi();
```

##### Действия

**next()**

Перелистывает кольцевую галерею вперед на видимое количество слайдов.

```js
api.next();
```

**prev()**

Перелистывает кольцевую галерею назад на видимое количество слайдов.

```js
api.prev();
```

**goToSlide(index: number)**

Переходит к слайду кольцевой галереи под номером, соответствующим аргументу `index`. Примечание: если значение `index` ниже <code>0</code> или выше максимального значения, то выбирается слайд с ближайшим допустимым номером.

```js
api.goToSlide(0); // Advance to first slide.
api.goToSlide(length - 1); // Advance to last slide.
```

##### События

Компонент Bento Stream Gallery позволяет регистрировать и отвечать на следующие события:

**slideChange**

Это событие срабатывает при смене слайда, отображаемого кольцевой галереей. Получить новый индекс можно при помощи `event.data.index`.

```js
streamGallery.addEventListener('slideChange', (e) => console.log(e.data.index))
```

#### Макет и стиль

У каждого компонента Bento есть небольшая библиотека CSS, которую следует подключать, чтобы гарантировать правильную загрузку без [сдвигов содержимого](https://web.dev/cls/). Поскольку приоритетность CSS определяется порядком, следует вручную убедиться, что таблицы стилей подключаются раньше каких-либо пользовательских стилей.

```html
<link rel="stylesheet" type="text/css" href="https://cdn.ampproject.org/v0/amp-streamGallery-1.0.css">
```

Как вариант, вы также можете использовать встраиваемые облегченные стили от предыдущей версии компонента:

```html
<style data-bento-boilerplate>
  bento-stream-gallery {
    display: block;
    overflow: hidden;
    position: relative;
  }
</style>
```

#### Атрибуты

##### Поведение

###### `controls`

`"always"`, `"auto"` или `"never"`, по умолчанию — `"auto"`. Управляет отображением навигационных стрелок для перелистывания галереи. Примечание: когда `outset-arrows` имеет значение `true`, стрелки показываются всегда (`"always"`).

-   `always`: стрелки отображаются всегда.
-   `auto`: стрелки отображаются в том случае, если пользователь в последний раз взаимодействовал с галереей при помощи мыши, а не касания. На сенсорных устройствах после загрузки элемента стрелки будут отображаться до первого взаимодействия пользователя с галереей.
-   `never`: стрелки не отображаются.

###### `extra-space`

`"around"` или неопределенное значение. Определяет способ распределения пустого пространства, остающегося после отрисовки всех видимых слайдов кольцевой галереи. `"around"` означает, что пространство вокруг галереи распределяется равномерно при помощи `justify-content: center`; в противном случае пустое пространство располагается справа от галереи, если документ использует направление слева направо, или слева от нее, если используется направление справа налево.

###### `loop`

`true` или `false`, по умолчанию — `true`. Разрешает пользователю переходить от последнего элемента галереи к первому и наоборот. Для работы этой возможности необходимо, чтобы в галерее было как минимум три слайда.

###### `outset-arrows`

`true` или `false`, по умолчанию — `false`. «true» означает, что стрелки отображаются за пределами кольцевой галереи, справа и слева от слайдов; обратите внимание, что при этом фактическая ширина контейнера со слайдами сокращается на 100px по сравнению с исходной (по 50px на стрелку с каждой стороны). «false» означает, что стрелки отображаются поверх галереи, возле правого и левого краев слайдов.

###### `peek`

Число, по умолчанию — `0`. Определяет, какую часть дополнительного слайда (по одну или по обе стороны от текущего слайда) следует показывать, чтобы дать пользователю понять, что кольцевую галерею можно перелистывать.

##### Видимость слайдов в галерее

###### `min-visible-count`

Число, по умолчанию — `1`. Определяет минимальное количество одновременно отображаемых слайдов. Можно указать дробное значение, чтобы сделать дополнительный слайд или слайды видимыми частично.

###### `max-visible-count`

Число, по умолчанию — [`Number.MAX_VALUE`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE). Определяет максимальное количество одновременно отображаемых слайдов. Можно указать дробное значение, чтобы сделать дополнительный слайд или слайды видимыми частично.

###### `min-item-width`

Число, по умолчанию — `1`. Определяет минимальную ширину каждого элемента. Используется для определения числа видимых полностью элементов, отображаемых одновременно исходя из общей ширины галереи.

###### `max-item-width`

Число, по умолчанию — [`Number.MAX_VALUE`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE). Определяет максимальную ширину каждого элемента. Используется для определения числа видимых полностью элементов, отображаемых одновременно исходя из общей ширины галереи.

##### Привязка положения прокрутки слайдов

###### `slide-align`

`start` или `center`. «start» означает, что начало слайда (т. е. левый или верхний край, в зависимости от направления выравнивания) выравнивается по левому или верхнему краю кольцевой галереи. «center» означает, что центр слайда выравнивается относительно центра галереи.

###### `snap`

`true` или `false`, по умолчанию — `true`. Включает привязку к слайдам при прокрутке кольцевой галереи.

#### Стилизация

Вы можете использовать селектор элемента `bento-stream-gallery` для свободной стилизации элемента streamGallery.

### Компонент для Preact/React

В приведенных ниже примерах демонстрируется использование `<BentoStreamGallery>` в качестве функционального компонента, который можно использовать с библиотеками Preact или React.

#### Пример: импорт через npm

[example preview="top-frame" playground="false"]

Установка через npm:

```sh
npm install @ampproject/bento-stream-gallery
```

```javascript
import React from 'react';
import { BentoStreamGallery } from '@ampproject/bento-stream-gallery/react';
import '@ampproject/bento-stream-gallery/styles.css';

function App() {
  return (
    <BentoStreamGallery>
      <img src="img1.png">
      <img src="img2.png">
      <img src="img3.png">
      <img src="img4.png">
      <img src="img5.png">
      <img src="img6.png">
      <img src="img7.png">
    </BentoStreamGallery>
  );
}
```

[/example]

#### Интерактивность и использование API

API компонентов Bento предоставляет высокий уровень интерактивности. Для доступа к API компонента `BentoStreamGallery` необходимо передать компоненту `ref`:

```javascript
import React, {createRef} from 'react';
const ref = createRef();

function App() {
  return (
    <BentoStreamGallery ref={ref}>
      <img src="img1.png">
      <img src="img2.png">
      <img src="img3.png">
      <img src="img4.png">
      <img src="img5.png">
      <img src="img6.png">
      <img src="img7.png">
    </BentoStreamGallery>
  );
}
```

##### Действия

API компонента `BentoStreamGallery` позволяет выполнять следующие действия:

**next()**

Перелистывает кольцевую галерею вперед на заданное атрибутом <code>advanceCount</code> число слайдов.

```javascript
ref.current.next();
```

**prev()**

Перелистывает кольцевую галерею назад на заданное атрибутом <code>advanceCount</code> число слайдов.

```javascript
ref.current.prev();
```

**goToSlide(index: number)**

Переходит к слайду кольцевой галереи под номером, соответствующим аргументу `index`. Примечание: если значение `index` ниже `0` или выше максимального значения, то выбирается слайд с ближайшим допустимым номером.

```javascript
ref.current.goToSlide(0); // Advance to first slide.
ref.current.goToSlide(length - 1); // Advance to last slide.
```

##### События

**onSlideChange**

Это событие срабатывает при смене слайда, отображаемого кольцевой галереей.

```jsx
<BentoStreamGallery onSlideChange={(index) => console.log(index)}>
  <img src="puppies.jpg" />
  <img src="kittens.jpg" />
  <img src="hamsters.jpg" />
</BentoStreamGallery>
```

#### Макет и стиль

**Тип контейнера**

Компонент `BentoStreamGallery` использует тип макета с указанием размера. Чтобы обеспечить правильный рендеринг компонента, необходимо указать размер самого компонента и его непосредственных дочерних элементов при помощи свойств CSS (например, <code>width</code>). Их можно указывать как непосредственно в коде:

```jsx
<BentoStreamGallery style={{width: '300px'}}>
  ...
</BentoStreamGallery>
```

...так и при помощи `className`:

```jsx
<BentoStreamGallery className='custom-styles'>
  ...
</BentoStreamGallery>
```

```css
.custom-styles {
  background-color: red;
}
```

#### Props

##### Общие props

Компонент поддерживает [props](../../../docs/spec/bento-common-props.md), являющиеся общими для всех компонентов React и Preact.

##### Поведение

###### `controls`

`"always"`, `"auto"` или `"never"`, по умолчанию — `"auto"`. Управляет отображением навигационных стрелок для перелистывания галереи. Примечание: когда `outset-arrows` имеет значение `true`, стрелки показываются всегда (`"always"`).

-   `always`: стрелки отображаются всегда.
-   `auto`: стрелки отображаются в том случае, если пользователь в последний раз взаимодействовал с галереей при помощи мыши, а не касания. На сенсорных устройствах после загрузки элемента стрелки будут отображаться до первого взаимодействия пользователя с галереей.
-   `never`: стрелки не отображаются.

###### `extraSpace`

`"around"` или неопределенное значение. Определяет способ распределения пустого пространства, остающегося после отрисовки всех видимых слайдов кольцевой галереи. `"around"` означает, что пространство вокруг галереи распределяется равномерно при помощи `justify-content: center`; в противном случае пустое пространство располагается справа от галереи, если документ использует направление слева направо, или слева от нее, если используется направление справа налево.

###### `loop`

`true` или `false`, по умолчанию — `true`. Разрешает пользователю переходить от последнего элемента галереи к первому и наоборот. Для работы этой возможности необходимо, чтобы в галерее было как минимум три слайда.

###### `outsetArrows`

`true` или `false`, по умолчанию — `false`. «true» означает, что стрелки отображаются за пределами кольцевой галереи, справа и слева от слайдов; обратите внимание, что при этом фактическая ширина контейнера со слайдами сокращается на 100px по сравнению с исходной (по 50px на стрелку с каждой стороны). «false» означает, что стрелки отображаются поверх галереи, возле правого и левого краев слайдов.

###### `peek`

Число, по умолчанию — `0`. Определяет, какую часть дополнительного слайда (по одну или по обе стороны от текущего слайда) следует показывать, чтобы дать пользователю понять, что кольцевую галерею можно перелистывать.

##### Видимость слайдов в галерее

###### `minVisibleCount`

Число, по умолчанию — `1`. Определяет минимальное количество одновременно отображаемых слайдов. Можно указать дробное значение, чтобы сделать дополнительный слайд или слайды видимыми частично.

###### `maxVisibleCount`

Число, по умолчанию — [`Number.MAX_VALUE`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE). Определяет максимальное количество одновременно отображаемых слайдов. Можно указать дробное значение, чтобы сделать дополнительный слайд или слайды видимыми частично.

###### `minItemWidth`

Число, по умолчанию — `1`. Определяет минимальную ширину каждого элемента. Используется для определения числа видимых полностью элементов, отображаемых одновременно исходя из общей ширины галереи.

###### `maxItemWidth`

Число, по умолчанию — [`Number.MAX_VALUE`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE). Определяет максимальную ширину каждого элемента. Используется для определения числа видимых полностью элементов, отображаемых одновременно исходя из общей ширины галереи.

##### Привязка положения прокрутки слайдов

###### `slideAlign`

`start` или `center`. «start» означает, что начало слайда (т. е. левый или верхний край, в зависимости от направления выравнивания) выравнивается по левому или верхнему краю кольцевой галереи. «center» означает, что центр слайда выравнивается относительно центра галереи.

###### `snap`

`true` или `false`, по умолчанию — `true`. Включает привязку к слайдам при прокрутке кольцевой галереи.
