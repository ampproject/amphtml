(self.AMP=self.AMP||[]).push({n:"extensions-amp-access-0.1-amp-access.js", v:"erwin", f:(function(){var $base64UrlDecodeSubs$$module$src$utils$base64$$={"-":"+",_:"/",".":"="};function $base64UrlDecodeToBytes$$module$src$utils$base64$$($str$jscomp$11$$){var $encoded$$=atob($str$jscomp$11$$.replace(/[-_.]/g,function($str$jscomp$11$$){return $base64UrlDecodeSubs$$module$src$utils$base64$$[$str$jscomp$11$$]}));return $stringToBytes$$module$src$utils$bytes$$($encoded$$)}
function $pemToBytes$$module$src$utils$pem$$($pem$$){$pem$$=$pem$$.trim();$pem$$=$pem$$.replace(/^\-+BEGIN[^-]*\-+/,"");$pem$$=$pem$$.replace(/\-+END[^-]*\-+$/,"");$pem$$=$pem$$.replace(/[\r\n]/g,"").trim();return $stringToBytes$$module$src$utils$bytes$$(atob($pem$$))};function $AccessVendorAdapter$$module$extensions$amp_access$0_1$amp_access_vendor$$($ampdoc$jscomp$96_deferred$jscomp$19$$,$configJson$jscomp$2$$){this.ampdoc=$ampdoc$jscomp$96_deferred$jscomp$19$$;this.C=$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($configJson$jscomp$2$$.vendor,'"vendor" name must be specified');this.G=$configJson$jscomp$2$$[this.C]||{};this.F=!$configJson$jscomp$2$$.noPingback;$ampdoc$jscomp$96_deferred$jscomp$19$$=new $Deferred$$module$src$utils$promise$$;this.D=
$ampdoc$jscomp$96_deferred$jscomp$19$$.promise;this.B=$ampdoc$jscomp$96_deferred$jscomp$19$$.resolve}$JSCompiler_prototypeAlias$$=$AccessVendorAdapter$$module$extensions$amp_access$0_1$amp_access_vendor$$.prototype;$JSCompiler_prototypeAlias$$.getVendorName=function(){return this.C};$JSCompiler_prototypeAlias$$.getConfig=function(){return this.G};
$JSCompiler_prototypeAlias$$.registerVendor=function($vendor$jscomp$2$$){$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(this.B,"Vendor has already been registered");this.B($vendor$jscomp$2$$);this.B=null};$JSCompiler_prototypeAlias$$.isAuthorizationEnabled=function(){return!0};$JSCompiler_prototypeAlias$$.authorize=function(){return this.D.then(function($vendor$jscomp$3$$){return $vendor$jscomp$3$$.authorize()})};$JSCompiler_prototypeAlias$$.isPingbackEnabled=function(){return this.F};
$JSCompiler_prototypeAlias$$.pingback=function(){return this.D.then(function($vendor$jscomp$4$$){return $vendor$jscomp$4$$.pingback()})};$JSCompiler_prototypeAlias$$.postAction=function(){};function $AccessOtherAdapter$$module$extensions$amp_access$0_1$amp_access_other$$($ampdoc$jscomp$97$$,$configJson$jscomp$3$$,$context$jscomp$6$$){this.ampdoc=$ampdoc$jscomp$97$$;this.$context_$=$context$jscomp$6$$;this.B=$configJson$jscomp$3$$.authorizationFallbackResponse||null;this.C=$isProxyOrigin$$module$src$url$$($ampdoc$jscomp$97$$.win.location)}$JSCompiler_prototypeAlias$$=$AccessOtherAdapter$$module$extensions$amp_access$0_1$amp_access_other$$.prototype;
$JSCompiler_prototypeAlias$$.getConfig=function(){return{authorizationResponse:this.B}};$JSCompiler_prototypeAlias$$.isAuthorizationEnabled=function(){return!!this.B&&!this.C};$JSCompiler_prototypeAlias$$.authorize=function(){return Promise.resolve(this.B)};$JSCompiler_prototypeAlias$$.isPingbackEnabled=function(){return!1};$JSCompiler_prototypeAlias$$.pingback=function(){return Promise.resolve()};$JSCompiler_prototypeAlias$$.postAction=function(){};var $module$extensions$amp_access$0_1$access_expr_impl$parser$$=function(){function $o$jscomp$7$$($o$jscomp$7$$,$Parser$$,$$V0_parser$jscomp$1$$){var $$V1$$;$$V0_parser$jscomp$1$$=$$V0_parser$jscomp$1$$||{};for($$V1$$=$o$jscomp$7$$.length;$$V1$$--;$$V0_parser$jscomp$1$$[$o$jscomp$7$$[$$V1$$]]=$Parser$$);return $$V0_parser$jscomp$1$$}function $Parser$$(){this.yy={}}var $$V0_parser$jscomp$1$$=[1,3],$$V1$$=[1,4],$$V2$$=[1,18],$$V3$$=[1,13],$$V4$$=[1,14],$$V5$$=[1,15],$$V6$$=[1,16],$$V7$$=[1,17],$$V8$$=
[1,20],$$V9$$=[1,21],$$Va$$=[5,6,7,10],$$Vb$$=[5,6,7,10,15,16,17,18,19,20,21],$$Vc$$=[5,6,7,10,15,16,17,18,19,20,21,25],$$V0_parser$jscomp$1$$={trace:function(){},yy:{},$symbols_$:{error:2,result:3,search_condition:4,EOF:5,OR:6,AND:7,NOT:8,"(":9,")":10,predicate:11,comparison_predicate:12,truthy_predicate:13,scalar_exp:14,EQ:15,DEQ:16,NEQ:17,LT:18,LTE:19,GT:20,GTE:21,atom:22,field_ref:23,literal:24,DOT:25,field_name:26,NAME:27,STRING:28,NUMERIC:29,TRUE:30,FALSE:31,NULL:32,$accept:0,$end:1},$terminals_$:{2:"error",
5:"EOF",6:"OR",7:"AND",8:"NOT",9:"(",10:")",15:"EQ",16:"DEQ",17:"NEQ",18:"LT",19:"LTE",20:"GT",21:"GTE",25:"DOT",27:"NAME",28:"STRING",29:"NUMERIC",30:"TRUE",31:"FALSE",32:"NULL"},$productions_$:[0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,3],[23,1],[26,1],[24,1],[24,1],[24,1],[24,1],[24,1]],performAction:function $anonymous$$($o$jscomp$7$$,$Parser$$,$$V0_parser$jscomp$1$$,$$V1$$,$$V2$$,$$V3$$){var $$V4$$=$$V3$$.length-
1;switch($$V2$$){case 1:return $$V3$$[$$V4$$-1];case 2:this.$$$=$$V3$$[$$V4$$-2]||$$V3$$[$$V4$$];break;case 3:this.$$$=$$V3$$[$$V4$$-2]&&$$V3$$[$$V4$$];break;case 4:this.$$$=!$$V3$$[$$V4$$];break;case 5:this.$$$=$$V3$$[$$V4$$-1];break;case 6:case 7:case 8:case 17:case 18:case 19:this.$$$=$$V3$$[$$V4$$];break;case 9:this.$$$=$$V3$$[$$V4$$-2]===$$V3$$[$$V4$$];break;case 10:throw Error('"==" is not allowed, use "="');case 11:this.$$$=$$V3$$[$$V4$$-2]!==$$V3$$[$$V4$$];break;case 12:this.$$$=typeof $$V3$$[$$V4$$-
2]==typeof $$V3$$[$$V4$$]&&$$V3$$[$$V4$$-2]<$$V3$$[$$V4$$];break;case 13:this.$$$=typeof $$V3$$[$$V4$$-2]==typeof $$V3$$[$$V4$$]&&$$V3$$[$$V4$$-2]<=$$V3$$[$$V4$$];break;case 14:this.$$$=typeof $$V3$$[$$V4$$-2]==typeof $$V3$$[$$V4$$]&&$$V3$$[$$V4$$-2]>$$V3$$[$$V4$$];break;case 15:this.$$$=typeof $$V3$$[$$V4$$-2]==typeof $$V3$$[$$V4$$]&&$$V3$$[$$V4$$-2]>=$$V3$$[$$V4$$];break;case 16:this.$$$=void 0!==$$V3$$[$$V4$$]&&null!==$$V3$$[$$V4$$]&&""!==$$V3$$[$$V4$$]&&0!==$$V3$$[$$V4$$]&&!1!==$$V3$$[$$V4$$];
break;case 20:this.$$$="[object Object]"==Object.prototype.toString.call($$V3$$[$$V4$$-2])&&$$V3$$[$$V4$$-2].hasOwnProperty($$V3$$[$$V4$$])?$$V3$$[$$V4$$-2][$$V3$$[$$V4$$]]:null;break;case 21:this.$$$=void 0!==$$V1$$[$$V3$$[$$V4$$]]?$$V1$$[$$V3$$[$$V4$$]]:null;break;case 22:this.$$$=$o$jscomp$7$$;break;case 23:this.$$$=$o$jscomp$7$$.substring(1,$o$jscomp$7$$.length-1);break;case 24:this.$$$=Number($o$jscomp$7$$);break;case 25:this.$$$=!0;break;case 26:this.$$$=!1;break;case 27:this.$$$=null}},table:[{3:1,
4:2,8:$$V0_parser$jscomp$1$$,9:$$V1$$,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{1:[3]},{5:[1,19],6:$$V8$$,7:$$V9$$},{4:22,8:$$V0_parser$jscomp$1$$,9:$$V1$$,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{4:23,8:$$V0_parser$jscomp$1$$,9:$$V1$$,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},$o$jscomp$7$$($$Va$$,[2,6]),$o$jscomp$7$$($$Va$$,
[2,7]),$o$jscomp$7$$($$Va$$,[2,8]),$o$jscomp$7$$($$Va$$,[2,16],{15:[1,24],16:[1,25],17:[1,26],18:[1,27],19:[1,28],20:[1,29],21:[1,30]}),$o$jscomp$7$$($$Vb$$,[2,17]),$o$jscomp$7$$($$Vb$$,[2,18],{25:[1,31]}),$o$jscomp$7$$($$Vb$$,[2,19]),$o$jscomp$7$$($$Vc$$,[2,21]),$o$jscomp$7$$($$Vb$$,[2,23]),$o$jscomp$7$$($$Vb$$,[2,24]),$o$jscomp$7$$($$Vb$$,[2,25]),$o$jscomp$7$$($$Vb$$,[2,26]),$o$jscomp$7$$($$Vb$$,[2,27]),$o$jscomp$7$$($$Vc$$,[2,22]),{1:[2,1]},{4:32,8:$$V0_parser$jscomp$1$$,9:$$V1$$,11:5,12:6,13:7,
14:8,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{4:33,8:$$V0_parser$jscomp$1$$,9:$$V1$$,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},$o$jscomp$7$$($$Va$$,[2,4]),{6:$$V8$$,7:$$V9$$,10:[1,34]},{14:35,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:36,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:37,22:9,23:10,24:11,26:12,
27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:38,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:39,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:40,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{14:41,22:9,23:10,24:11,26:12,27:$$V2$$,28:$$V3$$,29:$$V4$$,30:$$V5$$,31:$$V6$$,32:$$V7$$},{26:42,27:$$V2$$},$o$jscomp$7$$([5,6,10],[2,2],{7:$$V9$$}),$o$jscomp$7$$($$Va$$,
[2,3]),$o$jscomp$7$$($$Va$$,[2,5]),$o$jscomp$7$$($$Va$$,[2,9]),$o$jscomp$7$$($$Va$$,[2,10]),$o$jscomp$7$$($$Va$$,[2,11]),$o$jscomp$7$$($$Va$$,[2,12]),$o$jscomp$7$$($$Va$$,[2,13]),$o$jscomp$7$$($$Va$$,[2,14]),$o$jscomp$7$$($$Va$$,[2,15]),$o$jscomp$7$$($$Vc$$,[2,20])],defaultActions:{19:[2,1]},parseError:function $parseError$$($o$jscomp$7$$,$Parser$$){if($Parser$$.recoverable)this.trace($o$jscomp$7$$);else throw $o$jscomp$7$$=Error($o$jscomp$7$$),$o$jscomp$7$$.hash=$Parser$$,$o$jscomp$7$$;},parse:function($o$jscomp$7$$){function $Parser$$($o$jscomp$7$$){$$V1$$.length=
$$V1$$.length-2*$o$jscomp$7$$;$$V3$$.length=$$V3$$.length-$o$jscomp$7$$;$$V4$$.length=$$V4$$.length-$o$jscomp$7$$}var $$V0_parser$jscomp$1$$=this,$$V1$$=[0],$$V2$$=[],$$V3$$=[null],$$V4$$=[],$$V5$$=this.table,$$V6$$="",$$V7$$=0,$$V8$$=0,$$V9$$=0,$$Va$$=2,$lexer$$=1,$$Vc$$=$$V4$$.slice.call(arguments,1),$$Vb$$=Object.create(this.lexer),$input$jscomp$25$$={yy:{}},$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$;for($action$jscomp$11_k$jscomp$17_newState$jscomp$4$$ in this.yy)Object.prototype.hasOwnProperty.call(this.yy,
$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$)&&($input$jscomp$25$$.yy[$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$]=this.yy[$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$]);$$Vb$$.setInput($o$jscomp$7$$,$input$jscomp$25$$.yy);$input$jscomp$25$$.yy.lexer=$$Vb$$;$input$jscomp$25$$.yy.parser=this;"undefined"==typeof $$Vb$$.yylloc&&($$Vb$$.yylloc={});var $yyloc$$=$$Vb$$.yylloc;$$V4$$.push($yyloc$$);var $ranges$$=$$Vb$$.options&&$$Vb$$.options.ranges;"function"===typeof $input$jscomp$25$$.yy.parseError?
this.parseError=$input$jscomp$25$$.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;var $lex$$=function(){var $o$jscomp$7$$;$o$jscomp$7$$=$$Vb$$.lex()||$lexer$$;"number"!==typeof $o$jscomp$7$$&&($o$jscomp$7$$=$$V0_parser$jscomp$1$$.$symbols_$[$o$jscomp$7$$]||$o$jscomp$7$$);return $o$jscomp$7$$};for(var $symbol$jscomp$2$$,$preErrorSymbol$$,$r$jscomp$21_state$jscomp$36$$,$yyval$$={},$p$jscomp$18$$,$expected$jscomp$1_len$jscomp$4$$;;){$r$jscomp$21_state$jscomp$36$$=$$V1$$[$$V1$$.length-
1];if(this.defaultActions[$r$jscomp$21_state$jscomp$36$$])$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$=this.defaultActions[$r$jscomp$21_state$jscomp$36$$];else{if(null===$symbol$jscomp$2$$||"undefined"==typeof $symbol$jscomp$2$$)$symbol$jscomp$2$$=$lex$$();$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$=$$V5$$[$r$jscomp$21_state$jscomp$36$$]&&$$V5$$[$r$jscomp$21_state$jscomp$36$$][$symbol$jscomp$2$$]}if("undefined"===typeof $action$jscomp$11_k$jscomp$17_newState$jscomp$4$$||!$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$.length||
!$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[0]){var $errStr$$="";$expected$jscomp$1_len$jscomp$4$$=[];for($p$jscomp$18$$ in $$V5$$[$r$jscomp$21_state$jscomp$36$$])this.$terminals_$[$p$jscomp$18$$]&&$p$jscomp$18$$>$$Va$$&&$expected$jscomp$1_len$jscomp$4$$.push("'"+this.$terminals_$[$p$jscomp$18$$]+"'");$errStr$$=$$Vb$$.showPosition?"Parse error on line "+($$V7$$+1)+":\n"+$$Vb$$.showPosition()+"\nExpecting "+$expected$jscomp$1_len$jscomp$4$$.join(", ")+", got '"+(this.$terminals_$[$symbol$jscomp$2$$]||
$symbol$jscomp$2$$)+"'":"Parse error on line "+($$V7$$+1)+": Unexpected "+($symbol$jscomp$2$$==$lexer$$?"end of input":"'"+(this.$terminals_$[$symbol$jscomp$2$$]||$symbol$jscomp$2$$)+"'");this.parseError($errStr$$,{text:$$Vb$$.match,token:this.$terminals_$[$symbol$jscomp$2$$]||$symbol$jscomp$2$$,line:$$Vb$$.yylineno,loc:$yyloc$$,expected:$expected$jscomp$1_len$jscomp$4$$})}if($action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[0]instanceof Array&&1<$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$.length)throw Error("Parse Error: multiple actions possible at state: "+
$r$jscomp$21_state$jscomp$36$$+", token: "+$symbol$jscomp$2$$);switch($action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[0]){case 1:$$V1$$.push($symbol$jscomp$2$$);$$V3$$.push($$Vb$$.yytext);$$V4$$.push($$Vb$$.yylloc);$$V1$$.push($action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[1]);$symbol$jscomp$2$$=null;$preErrorSymbol$$?($symbol$jscomp$2$$=$preErrorSymbol$$,$preErrorSymbol$$=null):($$V8$$=$$Vb$$.yyleng,$$V6$$=$$Vb$$.yytext,$$V7$$=$$Vb$$.yylineno,$yyloc$$=$$Vb$$.yylloc,0<$$V9$$&&$$V9$$--);break;
case 2:$expected$jscomp$1_len$jscomp$4$$=this.$productions_$[$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[1]][1];$yyval$$.$$$=$$V3$$[$$V3$$.length-$expected$jscomp$1_len$jscomp$4$$];$yyval$$.$_$$={first_line:$$V4$$[$$V4$$.length-($expected$jscomp$1_len$jscomp$4$$||1)].first_line,last_line:$$V4$$[$$V4$$.length-1].last_line,first_column:$$V4$$[$$V4$$.length-($expected$jscomp$1_len$jscomp$4$$||1)].first_column,last_column:$$V4$$[$$V4$$.length-1].last_column};$ranges$$&&($yyval$$.$_$$.range=[$$V4$$[$$V4$$.length-
($expected$jscomp$1_len$jscomp$4$$||1)].range[0],$$V4$$[$$V4$$.length-1].range[1]]);$r$jscomp$21_state$jscomp$36$$=this.performAction.apply($yyval$$,[$$V6$$,$$V8$$,$$V7$$,$input$jscomp$25$$.yy,$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[1],$$V3$$,$$V4$$].concat($$Vc$$));if("undefined"!==typeof $r$jscomp$21_state$jscomp$36$$)return $r$jscomp$21_state$jscomp$36$$;$expected$jscomp$1_len$jscomp$4$$&&($$V1$$=$$V1$$.slice(0,-2*$expected$jscomp$1_len$jscomp$4$$),$$V3$$=$$V3$$.slice(0,-1*$expected$jscomp$1_len$jscomp$4$$),
$$V4$$=$$V4$$.slice(0,-1*$expected$jscomp$1_len$jscomp$4$$));$$V1$$.push(this.$productions_$[$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$[1]][0]);$$V3$$.push($yyval$$.$$$);$$V4$$.push($yyval$$.$_$$);$action$jscomp$11_k$jscomp$17_newState$jscomp$4$$=$$V5$$[$$V1$$[$$V1$$.length-2]][$$V1$$[$$V1$$.length-1]];$$V1$$.push($action$jscomp$11_k$jscomp$17_newState$jscomp$4$$);break;case 3:return!0}}}},$lexer$$=function(){return{EOF:1,parseError:function($o$jscomp$7$$,$Parser$$){if(this.yy.parser)this.yy.parser.parseError($o$jscomp$7$$,
$Parser$$);else throw Error($o$jscomp$7$$);},setInput:function($o$jscomp$7$$,$Parser$$){this.yy=$Parser$$||this.yy||{};this._input=$o$jscomp$7$$;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var $o$jscomp$7$$=this._input[0];this.yytext+=$o$jscomp$7$$;
this.yyleng++;this.offset++;this.match+=$o$jscomp$7$$;this.matched+=$o$jscomp$7$$;var $Parser$$=$o$jscomp$7$$.match(/(?:\r\n?|\n).*/g);$Parser$$?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return $o$jscomp$7$$},unput:function($o$jscomp$7$$){var $Parser$$=$o$jscomp$7$$.length,$$V0_parser$jscomp$1$$=$o$jscomp$7$$.split(/(?:\r\n?|\n)/g);this._input=$o$jscomp$7$$+this._input;this.yytext=this.yytext.substr(0,
this.yytext.length-$Parser$$);this.offset-=$Parser$$;var $$V1$$=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);$$V0_parser$jscomp$1$$.length-1&&(this.yylineno-=$$V0_parser$jscomp$1$$.length-1);$o$jscomp$7$$=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$$V0_parser$jscomp$1$$?($$V0_parser$jscomp$1$$.length===
$$V1$$.length?this.yylloc.first_column:0)+$$V1$$[$$V1$$.length-$$V0_parser$jscomp$1$$.length].length-$$V0_parser$jscomp$1$$[0].length:this.yylloc.first_column-$Parser$$};this.options.ranges&&(this.yylloc.range=[$o$jscomp$7$$[0],$o$jscomp$7$$[0]+this.yyleng-$Parser$$]);this.yyleng=this.yytext.length;return this},more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+
this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function($o$jscomp$7$$){this.unput(this.match.slice($o$jscomp$7$$))},pastInput:function(){var $o$jscomp$7$$=this.matched.substr(0,this.matched.length-this.match.length);return(20<$o$jscomp$7$$.length?"...":"")+$o$jscomp$7$$.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var $o$jscomp$7$$=this.match;20>$o$jscomp$7$$.length&&($o$jscomp$7$$+=this._input.substr(0,20-$o$jscomp$7$$.length));return($o$jscomp$7$$.substr(0,
20)+(20<$o$jscomp$7$$.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var $o$jscomp$7$$=this.pastInput(),$Parser$$=Array($o$jscomp$7$$.length+1).join("-");return $o$jscomp$7$$+this.upcomingInput()+"\n"+$Parser$$+"^"},test_match:function($o$jscomp$7$$,$Parser$$){var $$V0_parser$jscomp$1$$,$$V1$$;this.options.backtrack_lexer&&($$V1$$={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},
yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&($$V1$$.yylloc.range=this.yylloc.range.slice(0)));if($$V0_parser$jscomp$1$$=$o$jscomp$7$$[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=$$V0_parser$jscomp$1$$.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,
last_column:$$V0_parser$jscomp$1$$?$$V0_parser$jscomp$1$$[$$V0_parser$jscomp$1$$.length-1].length-$$V0_parser$jscomp$1$$[$$V0_parser$jscomp$1$$.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+$o$jscomp$7$$[0].length};this.yytext+=$o$jscomp$7$$[0];this.match+=$o$jscomp$7$$[0];this.matches=$o$jscomp$7$$;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice($o$jscomp$7$$[0].length);
this.matched+=$o$jscomp$7$$[0];$o$jscomp$7$$=this.performAction.call(this,this.yy,this,$Parser$$,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if($o$jscomp$7$$)return $o$jscomp$7$$;if(this._backtrack)for(var $$V2$$ in $$V1$$)this[$$V2$$]=$$V1$$[$$V2$$];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var $o$jscomp$7$$,$Parser$$,$$V0_parser$jscomp$1$$;this._more||(this.match=this.yytext="");for(var $$V1$$=this._currentRules(),
$$V2$$=0;$$V2$$<$$V1$$.length;$$V2$$++)if(($Parser$$=this._input.match(this.rules[$$V1$$[$$V2$$]]))&&(!$o$jscomp$7$$||$Parser$$[0].length>$o$jscomp$7$$[0].length))if($o$jscomp$7$$=$Parser$$,$$V0_parser$jscomp$1$$=$$V2$$,this.options.backtrack_lexer){$o$jscomp$7$$=this.test_match($Parser$$,$$V1$$[$$V2$$]);if(!1!==$o$jscomp$7$$)return $o$jscomp$7$$;if(this._backtrack)$o$jscomp$7$$=!1;else return!1}else if(!this.options.flex)break;return $o$jscomp$7$$?($o$jscomp$7$$=this.test_match($o$jscomp$7$$,$$V1$$[$$V0_parser$jscomp$1$$]),
!1!==$o$jscomp$7$$?$o$jscomp$7$$:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var $o$jscomp$7$$=this.next();return $o$jscomp$7$$?$o$jscomp$7$$:this.lex()},begin:function($o$jscomp$7$$){this.conditionStack.push($o$jscomp$7$$)},popState:function $popState$$(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function $_currentRules$$(){return this.conditionStack.length&&
this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function $topState$$($o$jscomp$7$$){$o$jscomp$7$$=this.conditionStack.length-1-Math.abs($o$jscomp$7$$||0);return 0<=$o$jscomp$7$$?this.conditionStack[$o$jscomp$7$$]:"INITIAL"},pushState:function($o$jscomp$7$$){this.begin($o$jscomp$7$$)},stateStackSize:function $stateStackSize$$(){return this.conditionStack.length},options:{},performAction:function($o$jscomp$7$$,
$Parser$$,$$V0_parser$jscomp$1$$,$$V1$$){var $$V2$$=$$V1$$;switch($$V0_parser$jscomp$1$$){case 1:return 7;case 2:return 6;case 3:return 8;case 4:return 32;case 5:return 30;case 6:return 30;case 7:return 31;case 8:return 31;case 9:return 9;case 10:return 10;case 11:return"|";case 12:return 19;case 13:return 18;case 14:return 21;case 15:return 20;case 16:return 17;case 17:return 16;case 18:return 15;case 19:return 29;case 20:return 27;case 21:return 28;case 22:return 28;case 23:return 25;case 24:return"INVALID";
case 25:return 5}},rules:[/^(?:\s+)/,/^(?:AND\b)/,/^(?:OR\b)/,/^(?:NOT\b)/,/^(?:NULL\b)/,/^(?:TRUE\b)/,/^(?:true\b)/,/^(?:FALSE\b)/,/^(?:false\b)/,/^(?:\()/,/^(?:\))/,/^(?:\|)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:-?[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^\']*')/,/^(?:"[^\"]*")/,/^(?:\.)/,/^(?:.)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}}}();$$V0_parser$jscomp$1$$.lexer=
$lexer$$;$Parser$$.prototype=$$V0_parser$jscomp$1$$;$$V0_parser$jscomp$1$$.B=$Parser$$;return new $Parser$$}();function $Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger$$($win$jscomp$241$$,$targetOrCallback$$,$targetOrigin$jscomp$2$$){this.F=$win$jscomp$241$$;this.C=$targetOrCallback$$;this.$targetOrigin_$=$targetOrigin$jscomp$2$$;this.B=this.$target_$=null;this.G=this.$handleEvent_$.bind(this);this.H=0;this.D={}}$JSCompiler_prototypeAlias$$=$Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger$$.prototype;
$JSCompiler_prototypeAlias$$.connect=function($onCommand$$){if(this.B)throw Error("already connected");this.B=$onCommand$$;this.F.addEventListener("message",this.G)};$JSCompiler_prototypeAlias$$.disconnect=function(){this.B&&(this.B=null,this.F.removeEventListener("message",this.G))};$JSCompiler_prototypeAlias$$.isConnected=function(){return null!=this.$targetOrigin_$};
$JSCompiler_prototypeAlias$$.getTarget=function(){var $target$jscomp$101$$=$JSCompiler_StaticMethods_getOptionalTarget_$$(this);if(!$target$jscomp$101$$)throw Error("not connected");return $target$jscomp$101$$};
function $JSCompiler_StaticMethods_getOptionalTarget_$$($JSCompiler_StaticMethods_getOptionalTarget_$self$$){$JSCompiler_StaticMethods_getOptionalTarget_$self$$.B&&!$JSCompiler_StaticMethods_getOptionalTarget_$self$$.$target_$&&("function"==typeof $JSCompiler_StaticMethods_getOptionalTarget_$self$$.C?$JSCompiler_StaticMethods_getOptionalTarget_$self$$.$target_$=$JSCompiler_StaticMethods_getOptionalTarget_$self$$.C():$JSCompiler_StaticMethods_getOptionalTarget_$self$$.$target_$=$JSCompiler_StaticMethods_getOptionalTarget_$self$$.C);
return $JSCompiler_StaticMethods_getOptionalTarget_$self$$.$target_$}$JSCompiler_prototypeAlias$$.getTargetOrigin=function(){if(null==this.$targetOrigin_$)throw Error("not connected");return this.$targetOrigin_$};$JSCompiler_prototypeAlias$$.sendCommand=function($cmd$$,$opt_payload$$){this.$sendCommand_$(void 0,$cmd$$,$opt_payload$$)};
$JSCompiler_prototypeAlias$$.sendCommandRsvp=function($cmd$jscomp$1$$,$opt_payload$jscomp$1$$){var $rsvpId$$=String(++this.H),$$jscomp$destructuring$var177$$=new $Deferred$$module$src$utils$promise$$,$promise$jscomp$20$$=$$jscomp$destructuring$var177$$.promise;this.D[$rsvpId$$]={promise:$promise$jscomp$20$$,resolver:$$jscomp$destructuring$var177$$.resolve};this.$sendCommand_$($rsvpId$$,$cmd$jscomp$1$$,$opt_payload$jscomp$1$$);return $promise$jscomp$20$$};
$JSCompiler_prototypeAlias$$.$sendCommand_$=function($rsvpId$jscomp$1$$,$cmd$jscomp$2$$,$opt_payload$jscomp$2$$){var $target$jscomp$102$$=this.getTarget(),$targetOrigin$jscomp$3$$="connect"==$cmd$jscomp$2$$?null!=this.$targetOrigin_$?this.$targetOrigin_$:"*":this.getTargetOrigin();$target$jscomp$102$$.postMessage({sentinel:"__AMP__",_rsvp:$rsvpId$jscomp$1$$,cmd:$cmd$jscomp$2$$,payload:$opt_payload$jscomp$2$$||null},$targetOrigin$jscomp$3$$)};
$JSCompiler_prototypeAlias$$.$handleEvent_$=function($e$jscomp$115_result$jscomp$15$$){var $$jscomp$this$jscomp$219$$=this,$data$jscomp$75$$=$e$jscomp$115_result$jscomp$15$$.data;if($data$jscomp$75$$&&"__AMP__"==$data$jscomp$75$$.sentinel){var $origin$jscomp$17$$=$e$jscomp$115_result$jscomp$15$$.origin,$cmd$jscomp$3$$=$data$jscomp$75$$.cmd,$payload$jscomp$5$$=$data$jscomp$75$$.payload||null;null==this.$targetOrigin_$&&"start"==$cmd$jscomp$3$$&&(this.$targetOrigin_$=$origin$jscomp$17$$);null==this.$targetOrigin_$&&
$e$jscomp$115_result$jscomp$15$$.source&&$JSCompiler_StaticMethods_getOptionalTarget_$$(this)==$e$jscomp$115_result$jscomp$15$$.source&&(this.$targetOrigin_$=$origin$jscomp$17$$);if($origin$jscomp$17$$==this.$targetOrigin_$){var $rsvpId$jscomp$2$$=$data$jscomp$75$$._rsvp,$rsvp$$=!!$rsvpId$jscomp$2$$&&"rsvp"!=$cmd$jscomp$3$$;$e$jscomp$115_result$jscomp$15$$=$JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$$(this,$rsvpId$jscomp$2$$,
$cmd$jscomp$3$$,$payload$jscomp$5$$);$rsvp$$&&Promise.resolve($e$jscomp$115_result$jscomp$15$$).then(function($e$jscomp$115_result$jscomp$15$$){$$jscomp$this$jscomp$219$$.$sendCommand_$($rsvpId$jscomp$2$$,"rsvp",{result:$e$jscomp$115_result$jscomp$15$$})},function($e$jscomp$115_result$jscomp$15$$){$$jscomp$this$jscomp$219$$.$sendCommand_$($rsvpId$jscomp$2$$,"rsvp",{error:String($e$jscomp$115_result$jscomp$15$$)})})}}};
function $JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$$($JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$self$$,$rsvpId$jscomp$3$$,$cmd$jscomp$4$$,$payload$jscomp$6$$){if("rsvp"==$cmd$jscomp$4$$){var $waiting$$=$rsvpId$jscomp$3$$&&$JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$self$$.D[$rsvpId$jscomp$3$$];
$waiting$$&&("error"in $payload$jscomp$6$$?$waiting$$.resolver(Promise.reject(Error($payload$jscomp$6$$.error))):$waiting$$.resolver($payload$jscomp$6$$.result),delete $JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$self$$.D[$rsvpId$jscomp$3$$])}else return $JSCompiler_StaticMethods_Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger_prototype$handleCommand_$self$$.B($cmd$jscomp$4$$,$payload$jscomp$6$$)};function $AccessIframeAdapter$$module$extensions$amp_access$0_1$amp_access_iframe$$($ampdoc$jscomp$98$$,$configJson$jscomp$4$$,$context$jscomp$7$$){var $$jscomp$this$jscomp$220$$=this;this.ampdoc=$ampdoc$jscomp$98$$;this.$context_$=$context$jscomp$7$$;this.$configJson_$=$configJson$jscomp$4$$;this.$timer_$=$Services$$module$src$services$timerFor$$($ampdoc$jscomp$98$$.win);this.$iframeSrc_$=$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($configJson$jscomp$4$$.iframeSrc,'"iframeSrc" URL must be specified');
$assertHttpsUrl$$module$src$url$$(this.$iframeSrc_$,'"iframeSrc"');(this.B=$configJson$jscomp$4$$.iframeVars||null)&&$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($isArray$$module$src$types$$(this.B),'"iframeVars" must be an array');this.H=$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($configJson$jscomp$4$$.defaultResponse,'"defaultResponse" must be specified');this.$targetOrigin_$=$parseUrlDeprecated$$module$src$url$$(this.$iframeSrc_$).origin;this.F=this.D=
null;this.$iframe_$=$ampdoc$jscomp$98$$.win.document.createElement("iframe");$toggle$$module$src$style$$(this.$iframe_$,!1);this.C=new $Messenger$$module$extensions$amp_access$0_1$iframe_api$messenger$$(this.ampdoc.win,function(){return $$jscomp$this$jscomp$220$$.$iframe_$.contentWindow},this.$targetOrigin_$);this.G=null}$JSCompiler_prototypeAlias$$=$AccessIframeAdapter$$module$extensions$amp_access$0_1$amp_access_iframe$$.prototype;
$JSCompiler_prototypeAlias$$.disconnect=function(){this.C.disconnect();this.ampdoc.getBody().removeChild(this.$iframe_$)};$JSCompiler_prototypeAlias$$.getConfig=function(){return{iframeSrc:this.$iframeSrc_$,iframeVars:this.B}};$JSCompiler_prototypeAlias$$.isAuthorizationEnabled=function(){return!0};$JSCompiler_prototypeAlias$$.authorize=function(){return Promise.race([$JSCompiler_StaticMethods_authorizeLocal_$$(this),$JSCompiler_StaticMethods_authorizeRemote_$$(this)])};
$JSCompiler_prototypeAlias$$.isPingbackEnabled=function(){return!0};$JSCompiler_prototypeAlias$$.pingback=function(){var $$jscomp$this$jscomp$221$$=this;return this.connect().then(function(){return $$jscomp$this$jscomp$221$$.C.sendCommandRsvp("pingback",{})})};$JSCompiler_prototypeAlias$$.postAction=function(){$JSCompiler_StaticMethods_store_$$(this,null)};
$JSCompiler_prototypeAlias$$.connect=function(){if(!this.F){var $deferred$jscomp$21$$=new $Deferred$$module$src$utils$promise$$;this.F=$deferred$jscomp$21$$.promise;this.D=$deferred$jscomp$21$$.resolve;this.G=$JSCompiler_StaticMethods_resolveConfig_$$(this);this.C.connect(this.$AccessIframeAdapter$$module$extensions$amp_access$0_1$amp_access_iframe_prototype$handleCommand_$.bind(this));this.ampdoc.getBody().appendChild(this.$iframe_$);this.$iframe_$.src=this.$iframeSrc_$}return this.F};
function $JSCompiler_StaticMethods_resolveConfig_$$($JSCompiler_StaticMethods_resolveConfig_$self$$){return new Promise(function($resolve$jscomp$44$$){var $configJson$jscomp$5$$=$parseJson$$module$src$json$$(JSON.stringify($JSCompiler_StaticMethods_resolveConfig_$self$$.$configJson_$));if($JSCompiler_StaticMethods_resolveConfig_$self$$.B){var $varsString$$=$JSCompiler_StaticMethods_resolveConfig_$self$$.B.join("&"),$varsPromise$$=$JSCompiler_StaticMethods_resolveConfig_$self$$.$context_$.collectUrlVars($varsString$$,
!1);$resolve$jscomp$44$$($varsPromise$$.then(function($JSCompiler_StaticMethods_resolveConfig_$self$$){$configJson$jscomp$5$$.iframeVars=$JSCompiler_StaticMethods_resolveConfig_$self$$;return $configJson$jscomp$5$$}))}else $resolve$jscomp$44$$($configJson$jscomp$5$$)})}
function $JSCompiler_StaticMethods_authorizeLocal_$$($JSCompiler_StaticMethods_authorizeLocal_$self$$){var $timeout$jscomp$7$$=3E3*($getMode$$module$src$mode$$().development?2:1);return $JSCompiler_StaticMethods_authorizeLocal_$self$$.$timer_$.promise($timeout$jscomp$7$$).then(function(){return $JSCompiler_StaticMethods_restore_$$($JSCompiler_StaticMethods_authorizeLocal_$self$$)||$JSCompiler_StaticMethods_authorizeLocal_$self$$.H})}
function $JSCompiler_StaticMethods_authorizeRemote_$$($JSCompiler_StaticMethods_authorizeRemote_$self$$){return $JSCompiler_StaticMethods_authorizeRemote_$self$$.connect().then(function(){return $JSCompiler_StaticMethods_authorizeRemote_$self$$.C.sendCommandRsvp("authorize",{})}).then(function($data$jscomp$76$$){$data$jscomp$76$$&&Promise.resolve().then(function(){return $JSCompiler_StaticMethods_store_$$($JSCompiler_StaticMethods_authorizeRemote_$self$$,$data$jscomp$76$$)});return $data$jscomp$76$$})}
function $JSCompiler_StaticMethods_restore_$$($JSCompiler_StaticMethods_restore_$self$$){var $storage$jscomp$2_win$jscomp$242$$=$JSCompiler_StaticMethods_restore_$self$$.ampdoc.win,$storage$jscomp$2_win$jscomp$242$$=$storage$jscomp$2_win$jscomp$242$$.sessionStorage||$storage$jscomp$2_win$jscomp$242$$.localStorage;if(!$storage$jscomp$2_win$jscomp$242$$)return null;try{var $raw$$=$storage$jscomp$2_win$jscomp$242$$.getItem("amp-access-iframe");if(!$raw$$)return null;var $parsed$jscomp$3$$=$parseJson$$module$src$json$$($raw$$);
return $parsed$jscomp$3$$.t+6048E5<$JSCompiler_StaticMethods_restore_$self$$.ampdoc.win.Date.now()?null:$parsed$jscomp$3$$.d||null}catch($e$130$$){$dev$$module$src$log$$().error("amp-access-iframe","failed to restore access response: ",$e$130$$);try{$storage$jscomp$2_win$jscomp$242$$.removeItem("amp-access-iframe")}catch($e$jscomp$116$$){}return null}}
function $JSCompiler_StaticMethods_store_$$($JSCompiler_StaticMethods_store_$self$$,$data$jscomp$77$$){var $storage$jscomp$3_win$jscomp$243$$=$JSCompiler_StaticMethods_store_$self$$.ampdoc.win;if($storage$jscomp$3_win$jscomp$243$$=$storage$jscomp$3_win$jscomp$243$$.sessionStorage||$storage$jscomp$3_win$jscomp$243$$.localStorage)try{$data$jscomp$77$$?$storage$jscomp$3_win$jscomp$243$$.setItem("amp-access-iframe",JSON.stringify($dict$$module$src$utils$object$$({t:$JSCompiler_StaticMethods_store_$self$$.ampdoc.win.Date.now(),
d:$data$jscomp$77$$}))):$storage$jscomp$3_win$jscomp$243$$.removeItem("amp-access-iframe")}catch($e$jscomp$117$$){$dev$$module$src$log$$().error("amp-access-iframe","failed to store access response: ",$e$jscomp$117$$)}}
$JSCompiler_prototypeAlias$$.$AccessIframeAdapter$$module$extensions$amp_access$0_1$amp_access_iframe_prototype$handleCommand_$=function($cmd$jscomp$5$$){var $$jscomp$this$jscomp$225$$=this;"connect"==$cmd$jscomp$5$$&&this.G.then(function($cmd$jscomp$5$$){$$jscomp$this$jscomp$225$$.C.sendCommandRsvp("start",{protocol:"amp-access",config:$cmd$jscomp$5$$}).then(function(){$$jscomp$this$jscomp$225$$.D&&($$jscomp$this$jscomp$225$$.D(),$$jscomp$this$jscomp$225$$.D=null)})})};function $AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server$$($ampdoc$jscomp$99$$,$configJson$jscomp$7$$,$context$jscomp$8$$){this.ampdoc=$ampdoc$jscomp$99$$;this.$context_$=$context$jscomp$8$$;this.B=new $AccessClientAdapter$$module$extensions$amp_access$0_1$amp_access_client$$($ampdoc$jscomp$99$$,$configJson$jscomp$7$$,$context$jscomp$8$$);this.$viewer_$=$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$99$$);this.$xhr_$=$Services$$module$src$services$xhrFor$$($ampdoc$jscomp$99$$.win);
this.$timer_$=$Services$$module$src$services$timerFor$$($ampdoc$jscomp$99$$.win);this.$vsync_$=$Services$$module$src$services$vsyncFor$$($ampdoc$jscomp$99$$.win);var $stateElement$$=$ampdoc$jscomp$99$$.getRootNode().querySelector('meta[name="i-amphtml-access-state"]');this.C=$stateElement$$?$stateElement$$.getAttribute("content"):null;var $isInExperiment$$=$isExperimentOn$$module$src$experiments$$($ampdoc$jscomp$99$$.win,"amp-access-server");this.D=$isProxyOrigin$$module$src$url$$($ampdoc$jscomp$99$$.win.location)||
$isInExperiment$$;var $serviceUrlOverride$$=$isInExperiment$$?this.$viewer_$.getParam("serverAccessService"):null;this.F=$serviceUrlOverride$$||$removeFragment$$module$src$url$$($ampdoc$jscomp$99$$.win.location.href)}$JSCompiler_prototypeAlias$$=$AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server$$.prototype;$JSCompiler_prototypeAlias$$.getConfig=function(){return{client:this.B.getConfig(),proxy:this.D,serverState:this.C}};$JSCompiler_prototypeAlias$$.isAuthorizationEnabled=function(){return!0};
$JSCompiler_prototypeAlias$$.authorize=function(){var $$jscomp$this$jscomp$226$$=this;return this.D&&this.C?this.$context_$.collectUrlVars(this.B.getAuthorizationUrl(),!1).then(function($request$jscomp$10_vars$jscomp$6$$){var $requestVars$$={},$k$jscomp$19$$;for($k$jscomp$19$$ in $request$jscomp$10_vars$jscomp$6$$)null!=$request$jscomp$10_vars$jscomp$6$$[$k$jscomp$19$$]&&($requestVars$$[$k$jscomp$19$$]=String($request$jscomp$10_vars$jscomp$6$$[$k$jscomp$19$$]));$request$jscomp$10_vars$jscomp$6$$=
$dict$$module$src$utils$object$$({url:$removeFragment$$module$src$url$$($$jscomp$this$jscomp$226$$.ampdoc.win.location.href),state:$$jscomp$this$jscomp$226$$.C,vars:$requestVars$$});return $$jscomp$this$jscomp$226$$.$timer_$.timeoutPromise($$jscomp$this$jscomp$226$$.B.getAuthorizationTimeout(),$$jscomp$this$jscomp$226$$.$xhr_$.fetchDocument($$jscomp$this$jscomp$226$$.F,{method:"POST",body:"request="+encodeURIComponent(JSON.stringify($request$jscomp$10_vars$jscomp$6$$)),headers:{"Content-Type":"application/x-www-form-urlencoded"},
requireAmpResponseSourceOrigin:!1}))}).then(function($responseDoc$$){var $accessDataString$$=$responseDoc$$.querySelector('script[id="amp-access-data"]').textContent,$accessData$$=$parseJson$$module$src$json$$($accessDataString$$);return $JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$$($$jscomp$this$jscomp$226$$,$responseDoc$$).then(function(){return $accessData$$})}):this.B.authorize()};
$JSCompiler_prototypeAlias$$.isPingbackEnabled=function(){return this.B.isPingbackEnabled()};$JSCompiler_prototypeAlias$$.pingback=function(){return this.B.pingback()};$JSCompiler_prototypeAlias$$.postAction=function(){};
function $JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$$($JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$self$$,$doc$jscomp$62$$){var $sections$$=$doc$jscomp$62$$.querySelectorAll("[i-amphtml-access-id]");return $JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$self$$.$vsync_$.mutatePromise(function(){for(var $doc$jscomp$62$$=
0;$doc$jscomp$62$$<$sections$$.length;$doc$jscomp$62$$++){var $section$jscomp$1$$=$sections$$[$doc$jscomp$62$$],$sectionId$$=$section$jscomp$1$$.getAttribute("i-amphtml-access-id"),$target$jscomp$103$$=$JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$self$$.ampdoc.getRootNode().querySelector('[i-amphtml-access-id="'+$cssEscape$$module$third_party$css_escape$css_escape$$($sectionId$$)+'"]');$target$jscomp$103$$?$target$jscomp$103$$.parentElement.replaceChild($JSCompiler_StaticMethods_AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server_prototype$replaceSections_$self$$.ampdoc.win.document.importNode($section$jscomp$1$$,
!0),$target$jscomp$103$$):$dev$$module$src$log$$().warn("amp-access-server","Section not found: ",$sectionId$$)}})};function $JwtHelper$$module$extensions$amp_access$0_1$jwt$$($win$jscomp$244$$){this.win=$win$jscomp$244$$;this.B=$win$jscomp$244$$.crypto&&($win$jscomp$244$$.crypto.subtle||$win$jscomp$244$$.crypto.webkitSubtle)||null}$JwtHelper$$module$extensions$amp_access$0_1$jwt$$.prototype.D=function(){return!!this.B};
$JwtHelper$$module$extensions$amp_access$0_1$jwt$$.prototype.C=function($encodedToken$jscomp$1$$,$pemPromise$$){var $$jscomp$this$jscomp$228$$=this;if(!this.B)throw Error("Crypto is not supported on this platform");var $decodedPromise$$=new Promise(function($pemPromise$$){return $pemPromise$$($JSCompiler_StaticMethods_decodeInternal_$$($encodedToken$jscomp$1$$))});return $decodedPromise$$.then(function($encodedToken$jscomp$1$$){var $decodedPromise$$=$encodedToken$jscomp$1$$.header.alg;if(!$decodedPromise$$||
"RS256"!=$decodedPromise$$)throw Error("Only alg=RS256 is supported");return $JSCompiler_StaticMethods_importKey_$$($$jscomp$this$jscomp$228$$,$pemPromise$$).then(function($pemPromise$$){var $decodedPromise$$=$base64UrlDecodeToBytes$$module$src$utils$base64$$($encodedToken$jscomp$1$$.sig);return $$jscomp$this$jscomp$228$$.B.verify({name:"RSASSA-PKCS1-v1_5"},$pemPromise$$,$decodedPromise$$,$stringToBytes$$module$src$utils$bytes$$($encodedToken$jscomp$1$$.verifiable))}).then(function($pemPromise$$){if($pemPromise$$)return $encodedToken$jscomp$1$$.payload;
throw Error("Signature verification failed");})})};
function $JSCompiler_StaticMethods_decodeInternal_$$($encodedToken$jscomp$2$$){function $invalidToken$$(){throw Error('Invalid token: "'+$encodedToken$jscomp$2$$+'"');}var $parts$jscomp$16$$=$encodedToken$jscomp$2$$.split(".");3!=$parts$jscomp$16$$.length&&$invalidToken$$();var $headerUtf8Bytes$$=$base64UrlDecodeToBytes$$module$src$utils$base64$$($parts$jscomp$16$$[0]),$payloadUtf8Bytes$$=$base64UrlDecodeToBytes$$module$src$utils$base64$$($parts$jscomp$16$$[1]);return{header:$tryParseJson$$module$src$json$$($utf8Decode$$module$src$utils$bytes$$($headerUtf8Bytes$$),
$invalidToken$$),payload:$tryParseJson$$module$src$json$$($utf8Decode$$module$src$utils$bytes$$($payloadUtf8Bytes$$),$invalidToken$$),verifiable:$parts$jscomp$16$$[0]+"."+$parts$jscomp$16$$[1],sig:$parts$jscomp$16$$[2]}}
function $JSCompiler_StaticMethods_importKey_$$($JSCompiler_StaticMethods_importKey_$self$$,$pemPromise$jscomp$1$$){return $pemPromise$jscomp$1$$.then(function($pemPromise$jscomp$1$$){return $JSCompiler_StaticMethods_importKey_$self$$.B.importKey("spki",$pemToBytes$$module$src$utils$pem$$($pemPromise$jscomp$1$$),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"])})};function $AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt$$($ampdoc$jscomp$100$$,$configJson$jscomp$8$$,$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$){this.ampdoc=$ampdoc$jscomp$100$$;this.$context_$=$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$;this.D=new $AccessClientAdapter$$module$extensions$amp_access$0_1$amp_access_client$$($ampdoc$jscomp$100$$,$configJson$jscomp$8$$,$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$);
this.$viewer_$=$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$100$$);this.$xhr_$=$Services$$module$src$services$xhrFor$$($ampdoc$jscomp$100$$.win);this.$timer_$=$Services$$module$src$services$timerFor$$($ampdoc$jscomp$100$$.win);this.$vsync_$=$Services$$module$src$services$vsyncFor$$($ampdoc$jscomp$100$$.win);this.F=($context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$=$ampdoc$jscomp$100$$.getRootNode().querySelector('meta[name="i-amphtml-access-state"]'))?$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$.getAttribute("content"):
null;$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$=$isExperimentOn$$module$src$experiments$$($ampdoc$jscomp$100$$.win,"amp-access-server-jwt");this.G=$isProxyOrigin$$module$src$url$$($ampdoc$jscomp$100$$.win.location)||$context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$;this.I=($context$jscomp$9_isInExperiment$jscomp$1_stateElement$jscomp$1$$?this.$viewer_$.getParam("serverAccessService"):null)||$removeFragment$$module$src$url$$($ampdoc$jscomp$100$$.win.location.href);
this.C=$configJson$jscomp$8$$.publicKey||null;this.B=$configJson$jscomp$8$$.publicKeyUrl||null;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(this.C||this.B,'"publicKey" or "publicKeyUrl" must be specified');this.B&&$assertHttpsUrl$$module$src$url$$(this.B,'"publicKeyUrl"');this.C&&this.B&&$user$$module$src$log$$().warn("amp-access-server-jwt",'Both "publicKey" and "publicKeyUrl" specified. The "publicKeyUrl" will be ignored.');this.H=new $JwtHelper$$module$extensions$amp_access$0_1$jwt$$($ampdoc$jscomp$100$$.win)}
$JSCompiler_prototypeAlias$$=$AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt$$.prototype;$JSCompiler_prototypeAlias$$.getConfig=function(){return{client:this.D.getConfig(),proxy:this.G,serverState:this.F,publicKey:this.C,publicKeyUrl:this.B}};$JSCompiler_prototypeAlias$$.isAuthorizationEnabled=function(){return!0};$JSCompiler_prototypeAlias$$.authorize=function(){return this.G&&this.F?$JSCompiler_StaticMethods_authorizeOnServer_$$(this):$JSCompiler_StaticMethods_authorizeOnClient_$$(this)};
$JSCompiler_prototypeAlias$$.isPingbackEnabled=function(){return this.D.isPingbackEnabled()};$JSCompiler_prototypeAlias$$.pingback=function(){return this.D.pingback()};$JSCompiler_prototypeAlias$$.postAction=function(){};
function $JSCompiler_StaticMethods_fetchJwt_$$($JSCompiler_StaticMethods_fetchJwt_$self$$){var $jwtPromise$$=$JSCompiler_StaticMethods_fetchJwt_$self$$.$context_$.buildUrl($JSCompiler_StaticMethods_fetchJwt_$self$$.D.getAuthorizationUrl(),!1).then(function($jwtPromise$$){return $JSCompiler_StaticMethods_fetchJwt_$self$$.$timer_$.timeoutPromise(3E3,$JSCompiler_StaticMethods_fetchJwt_$self$$.$xhr_$.fetchText($jwtPromise$$,{credentials:"include"}))}).then(function($JSCompiler_StaticMethods_fetchJwt_$self$$){return $JSCompiler_StaticMethods_fetchJwt_$self$$.text()}).then(function($JSCompiler_StaticMethods_fetchJwt_$self$$){var $jwtPromise$$=
$JSCompiler_StaticMethods_decodeInternal_$$($JSCompiler_StaticMethods_fetchJwt_$self$$).payload;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($jwtPromise$$.amp_authdata,'"amp_authdata" must be present in JWT');return{encoded:$JSCompiler_StaticMethods_fetchJwt_$self$$,jwt:$jwtPromise$$}});$getMode$$module$src$mode$$().development&&($JSCompiler_StaticMethods_fetchJwt_$self$$.H.D()?$jwtPromise$$=$jwtPromise$$.then(function($jwtPromise$$){return $JSCompiler_StaticMethods_fetchJwt_$self$$.H.C($jwtPromise$$.encoded,
$JSCompiler_StaticMethods_loadKeyPem_$$($JSCompiler_StaticMethods_fetchJwt_$self$$)).then(function(){return $jwtPromise$$})}):$user$$module$src$log$$().warn("amp-access-server-jwt","Cannot verify signature on this browser since it doesn't support WebCrypto APIs"),$jwtPromise$$=$jwtPromise$$.then(function($JSCompiler_StaticMethods_fetchJwt_$self$$){var $jwtPromise$$=$JSCompiler_StaticMethods_fetchJwt_$self$$.jwt,$resp$jscomp$2$$=Date.now(),$JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$=
$jwtPromise$$.exp;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$,'"exp" field must be specified');$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(1E3*parseFloat($JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$)>$resp$jscomp$2$$,"token has expired: %s",$JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$);$jwtPromise$$=$jwtPromise$$.aud;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($jwtPromise$$,
'"aud" field must be specified');$resp$jscomp$2$$=!1;if($isArray$$module$src$types$$($jwtPromise$$))for($JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$=0;$JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$<$jwtPromise$$.length;$JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$++){if("ampproject.org"==$jwtPromise$$[$JSCompiler_exp$jscomp$inline_1235_JSCompiler_i$jscomp$inline_1238$$]){$resp$jscomp$2$$=!0;break}}else $resp$jscomp$2$$="ampproject.org"==
$jwtPromise$$;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($resp$jscomp$2$$,'"aud" must be "%s": %s',"ampproject.org",$jwtPromise$$);return $JSCompiler_StaticMethods_fetchJwt_$self$$}));return $jwtPromise$$.catch(function($JSCompiler_StaticMethods_fetchJwt_$self$$){throw $user$$module$src$log$$().createError("JWT fetch or validation failed: ",$JSCompiler_StaticMethods_fetchJwt_$self$$);})}
function $JSCompiler_StaticMethods_loadKeyPem_$$($JSCompiler_StaticMethods_loadKeyPem_$self$$){return $JSCompiler_StaticMethods_loadKeyPem_$self$$.C?Promise.resolve($JSCompiler_StaticMethods_loadKeyPem_$self$$.C):$JSCompiler_StaticMethods_loadKeyPem_$self$$.$xhr_$.fetchText($JSCompiler_StaticMethods_loadKeyPem_$self$$.B).then(function($JSCompiler_StaticMethods_loadKeyPem_$self$$){return $JSCompiler_StaticMethods_loadKeyPem_$self$$.text()})}
function $JSCompiler_StaticMethods_authorizeOnClient_$$($JSCompiler_StaticMethods_authorizeOnClient_$self$$){return $JSCompiler_StaticMethods_fetchJwt_$$($JSCompiler_StaticMethods_authorizeOnClient_$self$$).then(function($JSCompiler_StaticMethods_authorizeOnClient_$self$$){return $JSCompiler_StaticMethods_authorizeOnClient_$self$$.jwt.amp_authdata})}
function $JSCompiler_StaticMethods_authorizeOnServer_$$($JSCompiler_StaticMethods_authorizeOnServer_$self$$){return $JSCompiler_StaticMethods_fetchJwt_$$($JSCompiler_StaticMethods_authorizeOnServer_$self$$).then(function($request$jscomp$11_resp$jscomp$4$$){var $encoded$jscomp$2$$=$request$jscomp$11_resp$jscomp$4$$.encoded,$accessData$jscomp$1$$=$request$jscomp$11_resp$jscomp$4$$.jwt.amp_authdata;$request$jscomp$11_resp$jscomp$4$$=$serializeQueryString$$module$src$url$$($dict$$module$src$utils$object$$({url:$removeFragment$$module$src$url$$($JSCompiler_StaticMethods_authorizeOnServer_$self$$.ampdoc.win.location.href),
state:$JSCompiler_StaticMethods_authorizeOnServer_$self$$.F,jwt:$encoded$jscomp$2$$}));return $JSCompiler_StaticMethods_authorizeOnServer_$self$$.$timer_$.timeoutPromise(3E3,$JSCompiler_StaticMethods_authorizeOnServer_$self$$.$xhr_$.fetchDocument($JSCompiler_StaticMethods_authorizeOnServer_$self$$.I,{method:"POST",body:$request$jscomp$11_resp$jscomp$4$$,headers:{"Content-Type":"application/x-www-form-urlencoded"},requireAmpResponseSourceOrigin:!1})).then(function($request$jscomp$11_resp$jscomp$4$$){return $JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$$($JSCompiler_StaticMethods_authorizeOnServer_$self$$,
$request$jscomp$11_resp$jscomp$4$$)}).then(function(){return $accessData$jscomp$1$$})})}
function $JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$$($JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$self$$,$doc$jscomp$63$$){var $sections$jscomp$1$$=$doc$jscomp$63$$.querySelectorAll("[i-amphtml-access-id]");return $JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$self$$.$vsync_$.mutatePromise(function(){for(var $doc$jscomp$63$$=0;$doc$jscomp$63$$<
$sections$jscomp$1$$.length;$doc$jscomp$63$$++){var $section$jscomp$2$$=$sections$jscomp$1$$[$doc$jscomp$63$$],$sectionId$jscomp$1$$=$section$jscomp$2$$.getAttribute("i-amphtml-access-id"),$target$jscomp$104$$=$JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$self$$.ampdoc.getRootNode().querySelector('[i-amphtml-access-id="'+$cssEscape$$module$third_party$css_escape$css_escape$$($sectionId$jscomp$1$$)+'"]');$target$jscomp$104$$?
$target$jscomp$104$$.parentElement.replaceChild($JSCompiler_StaticMethods_AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt_prototype$replaceSections_$self$$.ampdoc.win.document.importNode($section$jscomp$2$$,!0),$target$jscomp$104$$):$dev$$module$src$log$$().warn("amp-access-server-jwt","Section not found: ",$sectionId$jscomp$1$$)}})};var $RETURN_URL_REGEX$$module$extensions$amp_access$0_1$login_dialog$$=/RETURN_URL/;
function $createLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($ampdoc$jscomp$101$$,$urlOrPromise$$){var $viewer$jscomp$29$$=$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$101$$),$overrideDialog$$=parseInt($viewer$jscomp$29$$.getParam("dialog"),10);return $overrideDialog$$?new $ViewerLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($viewer$jscomp$29$$,$urlOrPromise$$):new $WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($ampdoc$jscomp$101$$.win,$viewer$jscomp$29$$,
$urlOrPromise$$)}function $openLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($ampdoc$jscomp$102$$,$urlOrPromise$jscomp$1$$){return $createLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($ampdoc$jscomp$102$$,$urlOrPromise$jscomp$1$$).K()}function $ViewerLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($viewer$jscomp$30$$,$urlOrPromise$jscomp$3$$){this.viewer=$viewer$jscomp$30$$;this.B=$urlOrPromise$jscomp$3$$}
$ViewerLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$.prototype.I=function(){return("string"==typeof this.B?Promise.resolve(this.B):this.B).then(function($url$jscomp$107$$){return $buildLoginUrl$$module$extensions$amp_access$0_1$login_dialog$$($url$jscomp$107$$,"RETURN_URL")})};
$ViewerLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$.prototype.K=function(){var $$jscomp$this$jscomp$233$$=this;return this.I().then(function($loginUrl$$){return $$jscomp$this$jscomp$233$$.viewer.sendMessageAwaitResponse("openDialog",$dict$$module$src$utils$object$$({url:$loginUrl$$}))})};
function $WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$($win$jscomp$245$$,$viewer$jscomp$31$$,$urlOrPromise$jscomp$4$$){this.win=$win$jscomp$245$$;this.viewer=$viewer$jscomp$31$$;this.C=$urlOrPromise$jscomp$4$$;this.H=this.D=this.G=this.B=this.J=this.F=null}
$WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$.prototype.K=function(){var $$jscomp$this$jscomp$234$$=this;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!this.F,"Dialog already opened");return(new Promise(function($resolve$jscomp$46$$,$reject$jscomp$17$$){$$jscomp$this$jscomp$234$$.F=$resolve$jscomp$46$$;$$jscomp$this$jscomp$234$$.J=$reject$jscomp$17$$;$JSCompiler_StaticMethods_openInternal_$$($$jscomp$this$jscomp$234$$)})).then(function($result$jscomp$17$$){$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$$($$jscomp$this$jscomp$234$$);
return $result$jscomp$17$$},function($error$jscomp$37$$){$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$$($$jscomp$this$jscomp$234$$);throw $error$jscomp$37$$;})};
function $JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$$($JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$){$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.F=null;$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.J=null;if($JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.B){try{$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.B.close()}catch($e$jscomp$118$$){}$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.B=
null}$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.D&&($JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.win.clearInterval($JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.D),$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.D=null);$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.H&&
($JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.H(),$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$self$$.H=null)}
$WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$.prototype.I=function(){var $$jscomp$this$jscomp$235$$=this;return("string"==typeof this.C?Promise.resolve(this.C):this.C).then(function($url$jscomp$108$$){return $buildLoginUrl$$module$extensions$amp_access$0_1$login_dialog$$($url$jscomp$108$$,$JSCompiler_StaticMethods_getReturnUrl_$$($$jscomp$this$jscomp$235$$))})};
function $JSCompiler_StaticMethods_openInternal_$$($JSCompiler_StaticMethods_openInternal_$self$$){var $options$jscomp$20_screen$jscomp$5$$=$JSCompiler_StaticMethods_openInternal_$self$$.win.screen,$loginUrl$jscomp$1_w$jscomp$11$$=Math.floor(Math.min(700,.9*$options$jscomp$20_screen$jscomp$5$$.width)),$h$jscomp$14$$=Math.floor(Math.min(450,.9*$options$jscomp$20_screen$jscomp$5$$.height)),$sizing$$="height="+$h$jscomp$14$$+",width="+$loginUrl$jscomp$1_w$jscomp$11$$+",left="+Math.floor(($options$jscomp$20_screen$jscomp$5$$.width-
$loginUrl$jscomp$1_w$jscomp$11$$)/2)+",top="+Math.floor(($options$jscomp$20_screen$jscomp$5$$.height-$h$jscomp$14$$)/2),$options$jscomp$20_screen$jscomp$5$$=$sizing$$+",resizable=yes,scrollbars=yes",$returnUrl$$=$JSCompiler_StaticMethods_getReturnUrl_$$($JSCompiler_StaticMethods_openInternal_$self$$);$JSCompiler_StaticMethods_openInternal_$self$$.G=null;"string"==typeof $JSCompiler_StaticMethods_openInternal_$self$$.C?($loginUrl$jscomp$1_w$jscomp$11$$=$buildLoginUrl$$module$extensions$amp_access$0_1$login_dialog$$($JSCompiler_StaticMethods_openInternal_$self$$.C,
$returnUrl$$),$JSCompiler_StaticMethods_openInternal_$self$$.B=$openWindowDialog$$module$src$dom$$($JSCompiler_StaticMethods_openInternal_$self$$.win,$loginUrl$jscomp$1_w$jscomp$11$$,"_blank",$options$jscomp$20_screen$jscomp$5$$),$JSCompiler_StaticMethods_openInternal_$self$$.B&&($JSCompiler_StaticMethods_openInternal_$self$$.G=Promise.resolve())):($JSCompiler_StaticMethods_openInternal_$self$$.B=$openWindowDialog$$module$src$dom$$($JSCompiler_StaticMethods_openInternal_$self$$.win,"","_blank",$options$jscomp$20_screen$jscomp$5$$),
$JSCompiler_StaticMethods_openInternal_$self$$.B&&($JSCompiler_StaticMethods_openInternal_$self$$.G=$JSCompiler_StaticMethods_openInternal_$self$$.C.then(function($options$jscomp$20_screen$jscomp$5$$){$options$jscomp$20_screen$jscomp$5$$=$buildLoginUrl$$module$extensions$amp_access$0_1$login_dialog$$($options$jscomp$20_screen$jscomp$5$$,$returnUrl$$);$JSCompiler_StaticMethods_openInternal_$self$$.B.location.replace($options$jscomp$20_screen$jscomp$5$$)},function($JSCompiler_StaticMethods_openInternal_$self$$){throw Error("failed to resolve url: "+
$JSCompiler_StaticMethods_openInternal_$self$$);})));$JSCompiler_StaticMethods_openInternal_$self$$.G?$JSCompiler_StaticMethods_openInternal_$self$$.G.then(function(){$JSCompiler_StaticMethods_setupDialog_$$($JSCompiler_StaticMethods_openInternal_$self$$,$returnUrl$$)},function($options$jscomp$20_screen$jscomp$5$$){$JSCompiler_StaticMethods_loginDone_$$($JSCompiler_StaticMethods_openInternal_$self$$,null,$options$jscomp$20_screen$jscomp$5$$)}):$JSCompiler_StaticMethods_loginDone_$$($JSCompiler_StaticMethods_openInternal_$self$$,
null,Error("failed to open dialog"))}
function $JSCompiler_StaticMethods_setupDialog_$$($JSCompiler_StaticMethods_setupDialog_$self$$,$returnUrl$jscomp$1$$){var $returnOrigin$$=$parseUrlDeprecated$$module$src$url$$($returnUrl$jscomp$1$$).origin;$JSCompiler_StaticMethods_setupDialog_$self$$.D=$JSCompiler_StaticMethods_setupDialog_$self$$.win.setInterval(function(){$JSCompiler_StaticMethods_setupDialog_$self$$.B.closed&&($JSCompiler_StaticMethods_setupDialog_$self$$.win.clearInterval($JSCompiler_StaticMethods_setupDialog_$self$$.D),$JSCompiler_StaticMethods_setupDialog_$self$$.D=
null,$JSCompiler_StaticMethods_setupDialog_$self$$.win.setTimeout(function(){$JSCompiler_StaticMethods_loginDone_$$($JSCompiler_StaticMethods_setupDialog_$self$$,"")},3E3))},500);$JSCompiler_StaticMethods_setupDialog_$self$$.H=$listen$$module$src$event_helper$$($JSCompiler_StaticMethods_setupDialog_$self$$.win,"message",function($returnUrl$jscomp$1$$){$returnUrl$jscomp$1$$.origin==$returnOrigin$$&&$returnUrl$jscomp$1$$.data&&"amp"==$returnUrl$jscomp$1$$.data.sentinel&&"result"==$returnUrl$jscomp$1$$.data.type&&
($JSCompiler_StaticMethods_setupDialog_$self$$.B&&$JSCompiler_StaticMethods_setupDialog_$self$$.B.postMessage($dict$$module$src$utils$object$$({sentinel:"amp",type:"result-ack"}),$returnOrigin$$),$JSCompiler_StaticMethods_loginDone_$$($JSCompiler_StaticMethods_setupDialog_$self$$,$returnUrl$jscomp$1$$.data.result))})}
function $JSCompiler_StaticMethods_loginDone_$$($JSCompiler_StaticMethods_loginDone_$self$$,$result$jscomp$18$$,$opt_error$jscomp$2$$){$JSCompiler_StaticMethods_loginDone_$self$$.F&&($opt_error$jscomp$2$$?$JSCompiler_StaticMethods_loginDone_$self$$.J($opt_error$jscomp$2$$):$JSCompiler_StaticMethods_loginDone_$self$$.F($result$jscomp$18$$),$JSCompiler_StaticMethods_WebLoginDialog$$module$extensions$amp_access$0_1$login_dialog_prototype$cleanup_$$($JSCompiler_StaticMethods_loginDone_$self$$))}
function $JSCompiler_StaticMethods_getReturnUrl_$$($JSCompiler_StaticMethods_getReturnUrl_$self$$){var $currentUrl$$=$JSCompiler_StaticMethods_getReturnUrl_$self$$.viewer.getResolvedViewerUrl();return $module$src$config$$.urls.cdn+"/v0/amp-login-done-0.1.html?url="+encodeURIComponent($currentUrl$$)}
function $buildLoginUrl$$module$extensions$amp_access$0_1$login_dialog$$($url$jscomp$110$$,$returnUrl$jscomp$3$$){return $RETURN_URL_REGEX$$module$extensions$amp_access$0_1$login_dialog$$.test($url$jscomp$110$$)?$url$jscomp$110$$.replace($RETURN_URL_REGEX$$module$extensions$amp_access$0_1$login_dialog$$,encodeURIComponent($returnUrl$jscomp$3$$)):$url$jscomp$110$$+(-1==$url$jscomp$110$$.indexOf("?")?"?":"&")+"return="+encodeURIComponent($returnUrl$jscomp$3$$)};function $SignInProtocol$$module$extensions$amp_access$0_1$signin$$($ampdoc$jscomp$104$$,$viewer$jscomp$32$$,$pubOrigin$$,$configJson$jscomp$9$$){this.ampdoc=$ampdoc$jscomp$104$$;this.$viewer_$=$viewer$jscomp$32$$;this.C=$pubOrigin$$;this.D=$isExperimentOn$$module$src$experiments$$($ampdoc$jscomp$104$$.win,"amp-access-signin")&&this.$viewer_$.isEmbedded()&&"1"==this.$viewer_$.getParam("signin");var $acceptAccessToken$$,$supportsSignInService$$;if(this.D){$acceptAccessToken$$=!!$configJson$jscomp$9$$.acceptAccessToken;
var $viewerSignInService$$=this.$viewer_$.getParam("signinService"),$configSignInServices$$=$configJson$jscomp$9$$.signinServices;$configSignInServices$$&&$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($isArray$$module$src$types$$($configSignInServices$$),'"signinServices" must be an array');$supportsSignInService$$=$configSignInServices$$&&-1!=$configSignInServices$$.indexOf($viewerSignInService$$)}else $supportsSignInService$$=$acceptAccessToken$$=!1;this.F=$acceptAccessToken$$;
this.G=$supportsSignInService$$;this.B=null}$JSCompiler_prototypeAlias$$=$SignInProtocol$$module$extensions$amp_access$0_1$signin$$.prototype;$JSCompiler_prototypeAlias$$.isEnabled=function(){return this.D};$JSCompiler_prototypeAlias$$.start=function(){this.getAccessTokenPassive()};
$JSCompiler_prototypeAlias$$.getAccessTokenPassive=function(){if(!this.F)return null;this.B||(this.B=this.$viewer_$.sendMessageAwaitResponse("getAccessTokenPassive",$dict$$module$src$utils$object$$({origin:this.C})).then(function($resp$jscomp$5$$){return $resp$jscomp$5$$}).catch(function($reason$jscomp$22$$){$user$$module$src$log$$().error("amp-access-signin","Failed to retrieve access token: ",$reason$jscomp$22$$);return null}));return this.B};
$JSCompiler_prototypeAlias$$.postLoginResult=function($query$jscomp$6$$){var $$jscomp$this$jscomp$238$$=this;if(!this.F)return null;var $authorizationCode$$=$query$jscomp$6$$.code;return $authorizationCode$$?this.$viewer_$.sendMessageAwaitResponse("storeAccessToken",$dict$$module$src$utils$object$$({origin:this.C,authorizationCode:$authorizationCode$$})).then(function($query$jscomp$6$$){$$jscomp$this$jscomp$238$$.B=Promise.resolve($query$jscomp$6$$);return $query$jscomp$6$$}).catch(function($query$jscomp$6$$){$user$$module$src$log$$().error("amp-access-signin",
"Failed to retrieve access token: ",$query$jscomp$6$$);return null}):null};$JSCompiler_prototypeAlias$$.requestSignIn=function($url$jscomp$111$$){var $$jscomp$this$jscomp$239$$=this;return this.G?this.$viewer_$.sendMessageAwaitResponse("requestSignIn",$dict$$module$src$utils$object$$({origin:this.C,url:$url$jscomp$111$$})).then(function($url$jscomp$111$$){$$jscomp$this$jscomp$239$$.B=Promise.resolve($url$jscomp$111$$);return""}):null};var $AccessType$$module$extensions$amp_access$0_1$amp_access_source$$={CLIENT:"client",IFRAME:"iframe",SERVER:"server",VENDOR:"vendor",OTHER:"other"};
function $AccessSource$$module$extensions$amp_access$0_1$amp_access_source$$($ampdoc$jscomp$105_deferred$jscomp$22$$,$configJson$jscomp$10$$,$readerIdFn$$,$scheduleViewFn$$,$onReauthorizeFn$$,$accessElement$$){this.ampdoc=$ampdoc$jscomp$105_deferred$jscomp$22$$;this.P=$readerIdFn$$;this.V=$scheduleViewFn$$;this.S=$onReauthorizeFn$$;this.O=$accessElement$$;this.J=$isExperimentOn$$module$src$experiments$$($ampdoc$jscomp$105_deferred$jscomp$22$$.win,"amp-access-server");this.X=$isExperimentOn$$module$src$experiments$$($ampdoc$jscomp$105_deferred$jscomp$22$$.win,
"amp-access-jwt");var $JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$=$configJson$jscomp$10$$.type?$user$$module$src$log$$().assertEnumValue($AccessType$$module$extensions$amp_access$0_1$amp_access_source$$,$configJson$jscomp$10$$.type,"access type"):null;$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$||($JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$=$configJson$jscomp$10$$.vendor?"vendor":"client");"server"!=
$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$||this.J||($user$$module$src$log$$().warn("amp-access",'Experiment "amp-access-server" is not enabled.'),$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$="client");"client"==$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$&&this.J&&($user$$module$src$log$$().$Log$$module$src$log_prototype$info$("amp-access","Forcing access type: SERVER"),$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$=
"server");"iframe"!=$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$||$isExperimentOn$$module$src$experiments$$(this.ampdoc.win,"amp-access-iframe")||($user$$module$src$log$$().error("amp-access",'Experiment "amp-access-iframe" is not enabled.'),$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$="client");this.$type_$=$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$;var $JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$=
$configJson$jscomp$10$$.login,$JSCompiler_loginMap$jscomp$inline_1253$$={};if($JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$)if("string"==typeof $JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$)$JSCompiler_loginMap$jscomp$inline_1253$$[""]=$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$;else if($isObject$$module$src$types$$($JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$))for(var $JSCompiler_k$jscomp$inline_1254$$ in $JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$)$JSCompiler_loginMap$jscomp$inline_1253$$[$JSCompiler_k$jscomp$inline_1254$$]=
$JSCompiler_loginConfig$jscomp$inline_1252_JSCompiler_type$jscomp$inline_1248$$[$JSCompiler_k$jscomp$inline_1254$$];else $user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!1,'"login" must be either a single URL or a map of URLs');for(var $k$131$jscomp$inline_1255$$ in $JSCompiler_loginMap$jscomp$inline_1253$$)$assertHttpsUrl$$module$src$url$$($JSCompiler_loginMap$jscomp$inline_1253$$[$k$131$jscomp$inline_1255$$],this.O);this.F=$JSCompiler_loginMap$jscomp$inline_1253$$;this.I=$configJson$jscomp$10$$.authorizationFallbackResponse;
this.R=$configJson$jscomp$10$$.namespace||null;this.C=$JSCompiler_StaticMethods_createAdapter_$$(this,$configJson$jscomp$10$$);this.U=$getSourceOrigin$$module$src$url$$($ampdoc$jscomp$105_deferred$jscomp$22$$.win.location);this.$urlReplacements_$=$Services$$module$src$services$urlReplacementsForDoc$$($ampdoc$jscomp$105_deferred$jscomp$22$$);this.$viewer_$=$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$105_deferred$jscomp$22$$);this.Y=$openLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$.bind(null,
$ampdoc$jscomp$105_deferred$jscomp$22$$);this.D=null;this.G=new $SignInProtocol$$module$extensions$amp_access$0_1$signin$$($ampdoc$jscomp$105_deferred$jscomp$22$$,this.$viewer_$,this.U,$configJson$jscomp$10$$);$ampdoc$jscomp$105_deferred$jscomp$22$$=new $Deferred$$module$src$utils$promise$$;this.W=$ampdoc$jscomp$105_deferred$jscomp$22$$.promise;this.H=$ampdoc$jscomp$105_deferred$jscomp$22$$.resolve;this.M={};this.B=null;this.K=0}$JSCompiler_prototypeAlias$$=$AccessSource$$module$extensions$amp_access$0_1$amp_access_source$$.prototype;
$JSCompiler_prototypeAlias$$.getNamespace=function(){return this.R};$JSCompiler_prototypeAlias$$.getAdapter=function(){return this.C};$JSCompiler_prototypeAlias$$.getAuthResponse=function(){return this.D};
function $JSCompiler_StaticMethods_createAdapter_$$($JSCompiler_StaticMethods_createAdapter_$self$$,$configJson$jscomp$11$$){var $context$jscomp$10$$={buildUrl:$JSCompiler_StaticMethods_createAdapter_$self$$.buildUrl.bind($JSCompiler_StaticMethods_createAdapter_$self$$),collectUrlVars:$JSCompiler_StaticMethods_createAdapter_$self$$.collectUrlVars.bind($JSCompiler_StaticMethods_createAdapter_$self$$)},$isJwt$$=$JSCompiler_StaticMethods_createAdapter_$self$$.X&&!0===$configJson$jscomp$11$$.jwt;switch($JSCompiler_StaticMethods_createAdapter_$self$$.$type_$){case "client":return $isJwt$$?
new $AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,$configJson$jscomp$11$$,$context$jscomp$10$$):new $AccessClientAdapter$$module$extensions$amp_access$0_1$amp_access_client$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,$configJson$jscomp$11$$,$context$jscomp$10$$);case "iframe":return new $AccessIframeAdapter$$module$extensions$amp_access$0_1$amp_access_iframe$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,
$configJson$jscomp$11$$,$context$jscomp$10$$);case "server":return $isJwt$$?new $AccessServerJwtAdapter$$module$extensions$amp_access$0_1$amp_access_server_jwt$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,$configJson$jscomp$11$$,$context$jscomp$10$$):new $AccessServerAdapter$$module$extensions$amp_access$0_1$amp_access_server$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,$configJson$jscomp$11$$,$context$jscomp$10$$);case "vendor":return new $AccessVendorAdapter$$module$extensions$amp_access$0_1$amp_access_vendor$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,
$configJson$jscomp$11$$);case "other":return new $AccessOtherAdapter$$module$extensions$amp_access$0_1$amp_access_other$$($JSCompiler_StaticMethods_createAdapter_$self$$.ampdoc,$configJson$jscomp$11$$,$context$jscomp$10$$)}throw $dev$$module$src$log$$().createError("Unsupported access type: ",$JSCompiler_StaticMethods_createAdapter_$self$$.$type_$);}$JSCompiler_prototypeAlias$$.getAdapterConfig=function(){return this.C.getConfig()};$JSCompiler_prototypeAlias$$.whenFirstAuthorized=function(){return this.W};
$JSCompiler_prototypeAlias$$.$analyticsEvent_$=function($eventType$jscomp$23$$){var $JSCompiler_root$jscomp$inline_1258$$=this.ampdoc.getRootNode();$triggerAnalyticsEvent$$module$src$analytics$$($JSCompiler_root$jscomp$inline_1258$$.documentElement||$JSCompiler_root$jscomp$inline_1258$$.body||$JSCompiler_root$jscomp$inline_1258$$,$eventType$jscomp$23$$)};$JSCompiler_prototypeAlias$$.start=function(){$JSCompiler_StaticMethods_buildLoginUrls_$$(this);this.G.start()};
$JSCompiler_prototypeAlias$$.buildUrl=function($url$jscomp$112$$,$useAuthData$$){var $$jscomp$this$jscomp$240$$=this;return $JSCompiler_StaticMethods_prepareUrlVars_$$(this,$useAuthData$$).then(function($useAuthData$$){return $$jscomp$this$jscomp$240$$.$urlReplacements_$.expandUrlAsync($url$jscomp$112$$,$useAuthData$$)})};
$JSCompiler_prototypeAlias$$.collectUrlVars=function($url$jscomp$113$$,$useAuthData$jscomp$1$$){var $$jscomp$this$jscomp$241$$=this;return $JSCompiler_StaticMethods_prepareUrlVars_$$(this,$useAuthData$jscomp$1$$).then(function($useAuthData$jscomp$1$$){return $$jscomp$this$jscomp$241$$.$urlReplacements_$.collectVars($url$jscomp$113$$,$useAuthData$jscomp$1$$)})};
function $JSCompiler_StaticMethods_prepareUrlVars_$$($JSCompiler_StaticMethods_prepareUrlVars_$self$$,$useAuthData$jscomp$2$$){return $JSCompiler_StaticMethods_prepareUrlVars_$self$$.P().then(function($readerId$jscomp$1_vars$jscomp$9$$){$readerId$jscomp$1_vars$jscomp$9$$={READER_ID:$readerId$jscomp$1_vars$jscomp$9$$,ACCESS_READER_ID:$readerId$jscomp$1_vars$jscomp$9$$,ACCESS_TOKEN:function(){return $JSCompiler_StaticMethods_prepareUrlVars_$self$$.G.getAccessTokenPassive()}};$useAuthData$jscomp$2$$&&
($readerId$jscomp$1_vars$jscomp$9$$.AUTHDATA=function($useAuthData$jscomp$2$$){if($JSCompiler_StaticMethods_prepareUrlVars_$self$$.D)return $getValueForExpr$$module$src$json$$($JSCompiler_StaticMethods_prepareUrlVars_$self$$.D,$useAuthData$jscomp$2$$)});return $readerId$jscomp$1_vars$jscomp$9$$})}
$JSCompiler_prototypeAlias$$.runAuthorization=function($opt_disableFallback$$){var $$jscomp$this$jscomp$243$$=this;return this.C.isAuthorizationEnabled()?this.C.authorize().catch(function($error$jscomp$40$$){$$jscomp$this$jscomp$243$$.$analyticsEvent_$("access-authorization-failed");if($$jscomp$this$jscomp$243$$.I&&!$opt_disableFallback$$)return $user$$module$src$log$$().error("amp-access","Authorization failed: ",$error$jscomp$40$$),$$jscomp$this$jscomp$243$$.I;throw $error$jscomp$40$$;}).then(function($opt_disableFallback$$){$$jscomp$this$jscomp$243$$.D=
$opt_disableFallback$$;$$jscomp$this$jscomp$243$$.H();$JSCompiler_StaticMethods_buildLoginUrls_$$($$jscomp$this$jscomp$243$$);return $opt_disableFallback$$}).catch(function($opt_disableFallback$$){$user$$module$src$log$$().error("amp-access","Authorization failed: ",$opt_disableFallback$$);$$jscomp$this$jscomp$243$$.H();throw $opt_disableFallback$$;}):(this.H(),Promise.resolve())};
$JSCompiler_prototypeAlias$$.reportViewToServer=function(){var $$jscomp$this$jscomp$244$$=this;return this.C.pingback().then(function(){$$jscomp$this$jscomp$244$$.$analyticsEvent_$("access-pingback-sent")}).catch(function($error$jscomp$42$$){$$jscomp$this$jscomp$244$$.$analyticsEvent_$("access-pingback-failed");throw $user$$module$src$log$$().createError("Pingback failed: ",$error$jscomp$42$$);})};
$JSCompiler_prototypeAlias$$.$AccessSource$$module$extensions$amp_access$0_1$amp_access_source_prototype$getLoginUrl$=function($urlOrPromise$jscomp$5$$){return $createLoginDialog$$module$extensions$amp_access$0_1$login_dialog$$(this.ampdoc,$urlOrPromise$jscomp$5$$).I()};
$JSCompiler_prototypeAlias$$.loginWithType=function($type$jscomp$132$$){$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(this.F[$type$jscomp$132$$],"Login URL is not configured: %s",$type$jscomp$132$$);var $loginUrl$jscomp$3$$=$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(this.M[$type$jscomp$132$$],"Login URL is not ready: %s",$type$jscomp$132$$);return $JSCompiler_StaticMethods_login_$$(this,$loginUrl$jscomp$3$$,$type$jscomp$132$$)};
$JSCompiler_prototypeAlias$$.loginWithUrl=function($url$jscomp$114$$,$eventLabel$$){$eventLabel$$=void 0===$eventLabel$$?"":$eventLabel$$;return $JSCompiler_StaticMethods_login_$$(this,$url$jscomp$114$$,$eventLabel$$)};
function $JSCompiler_StaticMethods_login_$$($JSCompiler_StaticMethods_login_$self$$,$loginUrl$jscomp$4$$,$eventLabel$jscomp$1$$){var $now$jscomp$22$$=Date.now();if($JSCompiler_StaticMethods_login_$self$$.B&&1E3>$now$jscomp$22$$-$JSCompiler_StaticMethods_login_$self$$.K)return $JSCompiler_StaticMethods_login_$self$$.B;$JSCompiler_StaticMethods_loginAnalyticsEvent_$$($JSCompiler_StaticMethods_login_$self$$,$eventLabel$jscomp$1$$,"started");var $dialogPromise$$=$JSCompiler_StaticMethods_login_$self$$.G.requestSignIn($loginUrl$jscomp$4$$)||
$JSCompiler_StaticMethods_login_$self$$.Y($loginUrl$jscomp$4$$),$loginPromise$$=$dialogPromise$$.then(function($loginUrl$jscomp$4$$){$JSCompiler_StaticMethods_login_$self$$.B=null;$loginUrl$jscomp$4$$=$parseQueryString_$$module$src$url_parse_query_string$$($loginUrl$jscomp$4$$);var $now$jscomp$22$$=$loginUrl$jscomp$4$$.success,$dialogPromise$$="true"==$now$jscomp$22$$||"yes"==$now$jscomp$22$$||"1"==$now$jscomp$22$$;$dialogPromise$$?$JSCompiler_StaticMethods_loginAnalyticsEvent_$$($JSCompiler_StaticMethods_login_$self$$,
$eventLabel$jscomp$1$$,"success"):$JSCompiler_StaticMethods_loginAnalyticsEvent_$$($JSCompiler_StaticMethods_login_$self$$,$eventLabel$jscomp$1$$,"rejected");var $loginPromise$$=$JSCompiler_StaticMethods_login_$self$$.G.postLoginResult($loginUrl$jscomp$4$$)||Promise.resolve();if($dialogPromise$$||!$now$jscomp$22$$)return $JSCompiler_StaticMethods_login_$self$$.C.postAction(),$loginPromise$$.then(function(){var $loginUrl$jscomp$4$$=$JSCompiler_StaticMethods_login_$self$$.runAuthorization(!0);$JSCompiler_StaticMethods_login_$self$$.S($loginUrl$jscomp$4$$);
return $loginUrl$jscomp$4$$.then(function(){$JSCompiler_StaticMethods_login_$self$$.V(0)})})}).catch(function($loginUrl$jscomp$4$$){$JSCompiler_StaticMethods_loginAnalyticsEvent_$$($JSCompiler_StaticMethods_login_$self$$,$eventLabel$jscomp$1$$,"failed");$JSCompiler_StaticMethods_login_$self$$.B==$loginPromise$$&&($JSCompiler_StaticMethods_login_$self$$.B=null);throw $loginUrl$jscomp$4$$;});$JSCompiler_StaticMethods_login_$self$$.B=$loginPromise$$;$JSCompiler_StaticMethods_login_$self$$.K=$now$jscomp$22$$;
return $JSCompiler_StaticMethods_login_$self$$.B}function $JSCompiler_StaticMethods_loginAnalyticsEvent_$$($JSCompiler_StaticMethods_loginAnalyticsEvent_$self$$,$type$jscomp$133$$,$event$jscomp$46$$){$JSCompiler_StaticMethods_loginAnalyticsEvent_$self$$.$analyticsEvent_$("access-login-"+$event$jscomp$46$$);$type$jscomp$133$$&&$JSCompiler_StaticMethods_loginAnalyticsEvent_$self$$.$analyticsEvent_$("access-login-"+$type$jscomp$133$$+"-"+$event$jscomp$46$$)}
function $JSCompiler_StaticMethods_buildLoginUrls_$$($JSCompiler_StaticMethods_buildLoginUrls_$self$$){if(Object.keys($JSCompiler_StaticMethods_buildLoginUrls_$self$$.F).length){var $promises$jscomp$6$$=[],$$jscomp$loop$199$$={},$k$jscomp$21$$;for($k$jscomp$21$$ in $JSCompiler_StaticMethods_buildLoginUrls_$self$$.F)$$jscomp$loop$199$$.k=$k$jscomp$21$$,$promises$jscomp$6$$.push($JSCompiler_StaticMethods_buildLoginUrls_$self$$.buildUrl($JSCompiler_StaticMethods_buildLoginUrls_$self$$.F[$$jscomp$loop$199$$.k],
!0).then(function($promises$jscomp$6$$){return function($$jscomp$loop$199$$){$JSCompiler_StaticMethods_buildLoginUrls_$self$$.M[$promises$jscomp$6$$.k]=$$jscomp$loop$199$$;return{type:$promises$jscomp$6$$.k,url:$$jscomp$loop$199$$}}}($$jscomp$loop$199$$))),$$jscomp$loop$199$$={k:$$jscomp$loop$199$$.k};Promise.all($promises$jscomp$6$$)}};function $AccessService$$module$extensions$amp_access$0_1$amp_access$$($ampdoc$jscomp$106$$){var $$jscomp$this$jscomp$247$$=this;this.ampdoc=$ampdoc$jscomp$106$$;$installStylesForDoc$$module$src$style_installer$$($ampdoc$jscomp$106$$,"\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/",function(){},!1,"amp-access");var $accessElement$jscomp$1_promises$jscomp$7$$=$ampdoc$jscomp$106$$.getElementById("amp-access");if(this.D=!!$accessElement$jscomp$1_promises$jscomp$7$$)this.H=$accessElement$jscomp$1_promises$jscomp$7$$,
this.K=$getSourceOrigin$$module$src$url$$($ampdoc$jscomp$106$$.win.location),this.$timer_$=$Services$$module$src$services$timerFor$$($ampdoc$jscomp$106$$.win),this.$vsync_$=$Services$$module$src$services$vsyncFor$$($ampdoc$jscomp$106$$.win),this.O=$Services$$module$src$services$cidForDoc$$($ampdoc$jscomp$106$$),this.$viewer_$=$Services$$module$src$services$viewerForDoc$$($ampdoc$jscomp$106$$),this.$viewport_$=$Services$$module$src$services$viewportForDoc$$($ampdoc$jscomp$106$$),this.$templates_$=
$Services$$module$src$services$templatesFor$$($ampdoc$jscomp$106$$.win),this.M=$Services$$module$src$services$resourcesForDoc$$($ampdoc$jscomp$106$$),this.G=$getExistingServiceOrNull$$module$src$service$$($ampdoc$jscomp$106$$.win),this.J=null,this.B=$JSCompiler_StaticMethods_parseConfig_$$(this),$accessElement$jscomp$1_promises$jscomp$7$$=this.B.map(function($ampdoc$jscomp$106$$){return $ampdoc$jscomp$106$$.whenFirstAuthorized()}),this.I=!1,this.C=Promise.all($accessElement$jscomp$1_promises$jscomp$7$$),
this.F=null,this.C.then(function(){$$jscomp$this$jscomp$247$$.I=!0;$$jscomp$this$jscomp$247$$.$analyticsEvent_$("access-authorization-received");$$jscomp$this$jscomp$247$$.G&&($$jscomp$this$jscomp$247$$.G.$Performance$$module$src$service$performance_impl_prototype$tick$("aaa"),$$jscomp$this$jscomp$247$$.G.tickSinceVisible("aaav"),$$jscomp$this$jscomp$247$$.G.$Performance$$module$src$service$performance_impl_prototype$flush$())}),$ampdoc$jscomp$106$$.getRootNode().addEventListener("amp:dom-update",
this.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$onDomUpdate_$.bind(this))}$JSCompiler_prototypeAlias$$=$AccessService$$module$extensions$amp_access$0_1$amp_access$$.prototype;$JSCompiler_prototypeAlias$$.getAccessReaderId=function(){return this.D?this.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getReaderId_$():null};
$JSCompiler_prototypeAlias$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getReaderId_$=function(){if(!this.J){var $consent$jscomp$2$$=Promise.resolve();this.J=this.O.then(function($cid$jscomp$7$$){return $cid$jscomp$7$$.get({scope:"amp-access",createCookieIfNotPresent:!0},$consent$jscomp$2$$)})}return this.J};
function $JSCompiler_StaticMethods_parseConfig_$$($JSCompiler_StaticMethods_parseConfig_$self$$){var $rawContent$$=$tryParseJson$$module$src$json$$($JSCompiler_StaticMethods_parseConfig_$self$$.H.textContent,function($JSCompiler_StaticMethods_parseConfig_$self$$){throw $user$$module$src$log$$().createError('Failed to parse "amp-access" JSON: '+$JSCompiler_StaticMethods_parseConfig_$self$$);}),$configMap$$={};if($isArray$$module$src$types$$($rawContent$$))for(var $contentArray$$=$rawContent$$,$i$jscomp$188$$=
0;$i$jscomp$188$$<$contentArray$$.length;$i$jscomp$188$$++){var $namespace$jscomp$4$$=$contentArray$$[$i$jscomp$188$$].namespace;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!!$namespace$jscomp$4$$,"Namespace required");$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!$configMap$$[$namespace$jscomp$4$$],"Namespace already used: "+$namespace$jscomp$4$$);$configMap$$[$namespace$jscomp$4$$]=$contentArray$$[$i$jscomp$188$$]}else $configMap$$[$rawContent$$.namespace||
""]=$rawContent$$;var $readerIdFn$jscomp$1$$=$JSCompiler_StaticMethods_parseConfig_$self$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getReaderId_$.bind($JSCompiler_StaticMethods_parseConfig_$self$$),$scheduleViewFn$jscomp$1$$=$JSCompiler_StaticMethods_parseConfig_$self$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$scheduleView_$.bind($JSCompiler_StaticMethods_parseConfig_$self$$),$onReauthorizeFn$jscomp$1$$=$JSCompiler_StaticMethods_parseConfig_$self$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$onReauthorize_$.bind($JSCompiler_StaticMethods_parseConfig_$self$$);
return Object.keys($configMap$$).map(function($rawContent$$){return new $AccessSource$$module$extensions$amp_access$0_1$amp_access_source$$($JSCompiler_StaticMethods_parseConfig_$self$$.ampdoc,$configMap$$[$rawContent$$],$readerIdFn$jscomp$1$$,$scheduleViewFn$jscomp$1$$,$onReauthorizeFn$jscomp$1$$,$JSCompiler_StaticMethods_parseConfig_$self$$.H)})}
$JSCompiler_prototypeAlias$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$onDomUpdate_$=function($event$jscomp$47$$){var $$jscomp$this$jscomp$249$$=this;if(this.I)return this.C.then(function(){var $target$jscomp$105$$=$event$jscomp$47$$.target,$responses$$=$$jscomp$this$jscomp$249$$.combinedResponses();$JSCompiler_StaticMethods_applyAuthorizationToRoot_$$($$jscomp$this$jscomp$249$$,$target$jscomp$105$$,$responses$$)})};
$JSCompiler_prototypeAlias$$.getVendorSource=function($name$jscomp$154$$){for(var $i$jscomp$189$$=0;$i$jscomp$189$$<this.B.length;$i$jscomp$189$$++){var $source$jscomp$29$$=this.B[$i$jscomp$189$$];if("vendor"==$source$jscomp$29$$.$type_$){var $vendorAdapter$$=$source$jscomp$29$$.getAdapter();if($vendorAdapter$$.getVendorName()==$name$jscomp$154$$)return $source$jscomp$29$$}}$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!1,'Access vendor "%s" can only be used for "type=vendor", but none found',
$name$jscomp$154$$);throw Error();};$JSCompiler_prototypeAlias$$.isEnabled=function(){return this.D};
function $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$$($JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$){$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$=$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$.ampdoc.getRootNode();return $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$.documentElement||
$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$.body||$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$self_root$jscomp$18$$}
$JSCompiler_prototypeAlias$$.$analyticsEvent_$=function($eventType$jscomp$24$$){$triggerAnalyticsEvent$$module$src$analytics$$($JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$$(this),$eventType$jscomp$24$$)};
function $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$$($JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$self$$){$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$self$$.$viewer_$.onBroadcast(function($message$jscomp$44$$){"amp-access-reauthorize"==$message$jscomp$44$$.type&&$message$jscomp$44$$.origin==
$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$self$$.K&&$JSCompiler_StaticMethods_runAuthorization_$$($JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$self$$)})}
$JSCompiler_prototypeAlias$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$onReauthorize_$=function($authorization$$){var $$jscomp$this$jscomp$251$$=this;this.$broadcastReauthorize_$();$authorization$$.then(function(){$$jscomp$this$jscomp$251$$.I&&$$jscomp$this$jscomp$251$$.C.then(function(){$$jscomp$this$jscomp$251$$.ampdoc.whenReady().then(function(){var $authorization$$=$$jscomp$this$jscomp$251$$.ampdoc.getRootNode(),$responses$jscomp$1$$=$$jscomp$this$jscomp$251$$.combinedResponses();
return $JSCompiler_StaticMethods_applyAuthorizationToRoot_$$($$jscomp$this$jscomp$251$$,$authorization$$,$responses$jscomp$1$$)})})})};$JSCompiler_prototypeAlias$$.$broadcastReauthorize_$=function(){this.$viewer_$.broadcast($dict$$module$src$utils$object$$({type:"amp-access-reauthorize",origin:this.K}))};
function $JSCompiler_StaticMethods_runAuthorization_$$($JSCompiler_StaticMethods_runAuthorization_$self$$){$JSCompiler_StaticMethods_toggleTopClass_$$($JSCompiler_StaticMethods_runAuthorization_$self$$,"amp-access-loading",!0);var $authorizations$$=$JSCompiler_StaticMethods_runAuthorization_$self$$.$viewer_$.whenFirstVisible().then(function(){return Promise.all($JSCompiler_StaticMethods_runAuthorization_$self$$.B.map(function($authorizations$$){return $JSCompiler_StaticMethods_runOneAuthorization_$$($JSCompiler_StaticMethods_runAuthorization_$self$$,
$authorizations$$)}))}),$rendered$$=$authorizations$$.then(function(){$JSCompiler_StaticMethods_toggleTopClass_$$($JSCompiler_StaticMethods_runAuthorization_$self$$,"amp-access-loading",!1);return $JSCompiler_StaticMethods_runAuthorization_$self$$.ampdoc.whenReady().then(function(){var $authorizations$$=$JSCompiler_StaticMethods_runAuthorization_$self$$.ampdoc.getRootNode(),$rendered$$=$JSCompiler_StaticMethods_runAuthorization_$self$$.combinedResponses();return $JSCompiler_StaticMethods_applyAuthorizationToRoot_$$($JSCompiler_StaticMethods_runAuthorization_$self$$,
$authorizations$$,$rendered$$)})});$JSCompiler_StaticMethods_runAuthorization_$self$$.C=$rendered$$}function $JSCompiler_StaticMethods_runOneAuthorization_$$($JSCompiler_StaticMethods_runOneAuthorization_$self$$,$source$jscomp$31$$){return $source$jscomp$31$$.runAuthorization().catch(function(){$JSCompiler_StaticMethods_toggleTopClass_$$($JSCompiler_StaticMethods_runOneAuthorization_$self$$,"amp-access-error",!0)})}
$JSCompiler_prototypeAlias$$.getAuthdataField=function($field$jscomp$4$$){var $$jscomp$this$jscomp$254$$=this;return this.D?this.C.then(function(){var $responses$jscomp$3_v$jscomp$11$$=$$jscomp$this$jscomp$254$$.combinedResponses(),$responses$jscomp$3_v$jscomp$11$$=$getValueForExpr$$module$src$json$$($responses$jscomp$3_v$jscomp$11$$,$field$jscomp$4$$);return void 0!==$responses$jscomp$3_v$jscomp$11$$?$responses$jscomp$3_v$jscomp$11$$:null}):null};
function $JSCompiler_StaticMethods_applyAuthorizationToRoot_$$($JSCompiler_StaticMethods_applyAuthorizationToRoot_$self$$,$elements$jscomp$16_root$jscomp$21$$,$response$jscomp$23$$){$elements$jscomp$16_root$jscomp$21$$=$elements$jscomp$16_root$jscomp$21$$.querySelectorAll("[amp-access]");for(var $promises$jscomp$8$$=[],$i$jscomp$191$$=0;$i$jscomp$191$$<$elements$jscomp$16_root$jscomp$21$$.length;$i$jscomp$191$$++)$promises$jscomp$8$$.push($JSCompiler_StaticMethods_applyAuthorizationToElement_$$($JSCompiler_StaticMethods_applyAuthorizationToRoot_$self$$,
$elements$jscomp$16_root$jscomp$21$$[$i$jscomp$191$$],$response$jscomp$23$$));return Promise.all($promises$jscomp$8$$)}
function $JSCompiler_StaticMethods_applyAuthorizationToElement_$$($JSCompiler_StaticMethods_applyAuthorizationToElement_$self$$,$element$jscomp$215$$,$response$jscomp$24$$){var $expr$jscomp$13_renderPromise$jscomp$1$$=$element$jscomp$215$$.getAttribute("amp-access"),$JSCompiler_inline_result$jscomp$349$$;a:{try{$module$extensions$amp_access$0_1$access_expr_impl$parser$$.yy=$response$jscomp$24$$;$JSCompiler_inline_result$jscomp$349$$=!!$module$extensions$amp_access$0_1$access_expr_impl$parser$$.parse($expr$jscomp$13_renderPromise$jscomp$1$$);
break a}finally{$module$extensions$amp_access$0_1$access_expr_impl$parser$$.yy=null}$JSCompiler_inline_result$jscomp$349$$=void 0}var $on$jscomp$4$$=$JSCompiler_inline_result$jscomp$349$$,$expr$jscomp$13_renderPromise$jscomp$1$$=null;$on$jscomp$4$$&&($expr$jscomp$13_renderPromise$jscomp$1$$=$JSCompiler_StaticMethods_renderTemplates_$$($JSCompiler_StaticMethods_applyAuthorizationToElement_$self$$,$element$jscomp$215$$,$response$jscomp$24$$));return $expr$jscomp$13_renderPromise$jscomp$1$$?$expr$jscomp$13_renderPromise$jscomp$1$$.then(function(){return $JSCompiler_StaticMethods_applyAuthorizationAttrs_$$($JSCompiler_StaticMethods_applyAuthorizationToElement_$self$$,
$element$jscomp$215$$,$on$jscomp$4$$)}):$JSCompiler_StaticMethods_applyAuthorizationAttrs_$$($JSCompiler_StaticMethods_applyAuthorizationToElement_$self$$,$element$jscomp$215$$,$on$jscomp$4$$)}
function $JSCompiler_StaticMethods_applyAuthorizationAttrs_$$($JSCompiler_StaticMethods_applyAuthorizationAttrs_$self$$,$element$jscomp$216$$,$on$jscomp$5$$){var $wasOn$$=!$element$jscomp$216$$.hasAttribute("amp-access-hide");return $on$jscomp$5$$==$wasOn$$?Promise.resolve():$JSCompiler_StaticMethods_applyAuthorizationAttrs_$self$$.M.mutateElement($element$jscomp$216$$,function(){$on$jscomp$5$$?$element$jscomp$216$$.removeAttribute("amp-access-hide"):$element$jscomp$216$$.setAttribute("amp-access-hide",
"")})}
function $JSCompiler_StaticMethods_renderTemplates_$$($JSCompiler_StaticMethods_renderTemplates_$self$$,$element$jscomp$217$$,$response$jscomp$25$$){var $promises$jscomp$9$$=[],$templateElements$$=$element$jscomp$217$$.querySelectorAll("[amp-access-template]");if(0<$templateElements$$.length)for(var $$jscomp$loop$200$$={i:0};$$jscomp$loop$200$$.i<$templateElements$$.length;$$jscomp$loop$200$$={i:$$jscomp$loop$200$$.i},$$jscomp$loop$200$$.i++){var $p$jscomp$19$$=$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$renderTemplate_$$($JSCompiler_StaticMethods_renderTemplates_$self$$,$templateElements$$[$$jscomp$loop$200$$.i],
$response$jscomp$25$$).catch(function($JSCompiler_StaticMethods_renderTemplates_$self$$){return function($response$jscomp$25$$){$dev$$module$src$log$$().error("amp-access","Template failed: ",$response$jscomp$25$$,$templateElements$$[$JSCompiler_StaticMethods_renderTemplates_$self$$.i],$element$jscomp$217$$)}}($$jscomp$loop$200$$));$promises$jscomp$9$$.push($p$jscomp$19$$)}return 0<$promises$jscomp$9$$.length?Promise.all($promises$jscomp$9$$):null}
function $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$renderTemplate_$$($JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$renderTemplate_$self$$,$templateOrPrev$$,$response$jscomp$26$$){var $template$jscomp$5$$=$templateOrPrev$$,$prev$jscomp$2$$=null;"TEMPLATE"!=$template$jscomp$5$$.tagName&&($prev$jscomp$2$$=$template$jscomp$5$$,$template$jscomp$5$$=$prev$jscomp$2$$.__AMP_ACCESS__TEMPLATE);return $template$jscomp$5$$?
$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$renderTemplate_$self$$.$templates_$.$Templates$$module$src$service$template_impl_prototype$renderTemplate$($template$jscomp$5$$,$response$jscomp$26$$).then(function($templateOrPrev$$){return $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$renderTemplate_$self$$.$vsync_$.mutatePromise(function(){$templateOrPrev$$.setAttribute("amp-access-template","");$templateOrPrev$$.__AMP_ACCESS__TEMPLATE=
$template$jscomp$5$$;$template$jscomp$5$$.parentElement?$template$jscomp$5$$.parentElement.replaceChild($templateOrPrev$$,$template$jscomp$5$$):$prev$jscomp$2$$&&$prev$jscomp$2$$.parentElement&&$prev$jscomp$2$$.parentElement.replaceChild($templateOrPrev$$,$prev$jscomp$2$$)})}):Promise.reject(Error("template not found"))}
$JSCompiler_prototypeAlias$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$scheduleView_$=function($timeToView$$){var $$jscomp$this$jscomp$257$$=this;this.B.some(function($timeToView$$){return $timeToView$$.getAdapter().isPingbackEnabled()})&&(this.F=null,this.ampdoc.whenReady().then(function(){$JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$isVisible$$($$jscomp$this$jscomp$257$$.$viewer_$)&&$JSCompiler_StaticMethods_reportWhenViewed_$$($$jscomp$this$jscomp$257$$,
$timeToView$$);$JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$onVisibilityChanged$$($$jscomp$this$jscomp$257$$.$viewer_$,function(){$JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$isVisible$$($$jscomp$this$jscomp$257$$.$viewer_$)&&$JSCompiler_StaticMethods_reportWhenViewed_$$($$jscomp$this$jscomp$257$$,$timeToView$$)})}))};
function $JSCompiler_StaticMethods_reportWhenViewed_$$($JSCompiler_StaticMethods_reportWhenViewed_$self$$,$timeToView$jscomp$1$$){$JSCompiler_StaticMethods_reportWhenViewed_$self$$.F||($JSCompiler_StaticMethods_reportWhenViewed_$self$$.F=$JSCompiler_StaticMethods_whenViewed_$$($JSCompiler_StaticMethods_reportWhenViewed_$self$$,$timeToView$jscomp$1$$).then(function(){return $JSCompiler_StaticMethods_reportWhenViewed_$self$$.C}).then(function(){$JSCompiler_StaticMethods_reportWhenViewed_$self$$.$analyticsEvent_$("access-viewed");
for(var $timeToView$jscomp$1$$=[],$JSCompiler_i$jscomp$inline_1268$$=0;$JSCompiler_i$jscomp$inline_1268$$<$JSCompiler_StaticMethods_reportWhenViewed_$self$$.B.length;$JSCompiler_i$jscomp$inline_1268$$++)$JSCompiler_StaticMethods_reportWhenViewed_$self$$.B[$JSCompiler_i$jscomp$inline_1268$$].getAdapter().isPingbackEnabled()&&$timeToView$jscomp$1$$.push($JSCompiler_StaticMethods_reportWhenViewed_$self$$.B[$JSCompiler_i$jscomp$inline_1268$$].reportViewToServer());return Promise.all($timeToView$jscomp$1$$)}).catch(function($timeToView$jscomp$1$$){$JSCompiler_StaticMethods_reportWhenViewed_$self$$.F=
null;throw $timeToView$jscomp$1$$;}),$JSCompiler_StaticMethods_reportWhenViewed_$self$$.F.then($JSCompiler_StaticMethods_reportWhenViewed_$self$$.$broadcastReauthorize_$.bind($JSCompiler_StaticMethods_reportWhenViewed_$self$$)))}
function $JSCompiler_StaticMethods_whenViewed_$$($JSCompiler_StaticMethods_whenViewed_$self$$,$timeToView$jscomp$2$$){if(0==$timeToView$jscomp$2$$)return Promise.resolve();var $unlistenSet$$=[];return(new Promise(function($resolve$jscomp$47$$,$reject$jscomp$18$$){$unlistenSet$$.push($JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$onVisibilityChanged$$($JSCompiler_StaticMethods_whenViewed_$self$$.$viewer_$,function(){$JSCompiler_StaticMethods_Viewer$$module$src$service$viewer_impl_prototype$isVisible$$($JSCompiler_StaticMethods_whenViewed_$self$$.$viewer_$)||
$reject$jscomp$18$$($cancellation$$module$src$error$$())}));var $timeoutId$jscomp$1$$=$JSCompiler_StaticMethods_whenViewed_$self$$.$timer_$.delay($resolve$jscomp$47$$,$timeToView$jscomp$2$$);$unlistenSet$$.push(function(){return $JSCompiler_StaticMethods_whenViewed_$self$$.$timer_$.cancel($timeoutId$jscomp$1$$)});$unlistenSet$$.push($JSCompiler_StaticMethods_whenViewed_$self$$.$viewport_$.onScroll($resolve$jscomp$47$$));$unlistenSet$$.push($listenOnce$$module$src$event_helper$$($JSCompiler_StaticMethods_whenViewed_$self$$.ampdoc.getRootNode(),
"click",$resolve$jscomp$47$$))})).then(function(){$unlistenSet$$.forEach(function($JSCompiler_StaticMethods_whenViewed_$self$$){return $JSCompiler_StaticMethods_whenViewed_$self$$()})},function($JSCompiler_StaticMethods_whenViewed_$self$$){$unlistenSet$$.forEach(function($JSCompiler_StaticMethods_whenViewed_$self$$){return $JSCompiler_StaticMethods_whenViewed_$self$$()});throw $JSCompiler_StaticMethods_whenViewed_$self$$;})}
function $JSCompiler_StaticMethods_toggleTopClass_$$($JSCompiler_StaticMethods_toggleTopClass_$self$$,$className$jscomp$4$$,$on$jscomp$6$$){$JSCompiler_StaticMethods_toggleTopClass_$self$$.$vsync_$.mutate(function(){$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$getRootElement_$$($JSCompiler_StaticMethods_toggleTopClass_$self$$).classList.toggle($className$jscomp$4$$,$on$jscomp$6$$)})}
$JSCompiler_prototypeAlias$$.$handleAction_$=function($invocation$jscomp$14$$){"login"==$invocation$jscomp$14$$.method?($invocation$jscomp$14$$.event&&$invocation$jscomp$14$$.event.preventDefault(),$JSCompiler_StaticMethods_loginWithType_$$(this,"")):$startsWith$$module$src$string$$($invocation$jscomp$14$$.method,"login-")&&($invocation$jscomp$14$$.event&&$invocation$jscomp$14$$.event.preventDefault(),$JSCompiler_StaticMethods_loginWithType_$$(this,$invocation$jscomp$14$$.method.substring(6)));return null};
$JSCompiler_prototypeAlias$$.getSource=function($index$jscomp$71$$){$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(0<=$index$jscomp$71$$&&$index$jscomp$71$$<this.B.length,"Invalid index: %d",$index$jscomp$71$$);return this.B[$index$jscomp$71$$]};
function $JSCompiler_StaticMethods_loginWithType_$$($JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$,$type$jscomp$134$$){var $splitPoint$$=$type$jscomp$134$$.indexOf("-"),$singleSource$$=1==$JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$.B.length,$namespace$jscomp$5$$=-1<$splitPoint$$?$type$jscomp$134$$.substring(0,$splitPoint$$):$type$jscomp$134$$,$match$jscomp$17$$=$JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$.B.filter(function($JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$){return $JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$.getNamespace()==
$namespace$jscomp$5$$});$match$jscomp$17$$.length?($JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$=-1<$splitPoint$$?$type$jscomp$134$$.substring($splitPoint$$+1):"",$match$jscomp$17$$[0].loginWithType($JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$)):($user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($singleSource$$,"Login must match namespace: %s",$namespace$jscomp$5$$),$JSCompiler_StaticMethods_loginWithType_$self_remaining$jscomp$2$$.B[0].loginWithType($type$jscomp$134$$))}
$JSCompiler_prototypeAlias$$.combinedResponses=function(){if(1==this.B.length&&!this.B[0].getNamespace())return this.B[0].getAuthResponse()||{};var $combined$$={};this.B.forEach(function($source$jscomp$32$$){return $combined$$[$source$jscomp$32$$.getNamespace()]=$source$jscomp$32$$.getAuthResponse()});return $combined$$};
(function($AMP$jscomp$5$$){$AMP$jscomp$5$$.registerServiceForDoc("access",function($AMP$jscomp$5$$){$AMP$jscomp$5$$=new $AccessService$$module$extensions$amp_access$0_1$amp_access$$($AMP$jscomp$5$$);if($AMP$jscomp$5$$.D){$Services$$module$src$services$actionServiceForDoc$$($AMP$jscomp$5$$.ampdoc).installActionHandler($AMP$jscomp$5$$.H,$AMP$jscomp$5$$.$handleAction_$.bind($AMP$jscomp$5$$));for(var $JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$start_$self$jscomp$inline_1270_ampdoc$jscomp$107$$=
0;$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$start_$self$jscomp$inline_1270_ampdoc$jscomp$107$$<$AMP$jscomp$5$$.B.length;$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$start_$self$jscomp$inline_1270_ampdoc$jscomp$107$$++)$AMP$jscomp$5$$.B[$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$start_$self$jscomp$inline_1270_ampdoc$jscomp$107$$].start();$JSCompiler_StaticMethods_runAuthorization_$$($AMP$jscomp$5$$);
$AMP$jscomp$5$$.$AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$scheduleView_$(2E3);$JSCompiler_StaticMethods_AccessService$$module$extensions$amp_access$0_1$amp_access_prototype$listenToBroadcasts_$$($AMP$jscomp$5$$)}else $user$$module$src$log$$().$Log$$module$src$log_prototype$info$("amp-access",'Access is disabled - no "id=amp-access" element');return $AMP$jscomp$5$$})})(self.AMP);})});
//# sourceMappingURL=extensions-amp-access-0.1-amp-access.js.map

