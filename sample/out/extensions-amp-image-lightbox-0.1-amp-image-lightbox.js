(self.AMP=self.AMP||[]).push({n:"extensions-amp-image-lightbox-0.1-amp-image-lightbox.js", v:"erwin", f:(function(){function $TapRecognizer$$module$src$gesture_recognizers$$($manager$jscomp$1$$){$GestureRecognizer$$module$src$gesture$$.call(this,"tap",$manager$jscomp$1$$);this.C=this.B=this.$startY_$=this.$startX_$=0}$$jscomp$inherits$$($TapRecognizer$$module$src$gesture_recognizers$$,$GestureRecognizer$$module$src$gesture$$);
$TapRecognizer$$module$src$gesture_recognizers$$.prototype.onTouchStart=function($e$jscomp$31_touches$jscomp$2$$){return($e$jscomp$31_touches$jscomp$2$$=$e$jscomp$31_touches$jscomp$2$$.touches)&&1==$e$jscomp$31_touches$jscomp$2$$.length?(this.$startX_$=$e$jscomp$31_touches$jscomp$2$$[0].clientX,this.$startY_$=$e$jscomp$31_touches$jscomp$2$$[0].clientY,!0):!1};
$TapRecognizer$$module$src$gesture_recognizers$$.prototype.onTouchMove=function($dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$){return($dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$=$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$.changedTouches||$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$.touches)&&1==$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$.length&&(this.B=$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$[0].clientX,this.C=$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$[0].clientY,$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$=
8<=Math.abs(this.C-this.$startY_$),8<=Math.abs(this.B-this.$startX_$)||$dy$jscomp$4_e$jscomp$32_touches$jscomp$3$$)?!1:!0};$TapRecognizer$$module$src$gesture_recognizers$$.prototype.onTouchEnd=function(){this.signalReady(0)};$TapRecognizer$$module$src$gesture_recognizers$$.prototype.acceptStart=function(){this.signalEmit({clientX:this.B,clientY:this.C},null);this.signalEnd()};var $SUPPORTED_ELEMENTS_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$={"amp-img":!0,"amp-anim":!0},$ARIA_ATTRIBUTES$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$=["aria-label","aria-describedby","aria-labelledby"],$ENTER_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$=$bezierCurve$$module$src$curve$$(.4,0,.2,1),$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$=$bezierCurve$$module$src$curve$$(.4,0,.2,1),$PAN_ZOOM_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$=
$bezierCurve$$module$src$curve$$(.4,0,.2,1.4);
function $ImageViewer$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$($lightbox$$,$win$jscomp$302$$,$loadPromise$$){this.C=$lightbox$$;this.win=$win$jscomp$302$$;this.$loadPromise_$=$loadPromise$$;this.$viewer_$=$lightbox$$.element.ownerDocument.createElement("div");this.$viewer_$.classList.add("i-amphtml-image-lightbox-viewer");this.$image_$=$lightbox$$.element.ownerDocument.createElement("img");this.$image_$.classList.add("i-amphtml-image-lightbox-viewer-image");this.$viewer_$.appendChild(this.$image_$);
this.$srcset_$=null;this.$sourceHeight_$=this.$sourceWidth_$=0;this.B=$layoutRectLtwh$$module$src$layout_rect$$(0,0,0,0);this.$imageBox_$=$layoutRectLtwh$$module$src$layout_rect$$(0,0,0,0);this.$minScale_$=this.$maxSeenScale_$=this.$startScale_$=this.$scale_$=1;this.$maxScale_$=2;this.$maxY_$=this.$maxX_$=this.$minY_$=this.$minX_$=this.$posY_$=this.$posX_$=this.$startY_$=this.$startX_$=0;this.$motion_$=null;this.$setupGestures_$()}$JSCompiler_prototypeAlias$$=$ImageViewer$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$.prototype;
$JSCompiler_prototypeAlias$$.getElement=function(){return this.$viewer_$};$JSCompiler_prototypeAlias$$.getImage=function(){return this.$image_$};$JSCompiler_prototypeAlias$$.getViewerBox=function(){return this.B};$JSCompiler_prototypeAlias$$.getImageBox=function(){return this.$imageBox_$};$JSCompiler_prototypeAlias$$.getImageBoxWithOffset=function(){return this.$posX_$||this.$posY_$?$moveLayoutRect$$module$src$layout_rect$$(this.$imageBox_$,this.$posX_$,this.$posY_$):this.$imageBox_$};
$JSCompiler_prototypeAlias$$.reset=function(){var $$jscomp$this$jscomp$531$$=this;this.$image_$.setAttribute("src","");$ARIA_ATTRIBUTES$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$.forEach(function($key$jscomp$104$$){$$jscomp$this$jscomp$531$$.$image_$.removeAttribute($key$jscomp$104$$)});this.$image_$.removeAttribute("aria-describedby");this.$srcset_$=null;this.$imageBox_$=$layoutRectLtwh$$module$src$layout_rect$$(0,0,0,0);this.$sourceHeight_$=this.$sourceWidth_$=0;this.$startScale_$=
this.$scale_$=this.$maxSeenScale_$=1;this.$maxScale_$=2;this.$maxY_$=this.$maxX_$=this.$minY_$=this.$minX_$=this.$posY_$=this.$posX_$=this.$startY_$=this.$startX_$=0;this.$motion_$&&this.$motion_$.halt();this.$motion_$=null};
$JSCompiler_prototypeAlias$$.$setSourceDimensions_$=function($ampImg$$,$img$jscomp$3$$){$img$jscomp$3$$?(this.$sourceWidth_$=$img$jscomp$3$$.naturalWidth||$ampImg$$.offsetWidth,this.$sourceHeight_$=$img$jscomp$3$$.naturalHeight||$ampImg$$.offsetHeight):(this.$sourceWidth_$=$ampImg$$.offsetWidth,this.$sourceHeight_$=$ampImg$$.offsetHeight)};
$JSCompiler_prototypeAlias$$.init=function($sourceElement$$,$sourceImage$$){var $$jscomp$this$jscomp$532$$=this;this.$setSourceDimensions_$($sourceElement$$,$sourceImage$$);this.$srcset_$=$srcsetFromElement$$module$src$srcset$$($sourceElement$$);$sourceElement$$.getImpl().then(function($sourceElement$$){$sourceElement$$.propagateAttributes($ARIA_ATTRIBUTES$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$,$$jscomp$this$jscomp$532$$.$image_$)});$sourceImage$$&&$isLoaded$$module$src$event_helper$$($sourceImage$$)&&
$sourceImage$$.src&&this.$image_$.setAttribute("src",$sourceImage$$.src)};
$JSCompiler_prototypeAlias$$.measure=function(){this.B=$layoutRectFromDomRect$$module$src$layout_rect$$(this.$viewer_$.getBoundingClientRect());var $sourceAspectRatio$$=this.$sourceWidth_$/this.$sourceHeight_$,$height$jscomp$46$$=Math.min(this.B.width/$sourceAspectRatio$$,this.B.height),$width$jscomp$49$$=Math.min(this.B.height*$sourceAspectRatio$$,this.B.width);16>=Math.abs($width$jscomp$49$$-this.$sourceWidth_$)&&16>=Math.abs($height$jscomp$46$$-this.$sourceHeight_$)&&($width$jscomp$49$$=this.$sourceWidth_$,
$height$jscomp$46$$=this.$sourceHeight_$);this.$imageBox_$=$layoutRectLtwh$$module$src$layout_rect$$(Math.round((this.B.width-$width$jscomp$49$$)/2),Math.round((this.B.height-$height$jscomp$46$$)/2),Math.round($width$jscomp$49$$),Math.round($height$jscomp$46$$));$setStyles$$module$src$style$$(this.$image_$,{top:$px$$module$src$style$$(this.$imageBox_$.top),left:$px$$module$src$style$$(this.$imageBox_$.left),width:$px$$module$src$style$$(this.$imageBox_$.width),height:$px$$module$src$style$$(this.$imageBox_$.height)});
var $viewerBoxRatio$$=this.B.width/this.B.height,$maxScale$$=Math.max($viewerBoxRatio$$/$sourceAspectRatio$$,$sourceAspectRatio$$/$viewerBoxRatio$$);this.$maxScale_$=Math.max(2,$maxScale$$);this.$startScale_$=this.$scale_$=1;this.$startY_$=this.$posY_$=this.$startX_$=this.$posX_$=0;this.$updatePanZoomBounds_$(this.$scale_$);this.$updatePanZoom_$();return this.$updateSrc_$()};
$JSCompiler_prototypeAlias$$.$updateSrc_$=function(){var $$jscomp$this$jscomp$533$$=this;if(!this.$srcset_$)return Promise.resolve();this.$maxSeenScale_$=Math.max(this.$maxSeenScale_$,this.$scale_$);var $src$jscomp$43$$=this.$srcset_$.select(this.$imageBox_$.width*this.$maxSeenScale_$,this.C.getDpr());return $src$jscomp$43$$==this.$image_$.getAttribute("src")?Promise.resolve():$Services$$module$src$services$timerFor$$(this.win).promise(1).then(function(){$$jscomp$this$jscomp$533$$.$image_$.setAttribute("src",
$src$jscomp$43$$);return $$jscomp$this$jscomp$533$$.$loadPromise_$($$jscomp$this$jscomp$533$$.$image_$)})};
$JSCompiler_prototypeAlias$$.$setupGestures_$=function(){var $$jscomp$this$jscomp$534$$=this,$gestures$$=$Gestures$$module$src$gesture$get$$(this.$image_$);$gestures$$.onGesture($TapRecognizer$$module$src$gesture_recognizers$$,function(){$$jscomp$this$jscomp$534$$.C.toggleViewMode()});$gestures$$.onGesture($SwipeXYRecognizer$$module$src$gesture_recognizers$$,function($gestures$$){$$jscomp$this$jscomp$534$$.$onMove_$($gestures$$.data.deltaX,$gestures$$.data.deltaY,!1);$gestures$$.data.last&&$$jscomp$this$jscomp$534$$.$onMoveRelease_$($gestures$$.data.velocityX,
$gestures$$.data.velocityY)});$gestures$$.onPointerDown(function(){$$jscomp$this$jscomp$534$$.$motion_$&&$$jscomp$this$jscomp$534$$.$motion_$.halt()});$gestures$$.onGesture($DoubletapRecognizer$$module$src$gesture_recognizers$$,function($gestures$$){var $e$jscomp$241$$;$e$jscomp$241$$=1==$$jscomp$this$jscomp$534$$.$scale_$?$$jscomp$this$jscomp$534$$.$maxScale_$:$$jscomp$this$jscomp$534$$.$minScale_$;$$jscomp$this$jscomp$534$$.$onZoom_$($e$jscomp$241$$,$$jscomp$this$jscomp$534$$.B.width/2-$gestures$$.data.clientX,
$$jscomp$this$jscomp$534$$.B.height/2-$gestures$$.data.clientY,!0).then(function(){return $$jscomp$this$jscomp$534$$.$onZoomRelease_$(0,0,0,0,0,0)})});$gestures$$.onGesture($TapzoomRecognizer$$module$src$gesture_recognizers$$,function($gestures$$){$JSCompiler_StaticMethods_onZoomInc_$$($$jscomp$this$jscomp$534$$,$gestures$$.data.centerClientX,$gestures$$.data.centerClientY,$gestures$$.data.deltaX,$gestures$$.data.deltaY);$gestures$$.data.last&&$$jscomp$this$jscomp$534$$.$onZoomRelease_$($gestures$$.data.centerClientX,
$gestures$$.data.centerClientY,$gestures$$.data.deltaX,$gestures$$.data.deltaY,$gestures$$.data.velocityY,$gestures$$.data.velocityY)})};$JSCompiler_prototypeAlias$$.$boundValue_$=function($v$jscomp$23$$,$min$jscomp$4$$,$max$jscomp$4$$,$extent$$){return Math.max($min$jscomp$4$$-$extent$$,Math.min($max$jscomp$4$$+$extent$$,$v$jscomp$23$$))};
$JSCompiler_prototypeAlias$$.$boundScale_$=function($s$jscomp$39$$,$allowExtent$$){return this.$boundValue_$($s$jscomp$39$$,this.$minScale_$,this.$maxScale_$,$allowExtent$$?.25:0)};$JSCompiler_prototypeAlias$$.$boundX_$=function($x$jscomp$103$$,$allowExtent$jscomp$1$$){return this.$boundValue_$($x$jscomp$103$$,this.$minX_$,this.$maxX_$,$allowExtent$jscomp$1$$&&1<this.$scale_$?.25*this.B.width:0)};
$JSCompiler_prototypeAlias$$.$boundY_$=function($y$jscomp$74$$,$allowExtent$jscomp$2$$){return this.$boundValue_$($y$jscomp$74$$,this.$minY_$,this.$maxY_$,$allowExtent$jscomp$2$$?.25*this.B.height:0)};
$JSCompiler_prototypeAlias$$.$updatePanZoomBounds_$=function($dw$jscomp$1_scale$jscomp$10$$){var $dh$jscomp$1_maxY$jscomp$1$$,$minY$$=0;$dh$jscomp$1_maxY$jscomp$1$$=this.B.height-this.$imageBox_$.height*$dw$jscomp$1_scale$jscomp$10$$;0<=$dh$jscomp$1_maxY$jscomp$1$$?$minY$$=$dh$jscomp$1_maxY$jscomp$1$$=0:($minY$$=$dh$jscomp$1_maxY$jscomp$1$$/2,$dh$jscomp$1_maxY$jscomp$1$$=-$minY$$);var $maxX$$=0,$minX$$=0;$dw$jscomp$1_scale$jscomp$10$$=this.B.width-this.$imageBox_$.width*$dw$jscomp$1_scale$jscomp$10$$;
0<=$dw$jscomp$1_scale$jscomp$10$$?$minX$$=$maxX$$=0:($minX$$=$dw$jscomp$1_scale$jscomp$10$$/2,$maxX$$=-$minX$$);this.$minX_$=$minX$$;this.$minY_$=$minY$$;this.$maxX_$=$maxX$$;this.$maxY_$=$dh$jscomp$1_maxY$jscomp$1$$};$JSCompiler_prototypeAlias$$.$updatePanZoom_$=function(){$setStyles$$module$src$style$$(this.$image_$,{transform:$translate$$module$src$style$$(this.$posX_$,this.$posY_$)+" "+$scale$$module$src$style$$(this.$scale_$)});1!=this.$scale_$&&this.C.toggleViewMode(!0)};
$JSCompiler_prototypeAlias$$.$onMove_$=function($deltaX$jscomp$2$$,$deltaY$jscomp$2$$,$animate$jscomp$4$$){var $newPosX$$=this.$boundX_$(this.$startX_$+$deltaX$jscomp$2$$,!0),$newPosY$$=this.$boundY_$(this.$startY_$+$deltaY$jscomp$2$$,!0);this.$set_$(this.$scale_$,$newPosX$$,$newPosY$$,$animate$jscomp$4$$)};
$JSCompiler_prototypeAlias$$.$onMoveRelease_$=function($veloX$jscomp$2$$,$veloY$jscomp$2$$){var $$jscomp$this$jscomp$535$$=this,$deltaY$jscomp$3$$=this.$posY_$-this.$startY_$;1==this.$scale_$&&10<Math.abs($deltaY$jscomp$3$$)?this.C.close():(this.$motion_$=$continueMotion$$module$src$motion$$(this.$image_$,this.$posX_$,this.$posY_$,$veloX$jscomp$2$$,$veloY$jscomp$2$$,function($veloX$jscomp$2$$,$veloY$jscomp$2$$){$veloX$jscomp$2$$=$$jscomp$this$jscomp$535$$.$boundX_$($veloX$jscomp$2$$,!0);$veloY$jscomp$2$$=
$$jscomp$this$jscomp$535$$.$boundY_$($veloY$jscomp$2$$,!0);if(1>Math.abs($veloX$jscomp$2$$-$$jscomp$this$jscomp$535$$.$posX_$)&&1>Math.abs($veloY$jscomp$2$$-$$jscomp$this$jscomp$535$$.$posY_$))return!1;$$jscomp$this$jscomp$535$$.$set_$($$jscomp$this$jscomp$535$$.$scale_$,$veloX$jscomp$2$$,$veloY$jscomp$2$$,!1);return!0}),$JSCompiler_StaticMethods_Motion$$module$src$motion_prototype$thenAlways$$(this.$motion_$,function(){$$jscomp$this$jscomp$535$$.$motion_$=null;return $$jscomp$this$jscomp$535$$.$release_$()}))};
function $JSCompiler_StaticMethods_onZoomInc_$$($JSCompiler_StaticMethods_onZoomInc_$self$$,$centerClientX$$,$centerClientY$$,$deltaX$jscomp$3$$,$deltaY$jscomp$4$$){var $dist$$=Math.sqrt($deltaX$jscomp$3$$*$deltaX$jscomp$3$$+$deltaY$jscomp$4$$*$deltaY$jscomp$4$$),$zoomSign$$=Math.abs($deltaY$jscomp$4$$)>Math.abs($deltaX$jscomp$3$$)?Math.sign($deltaY$jscomp$4$$):Math.sign(-$deltaX$jscomp$3$$);if($zoomSign$$){var $newScale$jscomp$1$$=$JSCompiler_StaticMethods_onZoomInc_$self$$.$startScale_$*(1+$zoomSign$$*
$dist$$/100),$deltaCenterX$$=$JSCompiler_StaticMethods_onZoomInc_$self$$.B.width/2-$centerClientX$$,$deltaCenterY$$=$JSCompiler_StaticMethods_onZoomInc_$self$$.B.height/2-$centerClientY$$;$deltaX$jscomp$3$$=Math.min($deltaCenterX$$,$dist$$/100*$deltaCenterX$$);$deltaY$jscomp$4$$=Math.min($deltaCenterY$$,$dist$$/100*$deltaCenterY$$);$JSCompiler_StaticMethods_onZoomInc_$self$$.$onZoom_$($newScale$jscomp$1$$,$deltaX$jscomp$3$$,$deltaY$jscomp$4$$,!1)}}
$JSCompiler_prototypeAlias$$.$onZoom_$=function($newScale$jscomp$2_scale$jscomp$11$$,$deltaX$jscomp$4_newPosX$jscomp$2$$,$deltaY$jscomp$5_newPosY$jscomp$2$$,$animate$jscomp$5$$){$newScale$jscomp$2_scale$jscomp$11$$=this.$boundScale_$($newScale$jscomp$2_scale$jscomp$11$$,!0);if($newScale$jscomp$2_scale$jscomp$11$$!=this.$scale_$)return this.$updatePanZoomBounds_$($newScale$jscomp$2_scale$jscomp$11$$),$deltaX$jscomp$4_newPosX$jscomp$2$$=this.$boundX_$(this.$startX_$+$deltaX$jscomp$4_newPosX$jscomp$2$$*
$newScale$jscomp$2_scale$jscomp$11$$,!1),$deltaY$jscomp$5_newPosY$jscomp$2$$=this.$boundY_$(this.$startY_$+$deltaY$jscomp$5_newPosY$jscomp$2$$*$newScale$jscomp$2_scale$jscomp$11$$,!1),this.$set_$($newScale$jscomp$2_scale$jscomp$11$$,$deltaX$jscomp$4_newPosX$jscomp$2$$,$deltaY$jscomp$5_newPosY$jscomp$2$$,$animate$jscomp$5$$)};
$JSCompiler_prototypeAlias$$.$onZoomRelease_$=function($centerClientX$jscomp$1$$,$centerClientY$jscomp$1$$,$deltaX$jscomp$5_promise$jscomp$29$$,$deltaY$jscomp$6$$,$veloX$jscomp$3$$,$veloY$jscomp$3$$){var $$jscomp$this$jscomp$536$$=this;$deltaX$jscomp$5_promise$jscomp$29$$=$veloX$jscomp$3$$||$veloY$jscomp$3$$?$JSCompiler_StaticMethods_Motion$$module$src$motion_prototype$thenAlways$$($continueMotion$$module$src$motion$$(this.$image_$,$deltaX$jscomp$5_promise$jscomp$29$$,$deltaY$jscomp$6$$,$veloX$jscomp$3$$,
$veloY$jscomp$3$$,function($deltaX$jscomp$5_promise$jscomp$29$$,$deltaY$jscomp$6$$){$JSCompiler_StaticMethods_onZoomInc_$$($$jscomp$this$jscomp$536$$,$centerClientX$jscomp$1$$,$centerClientY$jscomp$1$$,$deltaX$jscomp$5_promise$jscomp$29$$,$deltaY$jscomp$6$$);return!0})):Promise.resolve();var $relayout$$=this.$scale_$>this.$startScale_$;return $deltaX$jscomp$5_promise$jscomp$29$$.then(function(){return $$jscomp$this$jscomp$536$$.$release_$()}).then(function(){$relayout$$&&$$jscomp$this$jscomp$536$$.$updateSrc_$()})};
$JSCompiler_prototypeAlias$$.$set_$=function($newScale$jscomp$3$$,$newPosX$jscomp$3$$,$newPosY$jscomp$3$$,$animate$jscomp$6$$){var $$jscomp$this$jscomp$537$$=this,$ds$$=$newScale$jscomp$3$$-this.$scale_$,$dist$jscomp$1_dx$jscomp$9$$=$newPosX$jscomp$3$$-this.$posX_$,$dy$jscomp$10$$=$newPosY$jscomp$3$$-this.$posY_$,$dist$jscomp$1_dx$jscomp$9$$=Math.sqrt($dist$jscomp$1_dx$jscomp$9$$*$dist$jscomp$1_dx$jscomp$9$$+$dy$jscomp$10$$*$dy$jscomp$10$$),$dur$$=0;if($animate$jscomp$6$$)var $maxDur$$=250,$dur$$=
Math.min($maxDur$$,Math.max($maxDur$$*$dist$jscomp$1_dx$jscomp$9$$*.01,$maxDur$$*Math.abs($ds$$)));var $promise$jscomp$30$$;if(16<$dur$$&&$animate$jscomp$6$$){var $scaleFunc$$=$numeric$$module$src$transition$$(this.$scale_$,$newScale$jscomp$3$$),$xFunc$$=$numeric$$module$src$transition$$(this.$posX_$,$newPosX$jscomp$3$$),$yFunc$$=$numeric$$module$src$transition$$(this.$posY_$,$newPosY$jscomp$3$$);$promise$jscomp$30$$=$JSCompiler_StaticMethods_AnimationPlayer$$module$src$animation_prototype$thenAlways$$($Animation$$module$src$animation$animate$$(this.$image_$,
function($newScale$jscomp$3$$){$$jscomp$this$jscomp$537$$.$scale_$=$scaleFunc$$($newScale$jscomp$3$$);$$jscomp$this$jscomp$537$$.$posX_$=$xFunc$$($newScale$jscomp$3$$);$$jscomp$this$jscomp$537$$.$posY_$=$yFunc$$($newScale$jscomp$3$$);$$jscomp$this$jscomp$537$$.$updatePanZoom_$()},$dur$$,$PAN_ZOOM_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$),function(){$$jscomp$this$jscomp$537$$.$scale_$=$newScale$jscomp$3$$;$$jscomp$this$jscomp$537$$.$posX_$=$newPosX$jscomp$3$$;$$jscomp$this$jscomp$537$$.$posY_$=
$newPosY$jscomp$3$$;$$jscomp$this$jscomp$537$$.$updatePanZoom_$()})}else this.$scale_$=$newScale$jscomp$3$$,this.$posX_$=$newPosX$jscomp$3$$,this.$posY_$=$newPosY$jscomp$3$$,this.$updatePanZoom_$(),$animate$jscomp$6$$?$promise$jscomp$30$$=Promise.resolve():$promise$jscomp$30$$=void 0;return $promise$jscomp$30$$};
$JSCompiler_prototypeAlias$$.$release_$=function(){var $$jscomp$this$jscomp$538$$=this,$newScale$jscomp$4$$=this.$boundScale_$(this.$scale_$,!1);$newScale$jscomp$4$$!=this.$scale_$&&this.$updatePanZoomBounds_$($newScale$jscomp$4$$);var $newPosX$jscomp$4$$=this.$boundX_$(this.$posX_$/this.$scale_$*$newScale$jscomp$4$$,!1),$newPosY$jscomp$4$$=this.$boundY_$(this.$posY_$/this.$scale_$*$newScale$jscomp$4$$,!1);return this.$set_$($newScale$jscomp$4$$,$newPosX$jscomp$4$$,$newPosY$jscomp$4$$,!0).then(function(){$$jscomp$this$jscomp$538$$.$startScale_$=
$$jscomp$this$jscomp$538$$.$scale_$;$$jscomp$this$jscomp$538$$.$startX_$=$$jscomp$this$jscomp$538$$.$posX_$;$$jscomp$this$jscomp$538$$.$startY_$=$$jscomp$this$jscomp$538$$.$posY_$})};
function $AmpImageLightbox$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$($$jscomp$super$this$jscomp$49_element$jscomp$347$$){$$jscomp$super$this$jscomp$49_element$jscomp$347$$=AMP.BaseElement.call(this,$$jscomp$super$this$jscomp$49_element$jscomp$347$$)||this;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$historyId_$=-1;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$active_$=!1;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$entering_$=!1;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$sourceElement_$=
null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$sourceImage_$=null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$unlistenViewport_$=null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$container_$=null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$imageViewer_$=null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$captionElement_$=null;$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$boundCloseOnEscape_$=$$jscomp$super$this$jscomp$49_element$jscomp$347$$.$closeOnEscape_$.bind($$jscomp$super$this$jscomp$49_element$jscomp$347$$);
return $$jscomp$super$this$jscomp$49_element$jscomp$347$$}$$jscomp$inherits$$($AmpImageLightbox$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$,AMP.BaseElement);
function $JSCompiler_StaticMethods_buildLightbox_$$($JSCompiler_StaticMethods_buildLightbox_$self$$){if(!$JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$){$JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$=$JSCompiler_StaticMethods_buildLightbox_$self$$.element.ownerDocument.createElement("div");$JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$.classList.add("i-amphtml-image-lightbox-container");$JSCompiler_StaticMethods_buildLightbox_$self$$.element.appendChild($JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$);
$JSCompiler_StaticMethods_buildLightbox_$self$$.$imageViewer_$=new $ImageViewer$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$($JSCompiler_StaticMethods_buildLightbox_$self$$,$JSCompiler_StaticMethods_buildLightbox_$self$$.win,$JSCompiler_StaticMethods_buildLightbox_$self$$.loadPromise.bind($JSCompiler_StaticMethods_buildLightbox_$self$$));$JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$.appendChild($JSCompiler_StaticMethods_buildLightbox_$self$$.$imageViewer_$.getElement());
$JSCompiler_StaticMethods_buildLightbox_$self$$.$captionElement_$=$JSCompiler_StaticMethods_buildLightbox_$self$$.element.ownerDocument.createElement("div");$JSCompiler_StaticMethods_buildLightbox_$self$$.$captionElement_$.setAttribute("id",$JSCompiler_StaticMethods_buildLightbox_$self$$.element.getAttribute("id")+"-caption");$JSCompiler_StaticMethods_buildLightbox_$self$$.$captionElement_$.classList.add("amp-image-lightbox-caption");$JSCompiler_StaticMethods_buildLightbox_$self$$.$captionElement_$.classList.add("i-amphtml-image-lightbox-caption");
$JSCompiler_StaticMethods_buildLightbox_$self$$.$container_$.appendChild($JSCompiler_StaticMethods_buildLightbox_$self$$.$captionElement_$);var $screenReaderCloseButton$$=$JSCompiler_StaticMethods_buildLightbox_$self$$.element.ownerDocument.createElement("button"),$ariaLabel$$=$JSCompiler_StaticMethods_buildLightbox_$self$$.element.getAttribute("data-close-button-aria-label")||"Close the lightbox";$screenReaderCloseButton$$.textContent=$ariaLabel$$;$screenReaderCloseButton$$.classList.add("i-amphtml-screen-reader");
$screenReaderCloseButton$$.tabIndex=-1;$screenReaderCloseButton$$.addEventListener("click",function(){$JSCompiler_StaticMethods_buildLightbox_$self$$.close()});$JSCompiler_StaticMethods_buildLightbox_$self$$.element.appendChild($screenReaderCloseButton$$);var $gestures$jscomp$1$$=$Gestures$$module$src$gesture$get$$($JSCompiler_StaticMethods_buildLightbox_$self$$.element);$JSCompiler_StaticMethods_buildLightbox_$self$$.element.addEventListener("click",function($screenReaderCloseButton$$){$JSCompiler_StaticMethods_buildLightbox_$self$$.$entering_$||
$JSCompiler_StaticMethods_buildLightbox_$self$$.$imageViewer_$.getImage().contains($screenReaderCloseButton$$.target)||$JSCompiler_StaticMethods_buildLightbox_$self$$.close()});$gestures$jscomp$1$$.onGesture($TapRecognizer$$module$src$gesture_recognizers$$,function(){$JSCompiler_StaticMethods_buildLightbox_$self$$.$entering_$||$JSCompiler_StaticMethods_buildLightbox_$self$$.close()});$gestures$jscomp$1$$.onGesture($SwipeXYRecognizer$$module$src$gesture_recognizers$$,function(){})}}
$JSCompiler_prototypeAlias$$=$AmpImageLightbox$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$.prototype;
$JSCompiler_prototypeAlias$$.activate=function($invocation$jscomp$34_source$jscomp$40$$){var $$jscomp$this$jscomp$540$$=this;this.$active_$||($JSCompiler_StaticMethods_buildLightbox_$$(this),$invocation$jscomp$34_source$jscomp$40$$=$invocation$jscomp$34_source$jscomp$40$$.caller,$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($invocation$jscomp$34_source$jscomp$40$$&&$SUPPORTED_ELEMENTS_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$[$invocation$jscomp$34_source$jscomp$40$$.tagName.toLowerCase()],
"Unsupported element: %s",$invocation$jscomp$34_source$jscomp$40$$.tagName),this.$active_$=!0,this.$reset_$(),this.$init_$($invocation$jscomp$34_source$jscomp$40$$),this.win.document.documentElement.addEventListener("keydown",this.$boundCloseOnEscape_$),this.getViewport().enterLightboxMode(),this.$enter_$(),this.$unlistenViewport_$=this.getViewport().onChanged(function(){$$jscomp$this$jscomp$540$$.$active_$&&($startsWith$$module$src$string$$($Services$$module$src$services$platformFor$$($$jscomp$this$jscomp$540$$.win).getIosVersionString(),
"10.3")?$Services$$module$src$services$timerFor$$($$jscomp$this$jscomp$540$$.win).delay(function(){$$jscomp$this$jscomp$540$$.$imageViewer_$.measure()},500):$$jscomp$this$jscomp$540$$.$imageViewer_$.measure())}),this.$getHistory_$().push(this.close.bind(this)).then(function($invocation$jscomp$34_source$jscomp$40$$){$$jscomp$this$jscomp$540$$.$historyId_$=$invocation$jscomp$34_source$jscomp$40$$}))};
$JSCompiler_prototypeAlias$$.$closeOnEscape_$=function($event$jscomp$107$$){27==$event$jscomp$107$$.keyCode&&this.close()};
$JSCompiler_prototypeAlias$$.close=function(){this.$active_$&&(this.$entering_$=this.$active_$=!1,this.$exit_$(),this.$unlistenViewport_$&&(this.$unlistenViewport_$(),this.$unlistenViewport_$=null),this.getViewport().leaveLightboxMode(),-1!=this.$historyId_$&&this.$getHistory_$().pop(this.$historyId_$),this.win.document.documentElement.removeEventListener("keydown",this.$boundCloseOnEscape_$),this.$sourceElement_$&&$tryFocus$$module$src$dom$$(this.$sourceElement_$))};
$JSCompiler_prototypeAlias$$.toggleViewMode=function($opt_on$jscomp$1$$){void 0!==$opt_on$jscomp$1$$?this.$container_$.classList.toggle("i-amphtml-image-lightbox-view-mode",$opt_on$jscomp$1$$):this.$container_$.classList.toggle("i-amphtml-image-lightbox-view-mode")};
$JSCompiler_prototypeAlias$$.$init_$=function($sourceElement$jscomp$1$$){this.$sourceElement_$=$sourceElement$jscomp$1$$;this.$sourceImage_$=$elementByTag$$module$src$dom$$($sourceElement$jscomp$1$$,"img");this.$imageViewer_$.init(this.$sourceElement_$,this.$sourceImage_$);var $caption$$=null,$figure$$=$closestByTag$$module$src$dom$$($sourceElement$jscomp$1$$,"figure");$figure$$&&($caption$$=$elementByTag$$module$src$dom$$($figure$$,"figcaption"));if(!$caption$$)var $describedBy$$=$sourceElement$jscomp$1$$.getAttribute("aria-describedby"),
$caption$$=this.element.ownerDocument.getElementById($describedBy$$);$caption$$&&($copyChildren$$module$src$dom$$($caption$$,this.$captionElement_$),this.$imageViewer_$.getImage().setAttribute("aria-describedby",this.$captionElement_$.getAttribute("id")));this.$captionElement_$.classList.toggle("i-amphtml-empty",!$caption$$)};
$JSCompiler_prototypeAlias$$.$reset_$=function(){this.$imageViewer_$.reset();$removeChildren$$module$src$dom$$(this.$captionElement_$);this.$sourceImage_$=this.$sourceElement_$=null;this.toggleViewMode(!1)};
$JSCompiler_prototypeAlias$$.$enter_$=function(){var $$jscomp$this$jscomp$541$$=this;this.$entering_$=!0;$setStyles$$module$src$style$$(this.element,{opacity:0,display:""});this.$imageViewer_$.measure();var $anim$jscomp$1$$=new $Animation$$module$src$animation$$(this.element);$anim$jscomp$1$$.add(0,$setStyles$$module$src$transition$$(this.element,{opacity:$numeric$$module$src$transition$$(0,1)}),.6,$ENTER_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);var $transLayer$$=null;
if(this.$sourceImage_$&&$isLoaded$$module$src$event_helper$$(this.$sourceImage_$)&&this.$sourceImage_$.src){$transLayer$$=this.element.ownerDocument.createElement("div");$transLayer$$.classList.add("i-amphtml-image-lightbox-trans");this.element.ownerDocument.body.appendChild($transLayer$$);var $rect$jscomp$13$$=$layoutRectFromDomRect$$module$src$layout_rect$$(this.$sourceImage_$.getBoundingClientRect()),$imageBox$$=this.$imageViewer_$.getImageBox(),$clone$jscomp$2$$=this.$sourceImage_$.cloneNode(!0);
$clone$jscomp$2$$.className="";$setStyles$$module$src$style$$($clone$jscomp$2$$,{position:"absolute",top:$px$$module$src$style$$($rect$jscomp$13$$.top),left:$px$$module$src$style$$($rect$jscomp$13$$.left),width:$px$$module$src$style$$($rect$jscomp$13$$.width),height:$px$$module$src$style$$($rect$jscomp$13$$.height),transformOrigin:"top left",willChange:"transform"});$transLayer$$.appendChild($clone$jscomp$2$$);this.$sourceImage_$.classList.add("i-amphtml-ghost");var $dy$jscomp$11$$=$imageBox$$.top-
$rect$jscomp$13$$.top,$scaleX$$=$rect$jscomp$13$$.width?$imageBox$$.width/$rect$jscomp$13$$.width:1,$motionTime$$=Math.max(.2,Math.min(.8,Math.abs($dy$jscomp$11$$)/250*.8));$anim$jscomp$1$$.add(0,$setStyles$$module$src$transition$$($clone$jscomp$2$$,{transform:$concat$$module$src$transition$$([$translate$$module$src$transition$$($numeric$$module$src$transition$$(0,$imageBox$$.left-$rect$jscomp$13$$.left),$numeric$$module$src$transition$$(0,$dy$jscomp$11$$)),$scale$$module$src$transition$$($numeric$$module$src$transition$$(1,
$scaleX$$))])}),$motionTime$$,$ENTER_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);$setStyles$$module$src$style$$(this.$container_$,{opacity:0});$anim$jscomp$1$$.add(.8,$setStyles$$module$src$transition$$(this.$container_$,{opacity:$numeric$$module$src$transition$$(0,1)}),.1,$ENTER_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);$anim$jscomp$1$$.add(.9,$setStyles$$module$src$transition$$($transLayer$$,{opacity:$numeric$$module$src$transition$$(1,.01)}),
.1,$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$)}return $JSCompiler_StaticMethods_AnimationPlayer$$module$src$animation_prototype$thenAlways$$($anim$jscomp$1$$.start(500),function(){$$jscomp$this$jscomp$541$$.$entering_$=!1;$setStyles$$module$src$style$$($$jscomp$this$jscomp$541$$.element,{opacity:""});$setStyles$$module$src$style$$($$jscomp$this$jscomp$541$$.$container_$,{opacity:""});$transLayer$$&&$$jscomp$this$jscomp$541$$.element.ownerDocument.body.removeChild($transLayer$$)})};
$JSCompiler_prototypeAlias$$.$exit_$=function(){var $$jscomp$this$jscomp$542$$=this,$dy$jscomp$12_image$jscomp$7$$=this.$imageViewer_$.getImage(),$imageBox$jscomp$1_motionTime$jscomp$1$$=this.$imageViewer_$.getImageBoxWithOffset(),$anim$jscomp$2$$=new $Animation$$module$src$animation$$(this.element),$dur$jscomp$2$$=500;$anim$jscomp$2$$.add(0,$setStyles$$module$src$transition$$(this.element,{opacity:$numeric$$module$src$transition$$(1,0)}),.9,$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);
var $transLayer$jscomp$1$$=null;if($isLoaded$$module$src$event_helper$$($dy$jscomp$12_image$jscomp$7$$)&&$dy$jscomp$12_image$jscomp$7$$.src&&this.$sourceImage_$){$transLayer$jscomp$1$$=this.element.ownerDocument.createElement("div");$transLayer$jscomp$1$$.classList.add("i-amphtml-image-lightbox-trans");this.element.ownerDocument.body.appendChild($transLayer$jscomp$1$$);var $rect$jscomp$14$$=$layoutRectFromDomRect$$module$src$layout_rect$$(this.$sourceImage_$.getBoundingClientRect()),$clone$jscomp$3$$=
$dy$jscomp$12_image$jscomp$7$$.cloneNode(!0);$setStyles$$module$src$style$$($clone$jscomp$3$$,{position:"absolute",top:$px$$module$src$style$$($imageBox$jscomp$1_motionTime$jscomp$1$$.top),left:$px$$module$src$style$$($imageBox$jscomp$1_motionTime$jscomp$1$$.left),width:$px$$module$src$style$$($imageBox$jscomp$1_motionTime$jscomp$1$$.width),height:$px$$module$src$style$$($imageBox$jscomp$1_motionTime$jscomp$1$$.height),transform:"",transformOrigin:"top left",willChange:"transform"});$transLayer$jscomp$1$$.appendChild($clone$jscomp$3$$);
$anim$jscomp$2$$.add(0,$setStyles$$module$src$transition$$(this.$container_$,{opacity:$numeric$$module$src$transition$$(1,0)}),.1,$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);var $dy$jscomp$12_image$jscomp$7$$=$rect$jscomp$14$$.top-$imageBox$jscomp$1_motionTime$jscomp$1$$.top,$scaleX$jscomp$1$$=0!=$imageBox$jscomp$1_motionTime$jscomp$1$$.width?$rect$jscomp$14$$.width/$imageBox$jscomp$1_motionTime$jscomp$1$$.width:1,$moveAndScale$$=$setStyles$$module$src$transition$$($clone$jscomp$3$$,
{transform:$concat$$module$src$transition$$([$translate$$module$src$transition$$($numeric$$module$src$transition$$(0,$rect$jscomp$14$$.left-$imageBox$jscomp$1_motionTime$jscomp$1$$.left),$numeric$$module$src$transition$$(0,$dy$jscomp$12_image$jscomp$7$$)),$scale$$module$src$transition$$($numeric$$module$src$transition$$(1,$scaleX$jscomp$1$$))])}),$imageBox$jscomp$1_motionTime$jscomp$1$$=Math.max(.2,Math.min(.8,Math.abs($dy$jscomp$12_image$jscomp$7$$)/250*.8));$anim$jscomp$2$$.add(Math.min(.8-$imageBox$jscomp$1_motionTime$jscomp$1$$,
.2),function($dy$jscomp$12_image$jscomp$7$$,$imageBox$jscomp$1_motionTime$jscomp$1$$){$moveAndScale$$($dy$jscomp$12_image$jscomp$7$$);$imageBox$jscomp$1_motionTime$jscomp$1$$&&$$jscomp$this$jscomp$542$$.$sourceImage_$.classList.remove("i-amphtml-ghost")},$imageBox$jscomp$1_motionTime$jscomp$1$$,$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);$anim$jscomp$2$$.add(.8,$setStyles$$module$src$transition$$($transLayer$jscomp$1$$,{opacity:$numeric$$module$src$transition$$(1,
.01)}),.2,$EXIT_CURVE_$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$);$dur$jscomp$2$$=Math.max(Math.min(Math.abs($dy$jscomp$12_image$jscomp$7$$)/250*$dur$jscomp$2$$,$dur$jscomp$2$$),300)}return $JSCompiler_StaticMethods_AnimationPlayer$$module$src$animation_prototype$thenAlways$$($anim$jscomp$2$$.start($dur$jscomp$2$$),function(){$$jscomp$this$jscomp$542$$.$sourceImage_$&&$$jscomp$this$jscomp$542$$.$sourceImage_$.classList.remove("i-amphtml-ghost");$$jscomp$this$jscomp$542$$.collapse();
$setStyles$$module$src$style$$($$jscomp$this$jscomp$542$$.element,{opacity:""});$setStyles$$module$src$style$$($$jscomp$this$jscomp$542$$.$container_$,{opacity:""});$transLayer$jscomp$1$$&&$$jscomp$this$jscomp$542$$.element.ownerDocument.body.removeChild($transLayer$jscomp$1$$);$$jscomp$this$jscomp$542$$.$reset_$()})};$JSCompiler_prototypeAlias$$.$getHistory_$=function(){return $Services$$module$src$services$historyForDoc$$(this.getAmpDoc())};
(function($AMP$jscomp$54$$){$AMP$jscomp$54$$.registerElement("amp-image-lightbox",$AmpImageLightbox$$module$extensions$amp_image_lightbox$0_1$amp_image_lightbox$$,"amp-image-lightbox{position:fixed!important;top:0!important;left:0!important;bottom:0!important;right:0!important;margin:0!important;padding:0!important;overflow:hidden!important;-webkit-transform:translateZ(0)!important;transform:translateZ(0)!important;-ms-touch-action:none!important;touch-action:none!important;z-index:1000;background:rgba(0,0,0,0.95);color:#f2f2f2}.i-amphtml-image-lightbox-container{position:absolute;z-index:0;top:0;left:0;right:0;bottom:0;overflow:hidden;-webkit-transform:translateZ(0);transform:translateZ(0)}.i-amphtml-image-lightbox-trans{pointer-events:none!important;position:fixed;z-index:1001;top:0;left:0;bottom:0;right:0}.i-amphtml-image-lightbox-caption{position:absolute!important;z-index:2;bottom:0!important;left:0!important;right:0!important}.i-amphtml-image-lightbox-caption.i-amphtml-empty,.i-amphtml-image-lightbox-view-mode .i-amphtml-image-lightbox-caption{visibility:hidden}.amp-image-lightbox-caption{background:rgba(0,0,0,0.5);max-height:25%;padding:8px}.i-amphtml-image-lightbox-viewer{position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;overflow:hidden;-webkit-transform:translateZ(0);transform:translateZ(0)}.i-amphtml-image-lightbox-viewer-image{position:absolute;z-index:1;display:block;-webkit-transform-origin:50% 50%;transform-origin:50% 50%}\n/*# sourceURL=/extensions/amp-image-lightbox/0.1/amp-image-lightbox.css*/")})(self.AMP);})});
//# sourceMappingURL=extensions-amp-image-lightbox-0.1-amp-image-lightbox.js.map

