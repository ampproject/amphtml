(self.AMP=self.AMP||[]).push({n:"extensions-amp-selector-0.1-amp-selector.js", v:"erwin", f:(function(){var $KEYBOARD_SELECT_MODES$$module$extensions$amp_selector$0_1$amp_selector$$={NONE:"none",FOCUS:"focus",SELECT:"select"};
function $AmpSelector$$module$extensions$amp_selector$0_1$amp_selector$$($$jscomp$super$this$jscomp$70_element$jscomp$400$$){$$jscomp$super$this$jscomp$70_element$jscomp$400$$=AMP.BaseElement.call(this,$$jscomp$super$this$jscomp$70_element$jscomp$400$$)||this;$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$isMultiple_$=!1;$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$selectedOptions_$=[];$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$options_$=[];$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$inputs_$=
[];$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$isDisabled_$=!1;$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$action_$=null;$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$focusedIndex_$=0;$$jscomp$super$this$jscomp$70_element$jscomp$400$$.$kbSelectMode_$="none";return $$jscomp$super$this$jscomp$70_element$jscomp$400$$}$$jscomp$inherits$$($AmpSelector$$module$extensions$amp_selector$0_1$amp_selector$$,AMP.BaseElement);$JSCompiler_prototypeAlias$$=$AmpSelector$$module$extensions$amp_selector$0_1$amp_selector$$.prototype;
$JSCompiler_prototypeAlias$$.isLayoutSupported=function(){return!0};
$JSCompiler_prototypeAlias$$.buildCallback=function(){var $$jscomp$this$jscomp$637$$=this;this.$action_$=$Services$$module$src$services$actionServiceForDoc$$(this.element);this.$isMultiple_$=this.element.hasAttribute("multiple");this.$isDisabled_$=this.element.hasAttribute("disabled");this.element.setAttribute("role","listbox");this.$isMultiple_$&&this.element.setAttribute("aria-multiselectable","true");this.$isDisabled_$&&this.element.setAttribute("aria-disabled","true");var $kbSelectMode$$=this.element.getAttribute("keyboard-select-mode");
$kbSelectMode$$?($kbSelectMode$$=$kbSelectMode$$.toLowerCase(),$user$$module$src$log$$().assertEnumValue($KEYBOARD_SELECT_MODES$$module$extensions$amp_selector$0_1$amp_selector$$,$kbSelectMode$$),$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(!(this.$isMultiple_$&&"select"==$kbSelectMode$$),"[keyboard-select-mode=select] not supported for multiple selection amp-selector")):$kbSelectMode$$="none";this.$kbSelectMode_$=$kbSelectMode$$;this.registerAction("clear",this.$clearAllSelections_$.bind(this));
this.$init_$();this.$isDisabled_$||(this.element.addEventListener("click",this.$clickHandler_$.bind(this)),this.element.addEventListener("keydown",this.$keyDownHandler_$.bind(this)));this.registerAction("selectUp",function($kbSelectMode$$){$kbSelectMode$$=$kbSelectMode$$.args;$JSCompiler_StaticMethods_select_$$($$jscomp$this$jscomp$637$$,$kbSelectMode$$&&void 0!==$kbSelectMode$$.delta?-$kbSelectMode$$.delta:-1)},1);this.registerAction("selectDown",function($kbSelectMode$$){$kbSelectMode$$=$kbSelectMode$$.args;
$JSCompiler_StaticMethods_select_$$($$jscomp$this$jscomp$637$$,$kbSelectMode$$&&void 0!==$kbSelectMode$$.delta?$kbSelectMode$$.delta:1)},1);this.registerAction("toggle",function($kbSelectMode$$){$kbSelectMode$$=$kbSelectMode$$.args;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$(0<=$kbSelectMode$$.index,"'index' must be greater than 0");$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($kbSelectMode$$.index<$$jscomp$this$jscomp$637$$.$options_$.length,"'index' must be less than the length of options in the <amp-selector>");
$kbSelectMode$$&&void 0!==$kbSelectMode$$.index&&$$jscomp$this$jscomp$637$$.$toggle_$($kbSelectMode$$.index,$kbSelectMode$$.value)},1)};$JSCompiler_prototypeAlias$$.mutatedAttributesCallback=function($mutations$jscomp$8_selected$jscomp$2$$){$mutations$jscomp$8_selected$jscomp$2$$=$mutations$jscomp$8_selected$jscomp$2$$.selected;void 0!==$mutations$jscomp$8_selected$jscomp$2$$&&$JSCompiler_StaticMethods_selectedAttributeMutated_$$(this,$mutations$jscomp$8_selected$jscomp$2$$)};
function $JSCompiler_StaticMethods_selectedAttributeMutated_$$($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$,$i$170_newValue$jscomp$12$$){if(null===$i$170_newValue$jscomp$12$$)$JSCompiler_StaticMethods_selectedAttributeMutated_$self$$.$clearAllSelections_$();else{var $selectedArray$$=Array.isArray($i$170_newValue$jscomp$12$$)?$i$170_newValue$jscomp$12$$:[$i$170_newValue$jscomp$12$$];$JSCompiler_StaticMethods_selectedAttributeMutated_$self$$.$isMultiple_$||($selectedArray$$=$selectedArray$$.slice(0,
1));var $selectedMap$$=$selectedArray$$.reduce(function($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$,$i$170_newValue$jscomp$12$$){$JSCompiler_StaticMethods_selectedAttributeMutated_$self$$[$i$170_newValue$jscomp$12$$]=!0;return $JSCompiler_StaticMethods_selectedAttributeMutated_$self$$},Object.create(null));for($i$170_newValue$jscomp$12$$=0;$i$170_newValue$jscomp$12$$<$JSCompiler_StaticMethods_selectedAttributeMutated_$self$$.$options_$.length;$i$170_newValue$jscomp$12$$++){var $element$jscomp$401$$=
$JSCompiler_StaticMethods_selectedAttributeMutated_$self$$.$options_$[$i$170_newValue$jscomp$12$$],$option$jscomp$5$$=$element$jscomp$401$$.getAttribute("option");$selectedMap$$[$option$jscomp$5$$]?$JSCompiler_StaticMethods_setSelection_$$($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$,$element$jscomp$401$$):$JSCompiler_StaticMethods_clearSelection_$$($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$,$element$jscomp$401$$)}$JSCompiler_StaticMethods_updateFocus_$$($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$);
$JSCompiler_StaticMethods_setInputs_$$($JSCompiler_StaticMethods_selectedAttributeMutated_$self$$)}}
function $JSCompiler_StaticMethods_updateFocus_$$($JSCompiler_StaticMethods_updateFocus_$self$$,$opt_focusEl$$){if("none"!=$JSCompiler_StaticMethods_updateFocus_$self$$.$kbSelectMode_$){$JSCompiler_StaticMethods_updateFocus_$self$$.$options_$.forEach(function($JSCompiler_StaticMethods_updateFocus_$self$$){$JSCompiler_StaticMethods_updateFocus_$self$$.tabIndex=-1});var $focusElement$$=$opt_focusEl$$;$focusElement$$||($focusElement$$=$JSCompiler_StaticMethods_updateFocus_$self$$.$isMultiple_$?$JSCompiler_StaticMethods_updateFocus_$self$$.$options_$[0]:
$JSCompiler_StaticMethods_updateFocus_$self$$.$selectedOptions_$[0]||$JSCompiler_StaticMethods_updateFocus_$self$$.$options_$[0]);$focusElement$$&&($JSCompiler_StaticMethods_updateFocus_$self$$.$focusedIndex_$=$JSCompiler_StaticMethods_updateFocus_$self$$.$options_$.indexOf($focusElement$$),$focusElement$$.tabIndex=0)}}
$JSCompiler_prototypeAlias$$.$init_$=function(){var $$jscomp$this$jscomp$638$$=this;[].slice.call(this.element.querySelectorAll("[option]")).forEach(function($option$jscomp$7$$){$option$jscomp$7$$.setAttribute("role","option");$option$jscomp$7$$.hasAttribute("disabled")&&$option$jscomp$7$$.setAttribute("aria-disabled","true");$option$jscomp$7$$.hasAttribute("selected")?$JSCompiler_StaticMethods_setSelection_$$($$jscomp$this$jscomp$638$$,$option$jscomp$7$$):$JSCompiler_StaticMethods_clearSelection_$$($$jscomp$this$jscomp$638$$,
$option$jscomp$7$$);$option$jscomp$7$$.tabIndex=0;$$jscomp$this$jscomp$638$$.$options_$.push($option$jscomp$7$$)});$JSCompiler_StaticMethods_updateFocus_$$(this);$JSCompiler_StaticMethods_setInputs_$$(this)};
function $JSCompiler_StaticMethods_setInputs_$$($JSCompiler_StaticMethods_setInputs_$self$$){var $selectedValues$$=[],$elementName$jscomp$8$$=$JSCompiler_StaticMethods_setInputs_$self$$.element.getAttribute("name");if(!$elementName$jscomp$8$$||$JSCompiler_StaticMethods_setInputs_$self$$.$isDisabled_$)return $selectedValues$$;var $formId$$=$JSCompiler_StaticMethods_setInputs_$self$$.element.getAttribute("form");$JSCompiler_StaticMethods_setInputs_$self$$.$inputs_$.forEach(function($selectedValues$$){$JSCompiler_StaticMethods_setInputs_$self$$.element.removeChild($selectedValues$$)});
$JSCompiler_StaticMethods_setInputs_$self$$.$inputs_$=[];var $doc$jscomp$89$$=$JSCompiler_StaticMethods_setInputs_$self$$.win.document,$fragment$jscomp$7$$=$doc$jscomp$89$$.createDocumentFragment();$JSCompiler_StaticMethods_setInputs_$self$$.$selectedOptions_$.forEach(function($option$jscomp$8_value$jscomp$172$$){if(!$option$jscomp$8_value$jscomp$172$$.hasAttribute("disabled")){var $hidden$jscomp$1$$=$doc$jscomp$89$$.createElement("input");$option$jscomp$8_value$jscomp$172$$=$option$jscomp$8_value$jscomp$172$$.getAttribute("option");
$hidden$jscomp$1$$.setAttribute("type","hidden");$hidden$jscomp$1$$.setAttribute("name",$elementName$jscomp$8$$);$hidden$jscomp$1$$.setAttribute("value",$option$jscomp$8_value$jscomp$172$$);$formId$$&&$hidden$jscomp$1$$.setAttribute("form",$formId$$);$JSCompiler_StaticMethods_setInputs_$self$$.$inputs_$.push($hidden$jscomp$1$$);$fragment$jscomp$7$$.appendChild($hidden$jscomp$1$$);$selectedValues$$.push($option$jscomp$8_value$jscomp$172$$)}});$JSCompiler_StaticMethods_setInputs_$self$$.element.appendChild($fragment$jscomp$7$$);
return $selectedValues$$}
function $JSCompiler_StaticMethods_onOptionPicked_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$,$el$jscomp$39$$){$el$jscomp$39$$.hasAttribute("disabled")||$JSCompiler_StaticMethods_onOptionPicked_$self$$.mutateElement(function(){var $selectedValues$jscomp$1$$;$el$jscomp$39$$.hasAttribute("selected")?$JSCompiler_StaticMethods_onOptionPicked_$self$$.$isMultiple_$&&($JSCompiler_StaticMethods_clearSelection_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$,$el$jscomp$39$$),$selectedValues$jscomp$1$$=
$JSCompiler_StaticMethods_setInputs_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$)):($JSCompiler_StaticMethods_setSelection_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$,$el$jscomp$39$$),$selectedValues$jscomp$1$$=$JSCompiler_StaticMethods_setInputs_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$));if($selectedValues$jscomp$1$$){$JSCompiler_StaticMethods_updateFocus_$$($JSCompiler_StaticMethods_onOptionPicked_$self$$,$el$jscomp$39$$);var $selectEvent$$=$createCustomEvent$$module$src$event_helper$$($JSCompiler_StaticMethods_onOptionPicked_$self$$.win,
"amp-selector.select",{targetOption:$el$jscomp$39$$.getAttribute("option"),selectedOptions:$selectedValues$jscomp$1$$});$JSCompiler_StaticMethods_onOptionPicked_$self$$.$action_$.trigger($JSCompiler_StaticMethods_onOptionPicked_$self$$.element,"select",$selectEvent$$,100)}})}
$JSCompiler_prototypeAlias$$.$clickHandler_$=function($el$jscomp$40_event$jscomp$136$$){if($el$jscomp$40_event$jscomp$136$$=$el$jscomp$40_event$jscomp$136$$.target)$el$jscomp$40_event$jscomp$136$$.hasAttribute("option")||($el$jscomp$40_event$jscomp$136$$=$closestBySelector$$module$src$dom$$($el$jscomp$40_event$jscomp$136$$,"[option]")),$el$jscomp$40_event$jscomp$136$$&&$JSCompiler_StaticMethods_onOptionPicked_$$(this,$el$jscomp$40_event$jscomp$136$$)};
$JSCompiler_prototypeAlias$$.$toggle_$=function($index$jscomp$106$$,$opt_value$jscomp$12$$){var $indexCurrentStatus$$=this.$options_$[$index$jscomp$106$$].hasAttribute("selected"),$indexFinalStatus$$=void 0!==$opt_value$jscomp$12$$?$opt_value$jscomp$12$$:!$indexCurrentStatus$$,$selectedIndex$$=this.$options_$.indexOf(this.$selectedOptions_$[0]);$indexFinalStatus$$!==$indexCurrentStatus$$&&($selectedIndex$$!==$index$jscomp$106$$?($JSCompiler_StaticMethods_setSelection_$$(this,this.$options_$[$index$jscomp$106$$]),
$JSCompiler_StaticMethods_clearSelection_$$(this,this.$options_$[$selectedIndex$$])):$JSCompiler_StaticMethods_clearSelection_$$(this,this.$options_$[$index$jscomp$106$$]))};
function $JSCompiler_StaticMethods_select_$$($JSCompiler_StaticMethods_select_$self$$,$JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$){var $previousIndex$$=$JSCompiler_StaticMethods_select_$self$$.$options_$.indexOf($JSCompiler_StaticMethods_select_$self$$.$selectedOptions_$[0]);$JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$=$previousIndex$$+$JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$;var $JSCompiler_b$jscomp$inline_2162$$=$JSCompiler_StaticMethods_select_$self$$.$options_$.length,$normalizedIndex$$=
0<$JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$&&0<$JSCompiler_b$jscomp$inline_2162$$?$JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$%$JSCompiler_b$jscomp$inline_2162$$:($JSCompiler_a$jscomp$inline_2161_delta$jscomp$6$$%$JSCompiler_b$jscomp$inline_2162$$+$JSCompiler_b$jscomp$inline_2162$$)%$JSCompiler_b$jscomp$inline_2162$$;$JSCompiler_StaticMethods_setSelection_$$($JSCompiler_StaticMethods_select_$self$$,$JSCompiler_StaticMethods_select_$self$$.$options_$[$normalizedIndex$$]);$JSCompiler_StaticMethods_clearSelection_$$($JSCompiler_StaticMethods_select_$self$$,
$JSCompiler_StaticMethods_select_$self$$.$options_$[$previousIndex$$])}
$JSCompiler_prototypeAlias$$.$keyDownHandler_$=function($event$jscomp$137$$){switch($event$jscomp$137$$.keyCode){case 37:case 38:case 39:case 40:"none"!=this.$kbSelectMode_$&&this.$navigationKeyDownHandler_$($event$jscomp$137$$);break;case 13:case 32:var $JSCompiler_keyCode$jscomp$inline_2166$$=$event$jscomp$137$$.keyCode;32!=$JSCompiler_keyCode$jscomp$inline_2166$$&&13!=$JSCompiler_keyCode$jscomp$inline_2166$$||!this.$options_$.includes($event$jscomp$137$$.target)||($event$jscomp$137$$.preventDefault(),
$JSCompiler_StaticMethods_onOptionPicked_$$(this,$event$jscomp$137$$.target))}};
$JSCompiler_prototypeAlias$$.$navigationKeyDownHandler_$=function($event$jscomp$138$$){var $dir$jscomp$11_doc$jscomp$90$$=this.win.document;switch($event$jscomp$138$$.keyCode){case 37:$dir$jscomp$11_doc$jscomp$90$$=$isRTL$$module$src$dom$$($dir$jscomp$11_doc$jscomp$90$$)?1:-1;break;case 38:$dir$jscomp$11_doc$jscomp$90$$=-1;break;case 39:$dir$jscomp$11_doc$jscomp$90$$=$isRTL$$module$src$dom$$($dir$jscomp$11_doc$jscomp$90$$)?-1:1;break;case 40:$dir$jscomp$11_doc$jscomp$90$$=1;break;default:return}$event$jscomp$138$$.preventDefault();
this.$options_$[this.$focusedIndex_$].tabIndex=-1;this.$focusedIndex_$=(this.$focusedIndex_$+$dir$jscomp$11_doc$jscomp$90$$)%this.$options_$.length;0>this.$focusedIndex_$&&(this.$focusedIndex_$=this.$focusedIndex_$+this.$options_$.length);var $newSelectedOption$$=this.$options_$[this.$focusedIndex_$];$newSelectedOption$$.tabIndex=0;$tryFocus$$module$src$dom$$($newSelectedOption$$);var $focusedOption$$=this.$options_$[this.$focusedIndex_$];"select"==this.$kbSelectMode_$&&$JSCompiler_StaticMethods_onOptionPicked_$$(this,
$focusedOption$$)};function $JSCompiler_StaticMethods_clearSelection_$$($JSCompiler_StaticMethods_clearSelection_$self$$,$element$jscomp$402$$){$element$jscomp$402$$.removeAttribute("selected");$element$jscomp$402$$.setAttribute("aria-selected","false");var $selIndex$$=$JSCompiler_StaticMethods_clearSelection_$self$$.$selectedOptions_$.indexOf($element$jscomp$402$$);-1!==$selIndex$$&&$JSCompiler_StaticMethods_clearSelection_$self$$.$selectedOptions_$.splice($selIndex$$,1)}
$JSCompiler_prototypeAlias$$.$clearAllSelections_$=function(){for(;0<this.$selectedOptions_$.length;){var $el$jscomp$42$$=this.$selectedOptions_$.pop();$JSCompiler_StaticMethods_clearSelection_$$(this,$el$jscomp$42$$)}$JSCompiler_StaticMethods_setInputs_$$(this)};
function $JSCompiler_StaticMethods_setSelection_$$($JSCompiler_StaticMethods_setSelection_$self$$,$element$jscomp$403$$){$JSCompiler_StaticMethods_setSelection_$self$$.$selectedOptions_$.includes($element$jscomp$403$$)||($JSCompiler_StaticMethods_setSelection_$self$$.$isMultiple_$||$JSCompiler_StaticMethods_setSelection_$self$$.$clearAllSelections_$(),$element$jscomp$403$$.setAttribute("selected",""),$element$jscomp$403$$.setAttribute("aria-selected","true"),$JSCompiler_StaticMethods_setSelection_$self$$.$selectedOptions_$.push($element$jscomp$403$$))}
(function($AMP$jscomp$77$$){$AMP$jscomp$77$$.registerElement("amp-selector",$AmpSelector$$module$extensions$amp_selector$0_1$amp_selector$$,"amp-selector [option]{cursor:pointer}amp-selector [option][selected]{cursor:auto;outline:1px solid rgba(0,0,0,0.7)}amp-selector [disabled][option],amp-selector[disabled] [option],amp-selector[disabled] [selected],amp-selector [selected][disabled]{cursor:auto;outline:none}\n/*# sourceURL=/extensions/amp-selector/0.1/amp-selector.css*/")})(self.AMP);})});
//# sourceMappingURL=extensions-amp-selector-0.1-amp-selector.js.map

