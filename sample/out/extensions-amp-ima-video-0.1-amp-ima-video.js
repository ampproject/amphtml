(self.AMP=self.AMP||[]).push({n:"extensions-amp-ima-video-0.1-amp-ima-video.js", v:"erwin", f:(function(){function $ImaPlayerData$$module$ads$google$ima_player_data$$(){this.currentTime=0;this.duration=1;this.playedRanges=[]}
$ImaPlayerData$$module$ads$google$ima_player_data$$.prototype.update=function($videoPlayer$$){this.currentTime=$videoPlayer$$.currentTime;this.duration=$videoPlayer$$.duration;var $played$$=$videoPlayer$$.played,$length$jscomp$33$$=$played$$.length;this.playedRanges=[];for(var $i$jscomp$296$$=0;$i$jscomp$296$$<$length$jscomp$33$$;$i$jscomp$296$$++)this.playedRanges.push([$played$$.start($i$jscomp$296$$),$played$$.end($i$jscomp$296$$)])};function $AmpImaVideo$$module$extensions$amp_ima_video$0_1$amp_ima_video$$($$jscomp$super$this$jscomp$48_element$jscomp$344$$){$$jscomp$super$this$jscomp$48_element$jscomp$344$$=AMP.BaseElement.call(this,$$jscomp$super$this$jscomp$48_element$jscomp$344$$)||this;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$iframe_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$viewport_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$playerReadyPromise_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$playerReadyResolver_$=
null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$unlistenMessage_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$preconnectSource_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$preconnectTrack_$=null;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$isFullscreen_$=!1;$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$unlisteners_$={};$$jscomp$super$this$jscomp$48_element$jscomp$344$$.$playerData_$=new $ImaPlayerData$$module$ads$google$ima_player_data$$;return $$jscomp$super$this$jscomp$48_element$jscomp$344$$}
$$jscomp$inherits$$($AmpImaVideo$$module$extensions$amp_ima_video$0_1$amp_ima_video$$,AMP.BaseElement);$JSCompiler_prototypeAlias$$=$AmpImaVideo$$module$extensions$amp_ima_video$0_1$amp_ima_video$$.prototype;
$JSCompiler_prototypeAlias$$.buildCallback=function(){var $$jscomp$this$jscomp$528$$=this;this.$viewport_$=this.getViewport();"true"===this.element.getAttribute("data-delay-ad-request")&&(this.$unlisteners_$.onFirstScroll=this.$viewport_$.onScroll(function(){$$jscomp$this$jscomp$528$$.$sendCommand_$("onFirstScroll")}),$Services$$module$src$services$timerFor$$(this.win).delay(function(){$$jscomp$this$jscomp$528$$.$sendCommand_$("onAdRequestDelayTimeout")},3E3));$assertHttpsUrl$$module$src$url$$(this.element.getAttribute("data-tag"),
"The data-tag attribute is required for <amp-video-ima> and must be https");var $sourceElements$$=$childElementsByTag$$module$src$dom$$(this.element,"SOURCE"),$trackElements$$=$childElementsByTag$$module$src$dom$$(this.element,"TRACK"),$childElements$$=$toArray$$module$src$types$$($sourceElements$$).concat($toArray$$module$src$types$$($trackElements$$));if(0<$childElements$$.length){var $children$jscomp$11$$=[];$childElements$$.forEach(function($sourceElements$$){"SOURCE"!=$sourceElements$$.tagName||
$$jscomp$this$jscomp$528$$.$preconnectSource_$?"TRACK"!=$sourceElements$$.tagName||$$jscomp$this$jscomp$528$$.$preconnectTrack_$||($$jscomp$this$jscomp$528$$.$preconnectTrack_$=$sourceElements$$.src):$$jscomp$this$jscomp$528$$.$preconnectSource_$=$sourceElements$$.src;$children$jscomp$11$$.push($sourceElements$$.outerHTML)});this.element.setAttribute("data-child-elements",JSON.stringify($children$jscomp$11$$))}var $scriptElement$jscomp$3$$=$childElementsByTag$$module$src$dom$$(this.element,"SCRIPT")[0];
$scriptElement$jscomp$3$$&&$isJsonScriptTag$$module$src$dom$$($scriptElement$jscomp$3$$)&&this.element.setAttribute("data-ima-settings",$scriptElement$jscomp$3$$.innerHTML)};
$JSCompiler_prototypeAlias$$.preconnectCallback=function(){var $element$jscomp$345$$=this.element,$preconnect$jscomp$4$$=this.preconnect;$preconnect$jscomp$4$$.preload("https://imasdk.googleapis.com/js/sdkloader/ima3.js","script");var $source$jscomp$39$$=$element$jscomp$345$$.getAttribute("data-src");$source$jscomp$39$$&&$preconnect$jscomp$4$$.url($source$jscomp$39$$);this.$preconnectSource_$&&$preconnect$jscomp$4$$.url(this.$preconnectSource_$);this.$preconnectTrack_$&&$preconnect$jscomp$4$$.url(this.$preconnectTrack_$);
$preconnect$jscomp$4$$.url($element$jscomp$345$$.getAttribute("data-tag"));$preloadBootstrap$$module$src$3p_frame$$(this.win,$preconnect$jscomp$4$$)};$JSCompiler_prototypeAlias$$.isLayoutSupported=function($layout$jscomp$56$$){return $isLayoutSizeDefined$$module$src$layout$$($layout$jscomp$56$$)};$JSCompiler_prototypeAlias$$.getConsentPolicy=function(){return null};
$JSCompiler_prototypeAlias$$.layoutCallback=function(){var $$jscomp$this$jscomp$529$$=this,$consentPolicyId$jscomp$3$$=AMP.BaseElement.prototype.getConsentPolicy.call(this);return($consentPolicyId$jscomp$3$$?$getConsentPolicyState$$module$src$consent$$(this.getAmpDoc(),$consentPolicyId$jscomp$3$$):Promise.resolve(null)).then(function($consentPolicyId$jscomp$3$$){var $initialConsentState$$=$$jscomp$this$jscomp$529$$.element,$iframe$jscomp$49$$=$getIframe$$module$src$3p_frame$$($$jscomp$this$jscomp$529$$.win,
$initialConsentState$$,"ima-video",{initialConsentState:$consentPolicyId$jscomp$3$$});$iframe$jscomp$49$$.setAttribute("allowfullscreen","true");$$jscomp$this$jscomp$529$$.applyFillContent($iframe$jscomp$49$$);$$jscomp$this$jscomp$529$$.$iframe_$=$iframe$jscomp$49$$;var $deferred$jscomp$38$$=new $Deferred$$module$src$utils$promise$$;$$jscomp$this$jscomp$529$$.$playerReadyPromise_$=$deferred$jscomp$38$$.promise;$$jscomp$this$jscomp$529$$.$playerReadyResolver_$=$deferred$jscomp$38$$.resolve;$$jscomp$this$jscomp$529$$.$unlistenMessage_$=
$listen$$module$src$event_helper$$($$jscomp$this$jscomp$529$$.win,"message",function($consentPolicyId$jscomp$3$$){if($consentPolicyId$jscomp$3$$.source==$$jscomp$this$jscomp$529$$.$iframe_$.contentWindow&&($consentPolicyId$jscomp$3$$=$consentPolicyId$jscomp$3$$.data,$isObject$$module$src$types$$($consentPolicyId$jscomp$3$$))){var $initialConsentState$$=$consentPolicyId$jscomp$3$$.event;$isEnumValue$$module$src$types$$($VideoEvents$$module$src$video_interface$$,$initialConsentState$$)?($initialConsentState$$==
$VideoEvents$$module$src$video_interface$$.LOAD&&$$jscomp$this$jscomp$529$$.$playerReadyResolver_$($$jscomp$this$jscomp$529$$.$iframe_$),$$jscomp$this$jscomp$529$$.element.dispatchCustomEvent($initialConsentState$$)):"imaPlayerData"==$initialConsentState$$?$$jscomp$this$jscomp$529$$.$playerData_$=$consentPolicyId$jscomp$3$$.data:"fullscreenchange"==$initialConsentState$$&&($$jscomp$this$jscomp$529$$.$isFullscreen_$=!!$consentPolicyId$jscomp$3$$.isFullscreen)}});$initialConsentState$$.appendChild($iframe$jscomp$49$$);
$installVideoManagerForDoc$$module$src$service$video_manager_impl$$($initialConsentState$$);$Services$$module$src$services$videoManagerForDoc$$($$jscomp$this$jscomp$529$$.win.document).register($$jscomp$this$jscomp$529$$);return $$jscomp$this$jscomp$529$$.loadPromise($iframe$jscomp$49$$).then(function(){return $$jscomp$this$jscomp$529$$.$playerReadyPromise_$})})};
$JSCompiler_prototypeAlias$$.viewportCallback=function($visible$jscomp$9$$){this.element.dispatchCustomEvent($VideoEvents$$module$src$video_interface$$.VISIBILITY,{visible:$visible$jscomp$9$$})};
$JSCompiler_prototypeAlias$$.unlayoutCallback=function(){this.$iframe_$&&($removeElement$$module$src$dom$$(this.$iframe_$),this.$iframe_$=null);this.$unlistenMessage_$&&this.$unlistenMessage_$();var $deferred$jscomp$39$$=new $Deferred$$module$src$utils$promise$$;this.$playerReadyPromise_$=$deferred$jscomp$39$$.promise;this.$playerReadyResolver_$=$deferred$jscomp$39$$.resolve;return!0};
$JSCompiler_prototypeAlias$$.onLayoutMeasure=function(){if(this.$iframe_$){var $$jscomp$destructuring$var315$$=this.getLayoutBox();this.$sendCommand_$("resize",{width:$$jscomp$destructuring$var315$$.width,height:$$jscomp$destructuring$var315$$.height})}};
$JSCompiler_prototypeAlias$$.$sendCommand_$=function($command$jscomp$4$$,$opt_args$jscomp$10$$){var $$jscomp$this$jscomp$530$$=this;this.$iframe_$&&this.$iframe_$.contentWindow&&this.$playerReadyPromise_$.then(function(){$$jscomp$this$jscomp$530$$.$iframe_$.contentWindow.postMessage(JSON.stringify($dict$$module$src$utils$object$$({event:"command",func:$command$jscomp$4$$,args:$opt_args$jscomp$10$$||""})),"*")});if(this.$unlisteners_$[$command$jscomp$4$$])this.$unlisteners_$[$command$jscomp$4$$]()};
$JSCompiler_prototypeAlias$$.supportsPlatform=function(){return!0};$JSCompiler_prototypeAlias$$.isInteractive=function(){return!0};$JSCompiler_prototypeAlias$$.play=function(){this.$sendCommand_$("playVideo")};$JSCompiler_prototypeAlias$$.pause=function(){this.$sendCommand_$("pauseVideo")};$JSCompiler_prototypeAlias$$.mute=function(){this.$sendCommand_$("mute")};$JSCompiler_prototypeAlias$$.unmute=function(){this.$sendCommand_$("unMute")};$JSCompiler_prototypeAlias$$.showControls=function(){};
$JSCompiler_prototypeAlias$$.hideControls=function(){};$JSCompiler_prototypeAlias$$.fullscreenEnter=function(){this.$sendCommand_$("enterFullscreen")};$JSCompiler_prototypeAlias$$.fullscreenExit=function(){this.$sendCommand_$("exitFullscreen")};$JSCompiler_prototypeAlias$$.isFullscreen=function(){return this.$isFullscreen_$};$JSCompiler_prototypeAlias$$.getMetadata=function(){};$JSCompiler_prototypeAlias$$.preimplementsMediaSessionAPI=function(){return!1};
$JSCompiler_prototypeAlias$$.preimplementsAutoFullscreen=function(){return!1};$JSCompiler_prototypeAlias$$.getCurrentTime=function(){return this.$playerData_$.currentTime};$JSCompiler_prototypeAlias$$.getDuration=function(){return this.$playerData_$.duration};$JSCompiler_prototypeAlias$$.getPlayedRanges=function(){return this.$playerData_$.playedRanges};(function($AMP$jscomp$53$$){$AMP$jscomp$53$$.registerElement("amp-ima-video",$AmpImaVideo$$module$extensions$amp_ima_video$0_1$amp_ima_video$$)})(self.AMP);})});
//# sourceMappingURL=extensions-amp-ima-video-0.1-amp-ima-video.js.map

