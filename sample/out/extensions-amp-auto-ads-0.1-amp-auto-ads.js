(self.AMP=self.AMP||[]).push({n:"extensions-amp-auto-ads-0.1-amp-auto-ads.js", v:"erwin", f:(function(){function $AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ads$$,$adConstraints$$){this.B=$ads$$;this.H=$adConstraints$$.initialMinSpacing;this.F=$adConstraints$$.subsequentMinSpacing.slice(0).sort(function($ads$$,$adConstraints$$){return $ads$$.adCount-$adConstraints$$.adCount});this.K=$adConstraints$$.maxAdCount;this.D=$JSCompiler_StaticMethods_getMinAdSpacing_$$(this)}$AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$.prototype.G=function($ad$$){this.B.push($ad$$);this.D=$JSCompiler_StaticMethods_getMinAdSpacing_$$(this)};
$AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$.prototype.C=function(){return this.B.length};$AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$.prototype.I=function(){return this.C()>=this.K};$AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$.prototype.J=function($yPosition$$){return $JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$$(this,$yPosition$$,0)};
function $JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$$($JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$self$$,$yPosition$jscomp$1$$,$adIndex$$){return $adIndex$$>=$JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$self$$.B.length?Promise.resolve(!1):$JSCompiler_StaticMethods_getDistanceFromAd_$$($yPosition$jscomp$1$$,$JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$self$$.B[$adIndex$$]).then(function($distance$jscomp$6$$){return $distance$jscomp$6$$<$JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$self$$.D?
!0:$JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$$($JSCompiler_StaticMethods_isWithinMinDistanceOfAd_$self$$,$yPosition$jscomp$1$$,$adIndex$$+1)})}
function $JSCompiler_StaticMethods_getDistanceFromAd_$$($yPosition$jscomp$2$$,$ad$jscomp$1$$){return $Services$$module$src$services$resourcesForDoc$$($ad$jscomp$1$$).getElementLayoutBox($ad$jscomp$1$$).then(function($ad$jscomp$1$$){return $yPosition$jscomp$2$$>=$ad$jscomp$1$$.top&&$yPosition$jscomp$2$$<=$ad$jscomp$1$$.bottom?0:Math.min(Math.abs($yPosition$jscomp$2$$-$ad$jscomp$1$$.top),Math.abs($yPosition$jscomp$2$$-$ad$jscomp$1$$.bottom))})}
function $JSCompiler_StaticMethods_getMinAdSpacing_$$($JSCompiler_StaticMethods_getMinAdSpacing_$self$$){for(var $adCount$$=$JSCompiler_StaticMethods_getMinAdSpacing_$self$$.C(),$spacing$$=$JSCompiler_StaticMethods_getMinAdSpacing_$self$$.H,$i$jscomp$257$$=0;$i$jscomp$257$$<$JSCompiler_StaticMethods_getMinAdSpacing_$self$$.F.length;$i$jscomp$257$$++){var $item$jscomp$16$$=$JSCompiler_StaticMethods_getMinAdSpacing_$self$$.F[$i$jscomp$257$$];$item$jscomp$16$$.adCount<=$adCount$$&&($spacing$$=$item$jscomp$16$$.spacing)}return $spacing$$}
function $getExistingAds$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ampdoc$jscomp$120$$){return[].slice.call($ampdoc$jscomp$120$$.getRootNode().getElementsByTagName("AMP-AD")).filter(function($ampdoc$jscomp$120$$){return $ampdoc$jscomp$120$$.parentElement&&"AMP-STICKY-AD"==$ampdoc$jscomp$120$$.parentElement.tagName?!1:!0})}
function $getAdConstraintsFromConfigObj$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ampdoc$jscomp$121$$,$configObj$$){var $obj$jscomp$50$$=$configObj$$.adConstraints;if(!$obj$jscomp$50$$)return null;var $viewportHeight$jscomp$2$$=$Services$$module$src$services$viewportForDoc$$($ampdoc$jscomp$121$$).getHeight(),$initialMinSpacing$$=$getValueFromString$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($obj$jscomp$50$$.initialMinSpacing,$viewportHeight$jscomp$2$$);if(null==$initialMinSpacing$$)return $user$$module$src$log$$().warn("amp-auto-ads",
"Invalid initial min spacing"),null;var $subsequentMinSpacing$$=($obj$jscomp$50$$.subsequentMinSpacing||[]).map(function($ampdoc$jscomp$121$$){var $configObj$$=$ampdoc$jscomp$121$$.adCount;if(null==$configObj$$)return $user$$module$src$log$$().warn("amp-auto-ads","No subsequentMinSpacing adCount specified"),null;$ampdoc$jscomp$121$$=$getValueFromString$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ampdoc$jscomp$121$$.spacing,$viewportHeight$jscomp$2$$);return null==$ampdoc$jscomp$121$$?($user$$module$src$log$$().warn("amp-auto-ads",
"Invalid subsequent min spacing"),null):{adCount:$configObj$$,spacing:$ampdoc$jscomp$121$$}});return-1!=$subsequentMinSpacing$$.indexOf(null)?null:null==$obj$jscomp$50$$.maxAdCount?($user$$module$src$log$$().warn("amp-auto-ads","No maxAdCount specified"),null):{initialMinSpacing:$initialMinSpacing$$,subsequentMinSpacing:$subsequentMinSpacing$$,maxAdCount:$obj$jscomp$50$$.maxAdCount}}
function $getValueFromString$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($strValue$$,$viewportHeight$jscomp$3$$){if(!$strValue$$)return null;var $numValue$$=parseFloat($strValue$$);return isNaN($numValue$$)||0>$numValue$$?null:$endsWith$$module$src$string$$($strValue$$,"px")?$numValue$$:$endsWith$$module$src$string$$($strValue$$,"vp")?$numValue$$*$viewportHeight$jscomp$3$$:null};function $AnchorAdStrategy$$module$extensions$amp_auto_ads$0_1$anchor_ad_strategy$$($ampdoc$jscomp$122$$,$baseAttributes$$,$configObj$jscomp$1$$){this.ampdoc=$ampdoc$jscomp$122$$;this.B=$baseAttributes$$;this.C=$configObj$jscomp$1$$}
$AnchorAdStrategy$$module$extensions$amp_auto_ads$0_1$anchor_ad_strategy$$.prototype.run=function(){var $JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$;a:{if($JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=
this.C.optInStatus)for(var $JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$=0;$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$<$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$.length;$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$++)if(2==
$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$[$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$]){$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=
!0;break a}$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=!1}if(!$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$)return Promise.resolve(!1);if(0<this.ampdoc.getRootNode().getElementsByTagName("AMP-STICKY-AD").length)return $user$$module$src$log$$().warn("amp-auto-ads",
"exists <amp-sticky-ad>"),Promise.resolve(!1);$Services$$module$src$services$extensionsFor$$(this.ampdoc.win).installExtensionForDoc(this.ampdoc,"amp-sticky-ad");$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=$Services$$module$src$services$viewportForDoc$$(this.ampdoc).getWidth();$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$=
Object.assign({},this.B,$dict$$module$src$utils$object$$({width:String($JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$),height:"100"}));$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=this.ampdoc.win.document;
$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$=$createElementWithAttributes$$module$src$dom$$($JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$,"amp-ad",$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$);
$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$=$createElementWithAttributes$$module$src$dom$$($JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$,"amp-sticky-ad",$dict$$module$src$utils$object$$({layout:"nodisplay"}));
$JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$.appendChild($JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$);$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$=
this.ampdoc.getBody();$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$.insertBefore($JSCompiler_doc$jscomp$inline_1730_JSCompiler_inline_result$jscomp$420_JSCompiler_optInStatus$jscomp$inline_1724_JSCompiler_stickyAd$jscomp$inline_1732_JSCompiler_viewportWidth$jscomp$inline_1728$$,$JSCompiler_ampAd$jscomp$inline_1731_JSCompiler_attributes$jscomp$inline_1729_JSCompiler_body$jscomp$inline_1733_JSCompiler_i$jscomp$inline_1725$$.firstChild);
return Promise.resolve(!0)};var $NON_DATA_ATTRIBUTE_WHITELIST$$module$extensions$amp_auto_ads$0_1$attributes$$={type:!0};
function $getAttributesFromConfigObj$$module$extensions$amp_auto_ads$0_1$attributes$$($JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$){if(!$JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$.attributes)return{};if(!$isObject$$module$src$types$$($JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$.attributes)||$isArray$$module$src$types$$($JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$.attributes))return $user$$module$src$log$$().warn("amp-auto-ads","attributes property not an object"),
{};$JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$=$JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$.attributes;var $JSCompiler_attributes$jscomp$inline_1736$$={},$JSCompiler_key$jscomp$inline_1737$$;for($JSCompiler_key$jscomp$inline_1737$$ in $JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$)if($NON_DATA_ATTRIBUTE_WHITELIST$$module$extensions$amp_auto_ads$0_1$attributes$$[$JSCompiler_key$jscomp$inline_1737$$]||$startsWith$$module$src$string$$($JSCompiler_key$jscomp$inline_1737$$,
"data-")){var $JSCompiler_valueType$jscomp$inline_1738$$=typeof $JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$[$JSCompiler_key$jscomp$inline_1737$$];"number"!=$JSCompiler_valueType$jscomp$inline_1738$$&&"string"!=$JSCompiler_valueType$jscomp$inline_1738$$&&"boolean"!=$JSCompiler_valueType$jscomp$inline_1738$$?$user$$module$src$log$$().warn("amp-auto-ads","Attribute type not supported: "+$JSCompiler_valueType$jscomp$inline_1738$$):$JSCompiler_attributes$jscomp$inline_1736$$[$JSCompiler_key$jscomp$inline_1737$$]=
String($JSCompiler_attributeObject$jscomp$inline_1735_configObj$jscomp$2$$[$JSCompiler_key$jscomp$inline_1737$$])}else $user$$module$src$log$$().warn("amp-auto-ads","Attribute not whitlisted: "+$JSCompiler_key$jscomp$inline_1737$$);return $JSCompiler_attributes$jscomp$inline_1736$$};function $AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$($autoAmpAdsElement$jscomp$1$$){this.B=$autoAmpAdsElement$jscomp$1$$}$AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$.prototype.isEnabled=function($win$jscomp$282$$){var $branch$$=$getAdSenseAmpAutoAdsExpBranch$$module$ads$google$adsense_amp_auto_ads$$($win$jscomp$282$$);return"3782001"!=$branch$$};
$AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$.prototype.D=function(){var $docInfo$jscomp$5$$=$Services$$module$src$services$documentInfoForDoc$$(this.B),$canonicalHostname$$=$parseUrlDeprecated$$module$src$url$$($docInfo$jscomp$5$$.canonicalUrl).hostname;return $buildUrl$$module$ads$google$a4a$url_builder$$("//pagead2.googlesyndication.com/getconfig/ama",{client:this.B.getAttribute("data-ad-client"),plah:$canonicalHostname$$,ama_t:"amp",url:$docInfo$jscomp$5$$.canonicalUrl},
4096)};$AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$.prototype.C=function(){return $dict$$module$src$utils$object$$({type:"adsense","data-ad-client":this.B.getAttribute("data-ad-client")})};
$AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$.prototype.F=function(){var $viewportHeight$jscomp$4$$=$Services$$module$src$services$viewportForDoc$$(this.B).getSize().height;return{initialMinSpacing:$viewportHeight$jscomp$4$$,subsequentMinSpacing:[{adCount:3,spacing:2*$viewportHeight$jscomp$4$$},{adCount:6,spacing:3*$viewportHeight$jscomp$4$$}],maxAdCount:8}};var $BLACKLISTED_ANCESTOR_TAGS$$module$extensions$amp_auto_ads$0_1$placement$$=["AMP-SIDEBAR","AMP-APP-BANNER"],$INJECTORS$$module$extensions$amp_auto_ads$0_1$placement$$={1:function($anchorElement$$,$elementToInject$$){$anchorElement$$.parentNode.insertBefore($elementToInject$$,$anchorElement$$)},4:function($anchorElement$jscomp$1$$,$elementToInject$jscomp$1$$){$anchorElement$jscomp$1$$.parentNode.insertBefore($elementToInject$jscomp$1$$,$anchorElement$jscomp$1$$.nextSibling)},2:function($anchorElement$jscomp$2$$,
$elementToInject$jscomp$2$$){$anchorElement$jscomp$2$$.insertBefore($elementToInject$jscomp$2$$,$anchorElement$jscomp$2$$.firstChild)},3:function($anchorElement$jscomp$3$$,$elementToInject$jscomp$3$$){$anchorElement$jscomp$3$$.appendChild($elementToInject$jscomp$3$$)}};
function $Placement$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$123$$,$resources$jscomp$7$$,$anchorElement$jscomp$4$$,$position$jscomp$12$$,$injector$$,$attributes$jscomp$18$$,$opt_margins$$){this.ampdoc=$ampdoc$jscomp$123$$;this.D=$resources$jscomp$7$$;this.F=$anchorElement$jscomp$4$$;this.G=$position$jscomp$12$$;this.K=$injector$$;this.H=$attributes$jscomp$18$$;this.M=$opt_margins$$;this.C=null;this.B=0}$Placement$$module$extensions$amp_auto_ads$0_1$placement$$.prototype.I=function(){return this.C};
$Placement$$module$extensions$amp_auto_ads$0_1$placement$$.prototype.J=function(){var $$jscomp$this$jscomp$392$$=this;return this.D.getElementLayoutBox(this.F).then(function($JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$){a:switch($$jscomp$this$jscomp$392$$.G){case 1:case 2:$JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$=$JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$.top;break a;case 3:case 4:$JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$=$JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$.bottom;
break a;default:throw Error("Unknown position");}return $JSCompiler_inline_result$jscomp$422_layoutBox$jscomp$6$$})};
$Placement$$module$extensions$amp_auto_ads$0_1$placement$$.prototype.O=function($baseAttributes$jscomp$1$$,$adTracker$$){var $$jscomp$this$jscomp$393$$=this;return this.J().then(function($yPosition$jscomp$3$$){return $adTracker$$.J($yPosition$jscomp$3$$).then(function($adTracker$$){if($adTracker$$)return $$jscomp$this$jscomp$393$$.B=3,$$jscomp$this$jscomp$393$$.B;$$jscomp$this$jscomp$393$$.C=$$jscomp$this$jscomp$393$$.$createAdElement_$($baseAttributes$jscomp$1$$);$$jscomp$this$jscomp$393$$.K($$jscomp$this$jscomp$393$$.F,
$$jscomp$this$jscomp$393$$.C);return $$jscomp$this$jscomp$393$$.D.attemptChangeSize($$jscomp$this$jscomp$393$$.C,250,void 0,$$jscomp$this$jscomp$393$$.M).then(function(){$$jscomp$this$jscomp$393$$.B=2;return $$jscomp$this$jscomp$393$$.B},function(){$$jscomp$this$jscomp$393$$.B=1;return $$jscomp$this$jscomp$393$$.B})})})};
$Placement$$module$extensions$amp_auto_ads$0_1$placement$$.prototype.$createAdElement_$=function($attributes$jscomp$19_baseAttributes$jscomp$2$$){$attributes$jscomp$19_baseAttributes$jscomp$2$$=Object.assign($dict$$module$src$utils$object$$({layout:"fixed-height",height:"0","class":"i-amphtml-layout-awaiting-size"}),$attributes$jscomp$19_baseAttributes$jscomp$2$$,this.H);return $createElementWithAttributes$$module$src$dom$$(this.ampdoc.win.document,"amp-ad",$attributes$jscomp$19_baseAttributes$jscomp$2$$)};
function $getPlacementsFromConfigObj$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$124$$,$configObj$jscomp$3$$){var $placementObjs$$=$configObj$jscomp$3$$.placements;if(!$placementObjs$$)return $user$$module$src$log$$().warn("amp-auto-ads","No placements in config"),[];var $placements$$=[];$placementObjs$$.forEach(function($configObj$jscomp$3$$){$getPlacementsFromObject$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$124$$,$configObj$jscomp$3$$,$placements$$)});return $placements$$}
function $getPlacementsFromObject$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$125$$,$placementObj$jscomp$1$$,$placements$jscomp$1$$){var $injector$jscomp$1$$=$INJECTORS$$module$extensions$amp_auto_ads$0_1$placement$$[$placementObj$jscomp$1$$.pos];if($injector$jscomp$1$$){var $anchor$$=$placementObj$jscomp$1$$.anchor;if($anchor$$){var $anchorElements$$=$getAnchorElements$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$125$$.getBody(),$anchor$$);if($anchorElements$$.length){var $margins$jscomp$2$$=
void 0;if($placementObj$jscomp$1$$.style){var $marginTop$$=parseInt($placementObj$jscomp$1$$.style.top_m,10),$marginBottom$$=parseInt($placementObj$jscomp$1$$.style.bot_m,10);if($marginTop$$||$marginBottom$$)$margins$jscomp$2$$={top:$marginTop$$||void 0,bottom:$marginBottom$$||void 0}}$anchorElements$$.forEach(function($anchor$$){if($isPositionValid$$module$extensions$amp_auto_ads$0_1$placement$$($anchor$$,$placementObj$jscomp$1$$.pos)){var $anchorElements$$=$getAttributesFromConfigObj$$module$extensions$amp_auto_ads$0_1$attributes$$($placementObj$jscomp$1$$);
$placements$jscomp$1$$.push(new $Placement$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$125$$,$Services$$module$src$services$resourcesForDoc$$($anchor$$),$anchor$$,$placementObj$jscomp$1$$.pos,$injector$jscomp$1$$,$anchorElements$$,$margins$jscomp$2$$))}})}else $user$$module$src$log$$().warn("amp-auto-ads","No anchor element found")}else $user$$module$src$log$$().warn("amp-auto-ads","No anchor in placement")}else $user$$module$src$log$$().warn("amp-auto-ads","No injector for position")}
function $getAnchorElements$$module$extensions$amp_auto_ads$0_1$placement$$($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$,$anchorObj$$){var $selector$jscomp$34$$=$anchorObj$$.selector;if(!$selector$jscomp$34$$)return $user$$module$src$log$$().warn("amp-auto-ads","No selector in anchor"),[];$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$=[].slice.call($scopedQuerySelectorAll$$module$src$dom$$($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$,$selector$jscomp$34$$));
var $minChars$$=$anchorObj$$.min_c||0;0<$minChars$$&&($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$=$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$.filter(function($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$){return $element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$.textContent.length>=$minChars$$}));"number"!=typeof $anchorObj$$.index&&$anchorObj$$.all||($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$=($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$=
$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$[$anchorObj$$.index||0])?[$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$]:[]);if(!$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$.length)return[];if($anchorObj$$.sub){var $subElements$jscomp$8$$=[];$element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$.forEach(function($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$){$subElements$jscomp$8$$=$subElements$jscomp$8$$.concat($getAnchorElements$$module$extensions$amp_auto_ads$0_1$placement$$($element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$,
$anchorObj$$.sub))});return $subElements$jscomp$8$$}return $element$jscomp$270_elements$jscomp$18_rootElement$jscomp$4$$}
function $isPositionValid$$module$extensions$amp_auto_ads$0_1$placement$$($anchorElement$jscomp$6$$,$position$jscomp$13$$){var $elementToCheckOrNull$$=1==$position$jscomp$13$$||4==$position$jscomp$13$$?$anchorElement$jscomp$6$$.parentElement:$anchorElement$jscomp$6$$;if(!$elementToCheckOrNull$$)return $user$$module$src$log$$().warn("amp-auto-ads","Parentless anchor with BEFORE/AFTER position."),!1;var $elementToCheck$$=$elementToCheckOrNull$$;return!$BLACKLISTED_ANCESTOR_TAGS$$module$extensions$amp_auto_ads$0_1$placement$$.some(function($anchorElement$jscomp$6$$){return $closestByTag$$module$src$dom$$($elementToCheck$$,
$anchorElement$jscomp$6$$)?($user$$module$src$log$$().warn("amp-auto-ads","Placement inside blacklisted ancestor: "+$anchorElement$jscomp$6$$),!0):!1})};function $AdStrategy$$module$extensions$amp_auto_ads$0_1$ad_strategy$$($placements$jscomp$2$$,$baseAttributes$jscomp$3$$,$adTracker$jscomp$1$$){this.D=$placements$jscomp$2$$.slice(0);this.C=$baseAttributes$jscomp$3$$;this.B=$adTracker$jscomp$1$$;this.$adsPlaced_$=0}
$AdStrategy$$module$extensions$amp_auto_ads$0_1$ad_strategy$$.prototype.run=function(){var $$jscomp$this$jscomp$394$$=this;return this.B.I()?$tryResolve$$module$src$utils$promise$$(function(){return $JSCompiler_StaticMethods_getStrategyResult_$$($$jscomp$this$jscomp$394$$)}):$JSCompiler_StaticMethods_placeNextAd_$$(this).then(function($success$jscomp$11$$){return $success$jscomp$11$$?$$jscomp$this$jscomp$394$$.run():$JSCompiler_StaticMethods_getStrategyResult_$$($$jscomp$this$jscomp$394$$)})};
function $JSCompiler_StaticMethods_getStrategyResult_$$($JSCompiler_StaticMethods_getStrategyResult_$self$$){return{adsPlaced:$JSCompiler_StaticMethods_getStrategyResult_$self$$.$adsPlaced_$,totalAdsOnPage:$JSCompiler_StaticMethods_getStrategyResult_$self$$.B.C()}}
function $JSCompiler_StaticMethods_placeNextAd_$$($JSCompiler_StaticMethods_placeNextAd_$self$$){var $nextPlacement$$=$JSCompiler_StaticMethods_placeNextAd_$self$$.D.shift();return $nextPlacement$$?$nextPlacement$$.O($JSCompiler_StaticMethods_placeNextAd_$self$$.C,$JSCompiler_StaticMethods_placeNextAd_$self$$.B).then(function($state$jscomp$48$$){return 2==$state$jscomp$48$$?($JSCompiler_StaticMethods_placeNextAd_$self$$.B.G($nextPlacement$$.I()),$JSCompiler_StaticMethods_placeNextAd_$self$$.$adsPlaced_$++,
!0):$JSCompiler_StaticMethods_placeNextAd_$$($JSCompiler_StaticMethods_placeNextAd_$self$$)}):($user$$module$src$log$$().warn("amp-auto-ads","unable to fulfill ad strategy"),Promise.resolve(!1))};function $AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$($var_args$jscomp$72$$){return AMP.BaseElement.apply(this,arguments)||this}$$jscomp$inherits$$($AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$,AMP.BaseElement);
$AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$.prototype.buildCallback=function(){var $$jscomp$this$jscomp$396$$=this;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($isExperimentOn$$module$src$experiments$$(this.win,"amp-auto-ads"),"Experiment is off");var $type$jscomp$151$$=this.element.getAttribute("type");$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($type$jscomp$151$$,"Missing type attribute");var $adNetwork$$="adsense"==$type$jscomp$151$$?
new $AdSenseNetworkConfig$$module$extensions$amp_auto_ads$0_1$ad_network_config$$(this.element):null;$user$$module$src$log$$().$Log$$module$src$log_prototype$assert$($adNetwork$$,"No AdNetworkConfig for type: "+$type$jscomp$151$$);if($adNetwork$$.isEnabled(this.win)){var $ampdoc$jscomp$126$$=this.getAmpDoc();$Services$$module$src$services$extensionsFor$$(this.win).installExtensionForDoc($ampdoc$jscomp$126$$,"amp-ad");var $whenVisible$$=$Services$$module$src$services$viewerForDoc$$(this.getAmpDoc()).whenFirstVisible();
$whenVisible$$.then(function(){return $$jscomp$this$jscomp$396$$.$getConfig_$($adNetwork$$.D())}).then(function($type$jscomp$151$$){if($type$jscomp$151$$){var $whenVisible$$=$type$jscomp$151$$.noConfigReason;if($whenVisible$$)$$jscomp$this$jscomp$396$$.user().warn("amp-auto-ads",$whenVisible$$);else{var $configObj$jscomp$4$$=$getPlacementsFromConfigObj$$module$extensions$amp_auto_ads$0_1$placement$$($ampdoc$jscomp$126$$,$type$jscomp$151$$),$attributes$jscomp$21$$=Object.assign($adNetwork$$.C(),$getAttributesFromConfigObj$$module$extensions$amp_auto_ads$0_1$attributes$$($type$jscomp$151$$)),
$adConstraints$jscomp$1_adTracker$jscomp$2$$=$getAdConstraintsFromConfigObj$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ampdoc$jscomp$126$$,$type$jscomp$151$$)||$adNetwork$$.F(),$adConstraints$jscomp$1_adTracker$jscomp$2$$=new $AdTracker$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($getExistingAds$$module$extensions$amp_auto_ads$0_1$ad_tracker$$($ampdoc$jscomp$126$$),$adConstraints$jscomp$1_adTracker$jscomp$2$$);(new $AdStrategy$$module$extensions$amp_auto_ads$0_1$ad_strategy$$($configObj$jscomp$4$$,
$attributes$jscomp$21$$,$adConstraints$jscomp$1_adTracker$jscomp$2$$)).run();(new $AnchorAdStrategy$$module$extensions$amp_auto_ads$0_1$anchor_ad_strategy$$($ampdoc$jscomp$126$$,$attributes$jscomp$21$$,$type$jscomp$151$$)).run()}}})}};$AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$.prototype.isLayoutSupported=function(){return!0};
$AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$.prototype.$getConfig_$=function($configUrl$$){var $$jscomp$this$jscomp$397$$=this;return $Services$$module$src$services$xhrFor$$(this.win).fetchJson($configUrl$$,{mode:"cors",method:"GET",credentials:"omit",requireAmpResponseSourceOrigin:!1}).then(function($configUrl$$){return $configUrl$$.json()}).catch(function($configUrl$$){$$jscomp$this$jscomp$397$$.user().error("amp-auto-ads","amp-auto-ads config xhr failed: "+$configUrl$$);return null})};
(function($AMP$jscomp$23$$){$AMP$jscomp$23$$.registerElement("amp-auto-ads",$AmpAutoAds$$module$extensions$amp_auto_ads$0_1$amp_auto_ads$$)})(self.AMP);})});
//# sourceMappingURL=extensions-amp-auto-ads-0.1-amp-auto-ads.js.map

