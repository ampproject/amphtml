/**
 * Copyright 2018 The AMP HTML Authors. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { CtaTypes } from "./story-ad-localization";
import { getCryptoRandomBytesArray } from "../../../src/core/types/string/bytes";

/**
 * Returns an string with a total of 128 of random values based on the
 * `win.crypto.getRandomValues` API. If that is not available concatenates
 * a string of other values that might be hard to guess including
 * `Math.random` and the current time.
 * @param {!Window} win
 * @return {string} Entropy.
 */
export function getUniqueId(win) {
  // Use win.crypto.getRandomValues to get 128 bits of random value
  var uint8array = getCryptoRandomBytesArray(win, 16);

  // 128 bit
  if (uint8array) {
    return uint8array.join('');
  }

  // Support for legacy browsers.
  return String(win.location.href + Date.now() + win.Math.random() + win.screen.width + win.screen.height);
}

/**
 * Localizes CTA text if it is chosen from our predefined types.a
 * @param {string} ctaType
 * @param {!./story-ad-localization.StoryAdLocalization} localizationService
 * @return {?string}
 */
export function localizeCtaText(ctaType, localizationService) {
  // CTA picked from predefined choices.
  if (CtaTypes[ctaType]) {
    var ctaLocalizedStringId = CtaTypes[ctaType];
    return localizationService.getLocalizedString(ctaLocalizedStringId);
  }

  // Custom CTA text - Should already be localized.
  return ctaType;
}

/**
 * Returns document from given iframe, or null if non FIE.
 * @param {HTMLIFrameElement} iframe
 * @return {!Document}
 */
export function getFrameDoc(iframe) {
  return iframe.contentDocument || iframe.contentWindow.document;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sIm5hbWVzIjpbIkN0YVR5cGVzIiwiZ2V0Q3J5cHRvUmFuZG9tQnl0ZXNBcnJheSIsImdldFVuaXF1ZUlkIiwid2luIiwidWludDhhcnJheSIsImpvaW4iLCJTdHJpbmciLCJsb2NhdGlvbiIsImhyZWYiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInNjcmVlbiIsIndpZHRoIiwiaGVpZ2h0IiwibG9jYWxpemVDdGFUZXh0IiwiY3RhVHlwZSIsImxvY2FsaXphdGlvblNlcnZpY2UiLCJjdGFMb2NhbGl6ZWRTdHJpbmdJZCIsImdldExvY2FsaXplZFN0cmluZyIsImdldEZyYW1lRG9jIiwiaWZyYW1lIiwiY29udGVudERvY3VtZW50IiwiY29udGVudFdpbmRvdyIsImRvY3VtZW50Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQSxTQUFRQSxRQUFSO0FBQ0EsU0FBUUMseUJBQVI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU0MsV0FBVCxDQUFxQkMsR0FBckIsRUFBMEI7QUFDL0I7QUFDQSxNQUFNQyxVQUFVLEdBQUdILHlCQUF5QixDQUFDRSxHQUFELEVBQU0sRUFBTixDQUE1Qzs7QUFBdUQ7QUFDdkQsTUFBSUMsVUFBSixFQUFnQjtBQUNkLFdBQU9BLFVBQVUsQ0FBQ0MsSUFBWCxDQUFnQixFQUFoQixDQUFQO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFPQyxNQUFNLENBQ1hILEdBQUcsQ0FBQ0ksUUFBSixDQUFhQyxJQUFiLEdBQ0VDLElBQUksQ0FBQ0MsR0FBTCxFQURGLEdBRUVQLEdBQUcsQ0FBQ1EsSUFBSixDQUFTQyxNQUFULEVBRkYsR0FHRVQsR0FBRyxDQUFDVSxNQUFKLENBQVdDLEtBSGIsR0FJRVgsR0FBRyxDQUFDVSxNQUFKLENBQVdFLE1BTEYsQ0FBYjtBQU9EOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU0MsZUFBVCxDQUF5QkMsT0FBekIsRUFBa0NDLG1CQUFsQyxFQUF1RDtBQUM1RDtBQUNBLE1BQUlsQixRQUFRLENBQUNpQixPQUFELENBQVosRUFBdUI7QUFDckIsUUFBTUUsb0JBQW9CLEdBQUduQixRQUFRLENBQUNpQixPQUFELENBQXJDO0FBQ0EsV0FBT0MsbUJBQW1CLENBQUNFLGtCQUFwQixDQUF1Q0Qsb0JBQXZDLENBQVA7QUFDRDs7QUFDRDtBQUNBLFNBQU9GLE9BQVA7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxTQUFTSSxXQUFULENBQXFCQyxNQUFyQixFQUE2QjtBQUNsQyxTQUFPQSxNQUFNLENBQUNDLGVBQVAsSUFBMEJELE1BQU0sQ0FBQ0UsYUFBUCxDQUFxQkMsUUFBdEQ7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0N0YVR5cGVzfSBmcm9tICcuL3N0b3J5LWFkLWxvY2FsaXphdGlvbic7XG5pbXBvcnQge2dldENyeXB0b1JhbmRvbUJ5dGVzQXJyYXl9IGZyb20gJyNjb3JlL3R5cGVzL3N0cmluZy9ieXRlcyc7XG5cbi8qKlxuICogUmV0dXJucyBhbiBzdHJpbmcgd2l0aCBhIHRvdGFsIG9mIDEyOCBvZiByYW5kb20gdmFsdWVzIGJhc2VkIG9uIHRoZVxuICogYHdpbi5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzYCBBUEkuIElmIHRoYXQgaXMgbm90IGF2YWlsYWJsZSBjb25jYXRlbmF0ZXNcbiAqIGEgc3RyaW5nIG9mIG90aGVyIHZhbHVlcyB0aGF0IG1pZ2h0IGJlIGhhcmQgdG8gZ3Vlc3MgaW5jbHVkaW5nXG4gKiBgTWF0aC5yYW5kb21gIGFuZCB0aGUgY3VycmVudCB0aW1lLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge3N0cmluZ30gRW50cm9weS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVuaXF1ZUlkKHdpbikge1xuICAvLyBVc2Ugd2luLmNyeXB0by5nZXRSYW5kb21WYWx1ZXMgdG8gZ2V0IDEyOCBiaXRzIG9mIHJhbmRvbSB2YWx1ZVxuICBjb25zdCB1aW50OGFycmF5ID0gZ2V0Q3J5cHRvUmFuZG9tQnl0ZXNBcnJheSh3aW4sIDE2KTsgLy8gMTI4IGJpdFxuICBpZiAodWludDhhcnJheSkge1xuICAgIHJldHVybiB1aW50OGFycmF5LmpvaW4oJycpO1xuICB9XG5cbiAgLy8gU3VwcG9ydCBmb3IgbGVnYWN5IGJyb3dzZXJzLlxuICByZXR1cm4gU3RyaW5nKFxuICAgIHdpbi5sb2NhdGlvbi5ocmVmICtcbiAgICAgIERhdGUubm93KCkgK1xuICAgICAgd2luLk1hdGgucmFuZG9tKCkgK1xuICAgICAgd2luLnNjcmVlbi53aWR0aCArXG4gICAgICB3aW4uc2NyZWVuLmhlaWdodFxuICApO1xufVxuXG4vKipcbiAqIExvY2FsaXplcyBDVEEgdGV4dCBpZiBpdCBpcyBjaG9zZW4gZnJvbSBvdXIgcHJlZGVmaW5lZCB0eXBlcy5hXG4gKiBAcGFyYW0ge3N0cmluZ30gY3RhVHlwZVxuICogQHBhcmFtIHshLi9zdG9yeS1hZC1sb2NhbGl6YXRpb24uU3RvcnlBZExvY2FsaXphdGlvbn0gbG9jYWxpemF0aW9uU2VydmljZVxuICogQHJldHVybiB7P3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvY2FsaXplQ3RhVGV4dChjdGFUeXBlLCBsb2NhbGl6YXRpb25TZXJ2aWNlKSB7XG4gIC8vIENUQSBwaWNrZWQgZnJvbSBwcmVkZWZpbmVkIGNob2ljZXMuXG4gIGlmIChDdGFUeXBlc1tjdGFUeXBlXSkge1xuICAgIGNvbnN0IGN0YUxvY2FsaXplZFN0cmluZ0lkID0gQ3RhVHlwZXNbY3RhVHlwZV07XG4gICAgcmV0dXJuIGxvY2FsaXphdGlvblNlcnZpY2UuZ2V0TG9jYWxpemVkU3RyaW5nKGN0YUxvY2FsaXplZFN0cmluZ0lkKTtcbiAgfVxuICAvLyBDdXN0b20gQ1RBIHRleHQgLSBTaG91bGQgYWxyZWFkeSBiZSBsb2NhbGl6ZWQuXG4gIHJldHVybiBjdGFUeXBlO1xufVxuXG4vKipcbiAqIFJldHVybnMgZG9jdW1lbnQgZnJvbSBnaXZlbiBpZnJhbWUsIG9yIG51bGwgaWYgbm9uIEZJRS5cbiAqIEBwYXJhbSB7SFRNTElGcmFtZUVsZW1lbnR9IGlmcmFtZVxuICogQHJldHVybiB7IURvY3VtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RnJhbWVEb2MoaWZyYW1lKSB7XG4gIHJldHVybiBpZnJhbWUuY29udGVudERvY3VtZW50IHx8IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xufVxuIl19
// /Users/mszylkowski/src/amphtml/extensions/amp-story-auto-ads/0.1/utils.js