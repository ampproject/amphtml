/**
 * Copyright 2017 The AMP HTML Authors. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Services } from "../../../src/service";

/**
 * @const {string}
 */
var BACKGROUND_AUDIO_ELEMENT_CLASS_NAME = 'i-amphtml-story-background-audio';

/**
 * Adds support for the background-audio property on the specified element.
 * @param {!Element} element The element to upgrade with support for background
 *     audio.
 * @param {boolean=} loop
 * @return {?Element} audioEl
 */
export function upgradeBackgroundAudio(element, loop) {
  if (loop === void 0) {
    loop = true;
  }

  if (!element.hasAttribute('background-audio')) {
    return null;
  }

  var audioEl = element.ownerDocument.createElement('audio');
  var audioSrc = Services.urlForDoc(element).assertHttpsUrl(element.getAttribute('background-audio'), element);
  audioEl.setAttribute('src', audioSrc);
  audioEl.setAttribute('preload', 'auto');

  if (loop) {
    audioEl.setAttribute('loop', '');
  }

  audioEl.setAttribute('autoplay', '');
  audioEl.setAttribute('muted', '');
  audioEl.muted = true;
  audioEl.classList.add(BACKGROUND_AUDIO_ELEMENT_CLASS_NAME);
  element.appendChild(audioEl);
  return audioEl;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1ZGlvLmpzIl0sIm5hbWVzIjpbIlNlcnZpY2VzIiwiQkFDS0dST1VORF9BVURJT19FTEVNRU5UX0NMQVNTX05BTUUiLCJ1cGdyYWRlQmFja2dyb3VuZEF1ZGlvIiwiZWxlbWVudCIsImxvb3AiLCJoYXNBdHRyaWJ1dGUiLCJhdWRpb0VsIiwib3duZXJEb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhdWRpb1NyYyIsInVybEZvckRvYyIsImFzc2VydEh0dHBzVXJsIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwibXV0ZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsU0FBUUEsUUFBUjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFNQyxtQ0FBbUMsR0FBRyxrQ0FBNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLFNBQVNDLHNCQUFULENBQWdDQyxPQUFoQyxFQUF5Q0MsSUFBekMsRUFBc0Q7QUFBQSxNQUFiQSxJQUFhO0FBQWJBLElBQUFBLElBQWEsR0FBTixJQUFNO0FBQUE7O0FBQzNELE1BQUksQ0FBQ0QsT0FBTyxDQUFDRSxZQUFSLENBQXFCLGtCQUFyQixDQUFMLEVBQStDO0FBQzdDLFdBQU8sSUFBUDtBQUNEOztBQUNELE1BQU1DLE9BQU8sR0FBR0gsT0FBTyxDQUFDSSxhQUFSLENBQXNCQyxhQUF0QixDQUFvQyxPQUFwQyxDQUFoQjtBQUNBLE1BQU1DLFFBQVEsR0FBR1QsUUFBUSxDQUFDVSxTQUFULENBQW1CUCxPQUFuQixFQUE0QlEsY0FBNUIsQ0FDZlIsT0FBTyxDQUFDUyxZQUFSLENBQXFCLGtCQUFyQixDQURlLEVBRWZULE9BRmUsQ0FBakI7QUFJQUcsRUFBQUEsT0FBTyxDQUFDTyxZQUFSLENBQXFCLEtBQXJCLEVBQTRCSixRQUE1QjtBQUNBSCxFQUFBQSxPQUFPLENBQUNPLFlBQVIsQ0FBcUIsU0FBckIsRUFBZ0MsTUFBaEM7O0FBQ0EsTUFBSVQsSUFBSixFQUFVO0FBQ1JFLElBQUFBLE9BQU8sQ0FBQ08sWUFBUixDQUFxQixNQUFyQixFQUE2QixFQUE3QjtBQUNEOztBQUNEUCxFQUFBQSxPQUFPLENBQUNPLFlBQVIsQ0FBcUIsVUFBckIsRUFBaUMsRUFBakM7QUFDQVAsRUFBQUEsT0FBTyxDQUFDTyxZQUFSLENBQXFCLE9BQXJCLEVBQThCLEVBQTlCO0FBQ0FQLEVBQUFBLE9BQU8sQ0FBQ1EsS0FBUixHQUFnQixJQUFoQjtBQUNBUixFQUFBQSxPQUFPLENBQUNTLFNBQVIsQ0FBa0JDLEdBQWxCLENBQXNCZixtQ0FBdEI7QUFDQUUsRUFBQUEsT0FBTyxDQUFDYyxXQUFSLENBQW9CWCxPQUFwQjtBQUVBLFNBQU9BLE9BQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1NlcnZpY2VzfSBmcm9tICcjc2VydmljZSc7XG5cbi8qKlxuICogQGNvbnN0IHtzdHJpbmd9XG4gKi9cbmNvbnN0IEJBQ0tHUk9VTkRfQVVESU9fRUxFTUVOVF9DTEFTU19OQU1FID0gJ2ktYW1waHRtbC1zdG9yeS1iYWNrZ3JvdW5kLWF1ZGlvJztcblxuLyoqXG4gKiBBZGRzIHN1cHBvcnQgZm9yIHRoZSBiYWNrZ3JvdW5kLWF1ZGlvIHByb3BlcnR5IG9uIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnQgVGhlIGVsZW1lbnQgdG8gdXBncmFkZSB3aXRoIHN1cHBvcnQgZm9yIGJhY2tncm91bmRcbiAqICAgICBhdWRpby5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IGxvb3BcbiAqIEByZXR1cm4gez9FbGVtZW50fSBhdWRpb0VsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGdyYWRlQmFja2dyb3VuZEF1ZGlvKGVsZW1lbnQsIGxvb3AgPSB0cnVlKSB7XG4gIGlmICghZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2JhY2tncm91bmQtYXVkaW8nKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGF1ZGlvRWwgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcbiAgY29uc3QgYXVkaW9TcmMgPSBTZXJ2aWNlcy51cmxGb3JEb2MoZWxlbWVudCkuYXNzZXJ0SHR0cHNVcmwoXG4gICAgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2JhY2tncm91bmQtYXVkaW8nKSxcbiAgICBlbGVtZW50XG4gICk7XG4gIGF1ZGlvRWwuc2V0QXR0cmlidXRlKCdzcmMnLCBhdWRpb1NyYyk7XG4gIGF1ZGlvRWwuc2V0QXR0cmlidXRlKCdwcmVsb2FkJywgJ2F1dG8nKTtcbiAgaWYgKGxvb3ApIHtcbiAgICBhdWRpb0VsLnNldEF0dHJpYnV0ZSgnbG9vcCcsICcnKTtcbiAgfVxuICBhdWRpb0VsLnNldEF0dHJpYnV0ZSgnYXV0b3BsYXknLCAnJyk7XG4gIGF1ZGlvRWwuc2V0QXR0cmlidXRlKCdtdXRlZCcsICcnKTtcbiAgYXVkaW9FbC5tdXRlZCA9IHRydWU7XG4gIGF1ZGlvRWwuY2xhc3NMaXN0LmFkZChCQUNLR1JPVU5EX0FVRElPX0VMRU1FTlRfQ0xBU1NfTkFNRSk7XG4gIGVsZW1lbnQuYXBwZW5kQ2hpbGQoYXVkaW9FbCk7XG5cbiAgcmV0dXJuIGF1ZGlvRWw7XG59XG4iXX0=
// /Users/mszylkowski/src/amphtml/extensions/amp-story/1.0/audio.js