(self.AMP=self.AMP||[]).push({n:"amp-user-notification",v:"1912180046560",f:(function(AMP,_){
var h,k="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},m;if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var p;a:{var q={a:!0},r={};try{r.__proto__=q;p=r.a;break a}catch(a){}p=!1}m=p?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var t=m;function u(){var a,b;this.promise=new Promise(function(d,f){a=d;b=f});this.resolve=a;this.reject=b};function v(){this.h=0;this.R=Promise.resolve();this.O=function(){};this.P=function(){}}v.prototype.onQueueEmpty=function(a){this.O=a;0==this.h&&a()};v.prototype.onQueueNotEmpty=function(a){this.P=a;0<this.h&&a()};v.prototype.registerUI=function(a){var b=this;0==this.h&&this.P();this.h++;var d=this.R.then(function(){return a().then(function(){b.h--;0==b.h&&b.O()})});return this.R=d};function w(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(d){return b}};var x=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function aa(a){for(var b=null,d="",f=0;f<arguments.length;f++){var c=arguments[f];if(c instanceof Error&&!b){b=void 0;var e=Object.getOwnPropertyDescriptor(c,"message");if(e&&e.writable)b=c;else{e=c.stack;var g=Error(c.message);for(b in c)g[b]=c[b];g.stack=e;b=g}}else d&&(d+=" "),d+=c}b?d&&(b.message=d+": "+b.message):b=Error(d);return b}function ba(a){var b=aa.apply(null,arguments);setTimeout(function(){self.__AMP_REPORT_ERROR(b);throw b;})}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};
var y=self.__AMP_LOG;function z(){if(!y.user)throw Error("failed to call initLogConstructor");return y.user}function A(){if(y.dev)return y.dev;throw Error("failed to call initLogConstructor");}function B(a,b,d,f,c){return z().assert(a,b,d,f,c,void 0,void 0,void 0,void 0,void 0,void 0)};var C=Object.prototype.hasOwnProperty;function D(a){return a||{}};function E(){var a=100;this.U=a;this.C=this.G=0;this.o=Object.create(null)}E.prototype.has=function(a){return!!this.o[a]};E.prototype.get=function(a){var b=this.o[a];if(b)return b.access=++this.C,b.payload};E.prototype.put=function(a,b){this.has(a)||this.G++;this.o[a]={payload:b,access:this.C};if(!(this.G<=this.U)){A().warn("lru-cache","Trimming LRU cache");a=this.o;var d=this.C+1,f;for(f in a){var c=a[f].access;if(c<d){d=c;var e=f}}void 0!==e&&(delete a[e],this.G--)}};D({c:!0,v:!0,a:!0,ad:!0,action:!0});var F,G;
function H(a,b){var d=void 0===d?"source":d;B(null!=a,"%s %s must be available",b,d);var f=a;a=f;if("string"==typeof a){F||(F=self.document.createElement("a"),G=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new E));var c=G,e=F;if(c&&c.has(a))a=c.get(a);else{e.href=a;e.protocol||(e.href=e.href);var g={href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:"0"==e.port?"":e.port,pathname:e.pathname,search:e.search,hash:e.hash,origin:null};"/"!==g.pathname[0]&&(g.pathname="/"+g.pathname);
if("http:"==g.protocol&&80==g.port||"https:"==g.protocol&&443==g.port)g.port="",g.host=g.hostname;g.origin=e.origin&&"null"!=e.origin?e.origin:"data:"!=g.protocol&&g.host?g.protocol+"//"+g.host:g.href;c&&c.put(a,g);a=g}}(c="https:"==a.protocol||"localhost"==a.hostname||"127.0.0.1"==a.hostname)||(a=a.hostname,c=a.length-10,c=0<=c&&a.indexOf(".localhost",c)==c);B(c||/^(\/\/)/.test(f),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',
b,d,f)};function I(a,b){if(a.__AMP__EXPERIMENT_TOGGLES)var d=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);d=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var f in a.AMP_CONFIG){var c=a.AMP_CONFIG[f];"number"===typeof c&&0<=c&&1>=c&&(d[f]=Math.random()<c)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(f=a.AMP_CONFIG["allow-doc-opt-in"],c=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){c=
c.getAttribute("content").split(",");for(var e=0;e<c.length;e++)-1!=f.indexOf(c[e])&&(d[c[e]]=!0)}Object.assign(d,ca(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){f=a.AMP_CONFIG["allow-url-opt-in"];c=a.location.originalHash||a.location.hash;a=Object.create(null);if(c)for(var g;g=x.exec(c);)e=w(g[1],g[1]),g=g[2]?w(g[2].replace(/\+/g," "),g[2]):"",a[e]=g;for(c=0;c<f.length;c++)e=a["e-"+f[c]],"1"==e&&(d[f[c]]=!0),"0"==e&&(d[f[c]]=!1)}}var l=
d;return!!l[b]}function ca(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(c){A().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var d=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var f=0;f<d.length;f++)0!=d[f].length&&("-"==d[f][0]?a[d[f].substr(1)]=!1:a[d[f]]=!0);return a};var J={},K=(J["ampdoc-fie"]={isTrafficEligible:function(){return!0},branches:[["21065001"],["21065002"]]},J);function da(a){var b=a.ownerDocument.defaultView,d=b.__AMP_TOP||(b.__AMP_TOP=b),f=b!=d;var c=d;if(I(c,"ampdoc-fie")){c.__AMP_EXPERIMENT_BRANCHES=c.__AMP_EXPERIMENT_BRANCHES||{};for(var e in K)if(C.call(K,e)&&!C.call(c.__AMP_EXPERIMENT_BRANCHES,e))if(K[e].isTrafficEligible&&K[e].isTrafficEligible(c)){if(!c.__AMP_EXPERIMENT_BRANCHES[e]&&I(c,e)){var g=K[e].branches;c.__AMP_EXPERIMENT_BRANCHES[e]=g[Math.floor(Math.random()*g.length)]||null}}else c.__AMP_EXPERIMENT_BRANCHES[e]=null;c="21065002"===(c.__AMP_EXPERIMENT_BRANCHES?
c.__AMP_EXPERIMENT_BRANCHES["ampdoc-fie"]:null)}else c=!1;var l=c;f&&!l?a=L(b,"url-replace")?M(b,"url-replace"):null:(a=N(a),a=O(a),a=L(a,"url-replace")?M(a,"url-replace"):null);return a}function P(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return M(a,b)}function N(a){return a.nodeType?P((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function O(a){a=N(a);return a.isSingleDoc()?a.win:a}
function M(a,b){L(a,b);var d=Q(a);a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function R(a,b){var d=S(a,b);if(d)return d;a=Q(a);a[b]=ea();return a[b].promise}function S(a,b){var d=Q(a)[b];if(d){if(d.promise)return d.promise;M(a,b);return d.promise=Promise.resolve(d.obj)}return null}function Q(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}
function L(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}function ea(){var a=new u,b=a,d=b.promise,f=b.resolve;b=b.reject;d.catch(function(){});return{obj:null,promise:d,resolve:f,reject:b,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function fa(a){var b=S(O(a),"geo");if(b)return b;var d=N(a);return d.waitForBodyOpen().then(function(){var a=d.win;var b=d.win.document.head;if(b){var e={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var g=0;g<b.length;g++){var l=b[g];l=l.getAttribute("custom-element")||l.getAttribute("custom-template");e[l]=!0}e=Object.keys(e)}else e=[];a=e.includes("amp-geo")?P(a,"extensions").waitForExtension(a,"amp-geo"):Promise.resolve();return a}).then(function(){return S(O(a),
"geo")})};function T(a){a=AMP.BaseElement.call(this,a)||this;a.J=null;a.m=null;var b=new u;a.K=b.promise;a.L=b.resolve;a.l=null;a.F=!1;a.A=null;a.B=null;a.w=null;a.j=null;a.H="";a.I=null;a.T=null;return a}var U=AMP.BaseElement;T.prototype=k(U.prototype);T.prototype.constructor=T;if(t)t(T,U);else for(var V in U)if("prototype"!=V)if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(U,V);W&&Object.defineProperty(T,V,W)}else T[V]=U[V];T.Y=U.prototype;h=T.prototype;h.isAlwaysFixed=function(){return!0};
h.buildCallback=function(){var a=this,b=this.getAmpDoc();this.T=da(this.element);this.I=R(O(this.element),"storage");this.m=B(this.element.id,"amp-user-notification should have an id.");this.H="amp-user-notification:"+this.m;this.A=this.element.getAttribute("data-show-if-geo");this.B=this.element.getAttribute("data-show-if-not-geo");(this.j=this.element.getAttribute("data-show-if-href"))&&H(this.j,this.element);B(1>=!!this.j+!!this.A+!!this.B,'Only one "data-show-if-*" attribute allowed');this.A&&
(this.w=X(this,this.A,!0));this.B&&(this.w=X(this,this.B,!1));(this.l=this.element.getAttribute("data-dismiss-href"))&&H(this.l,this.element);var d=this.element.getAttribute("role");d||this.element.setAttribute("role","alert");var f=this.element.getAttribute("data-persist-dismissal");this.F="false"!=f&&"no"!=f;this.registerDefaultAction(function(){return a.dismiss(!1)},"dismiss");this.registerAction("optoutOfCid",function(){return ha(a)});var c=R(O(b),"userNotificationManager");c.then(function(b){b.registerUserNotification(a.m,
a)})};function X(a,b,d){return fa(a.element).then(function(a){B(a,"requires <amp-geo> to use promptIfUnknownForGeoGroup");var c=b.split(/,\s*/).filter(function(b){return 2==a.isInCountryGroup(b)});return!(d?!c.length:c.length)})}
function ia(a,b){var d=a.j;return a.T.expandUrlAsync(d).then(function(d){var c={elementId:a.m,ampUserId:b};var e=[];for(n in c){var g=c[n];if(null!=g)if(Array.isArray(g))for(var f=0;f<g.length;f++){var ja=g[f];e.push(encodeURIComponent(n)+"="+encodeURIComponent(ja))}else e.push(encodeURIComponent(n)+"="+encodeURIComponent(g))}c=e.join("&");e=d;if(c){e=e.split("#",2);var n=e[0].split("?",2);c=n[0]+(n[1]?"?"+n[1]+"&"+c:"?"+c);c+=e[1]?"#"+e[1]:""}else c=e;return c})}
h.V=function(a){var b=this;this.J=a;return ia(this,a).then(function(a){var d={credentials:"include"};return P(b.win,"xhr").fetchJson(a,d).then(function(a){return a.json()})})};function ka(a){var b=a.element.getAttribute("enctype")||"application/json;charset=utf-8";P(a.win,"xhr").fetchJson(a.l,{method:"POST",credentials:"include",body:D({elementId:a.m,ampUserId:a.J}),headers:{"Content-Type":b}})}
h.X=function(a){B("boolean"==typeof a.showNotification,'`showNotification` should be a boolean. Got "%s" which is of type %s.',a.showNotification,typeof a.showNotification);a.showNotification||this.L();return Promise.resolve(a.showNotification)};function ha(a){return R(O(a.element),"cid").then(function(a){return a.optOut()}).then(function(){return a.dismiss(!1)},function(b){A().error("amp-user-notification","Failed to opt out of Cid",b);a.dismiss(!0)})}
function la(a){return R(O(a.element),"cid").then(function(b){return b.get({scope:"amp-user-notification",createCookieIfNotPresent:!0},Promise.resolve(),a.K)})}h.shouldShow=function(){var a=this;return this.isDismissed().then(function(b){return b?!1:a.j?la(a).then(a.V.bind(a)).then(a.X.bind(a)):a.w?a.w:!0})};
h.show=function(){var a=this.element,b=!0;void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","");this.element.classList.add("amp-active");this.getViewport().addToFixedLayer(this.element);return this.K};h.isDismissed=function(){var a=this;return this.F?this.I.then(function(b){return b.get(a.H)}).then(function(a){return!!a},function(a){A().error("amp-user-notification","Failed to read storage",a);return!1}):Promise.resolve(!1)};
h.dismiss=function(a){var b=this;this.element.classList.remove("amp-active");this.element.classList.add("amp-hidden");this.L();this.getViewport().removeFromFixedLayer(this.element);this.F&&!a&&this.I.then(function(a){a.set(b.H,!0)});this.l&&ka(this)};function Y(a){this.ampdoc=a;this.S=Object.create(null);this.D=Object.create(null);this.M=this.ampdoc.whenReady();this.N=Promise.all([this.ampdoc.whenFirstVisible(),this.M]);this.W=R(O(this.ampdoc),"notificationUIManager")}
Y.prototype.get=function(a){var b=this;this.N.then(function(){null==b.ampdoc.getElementById(a)&&z().warn("amp-user-notification","Did not find amp-user-notification element "+a+".")});return Z(this,a).promise};Y.prototype.getNotification=function(a){var b=this;return this.M.then(function(){return b.S[a]})};
Y.prototype.registerUserNotification=function(a,b){var d=this;this.S[a]=b;var f=Z(this,a);return this.N.then(function(){return b.shouldShow()}).then(function(a){if(a)return d.W.then(function(a){return a.registerUI(b.show.bind(b))})}).then(f.resolve.bind(this,b)).catch(ba.bind(null,"Notification service failed amp-user-notification",a))};function Z(a,b){if(a.D[b])return a.D[b];var d=new u;return a.D[b]={promise:d.promise,resolve:d.resolve}}
(function(a){a.registerServiceForDoc("userNotificationManager",Y);a.registerServiceForDoc("notificationUIManager",v);a.registerElement("amp-user-notification",T,"amp-user-notification{position:fixed!important;bottom:0;left:0;overflow:hidden!important;visibility:hidden;background:hsla(0,0%,100%,0.7);z-index:1000;width:100%}amp-user-notification.amp-active{visibility:visible}amp-user-notification.amp-hidden{visibility:hidden}\n/*# sourceURL=/extensions/amp-user-notification/0.1/amp-user-notification.css*/")})(self.AMP);
})});

//# sourceMappingURL=amp-user-notification-0.1.js.map
