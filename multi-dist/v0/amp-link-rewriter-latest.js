(self.AMP=self.AMP||[]).push({n:"amp-link-rewriter",v:"1904281823091",f:(function(AMP,_){
var $$jscomp$objectCreate$$="function"==typeof Object.create?Object.create:function($prototype$$){function $ctor$$(){}$ctor$$.prototype=$prototype$$;return new $ctor$$},$JSCompiler_temp$jscomp$21$$;
if("function"==typeof Object.setPrototypeOf)$JSCompiler_temp$jscomp$21$$=Object.setPrototypeOf;else{var $JSCompiler_inline_result$jscomp$22$$;a:{var $JSCompiler_x$jscomp$inline_29$$={a:!0},$JSCompiler_y$jscomp$inline_30$$={};try{$JSCompiler_y$jscomp$inline_30$$.__proto__=$JSCompiler_x$jscomp$inline_29$$;$JSCompiler_inline_result$jscomp$22$$=$JSCompiler_y$jscomp$inline_30$$.a;break a}catch($JSCompiler_e$jscomp$inline_31$$){}$JSCompiler_inline_result$jscomp$22$$=!1}$JSCompiler_temp$jscomp$21$$=$JSCompiler_inline_result$jscomp$22$$?
function($target$jscomp$83$$,$proto$jscomp$3$$){$target$jscomp$83$$.__proto__=$proto$jscomp$3$$;if($target$jscomp$83$$.__proto__!==$proto$jscomp$3$$)throw new TypeError($target$jscomp$83$$+" is not extensible");return $target$jscomp$83$$}:null}var $$jscomp$setPrototypeOf$$=$JSCompiler_temp$jscomp$21$$;(function($maybeGlobal$$){return"undefined"!=typeof window&&window===$maybeGlobal$$?$maybeGlobal$$:"undefined"!=typeof global&&null!=global?global:$maybeGlobal$$})(this);self.log=self.log||{user:null,dev:null,userForEmbed:null};var $logs$$module$src$log$$=self.log;
function $user$$module$src$log$$($opt_element$jscomp$5$$){$logs$$module$src$log$$.user||($logs$$module$src$log$$.user=$getUserLogger$$module$src$log$$());var $JSCompiler_win$jscomp$inline_34$$=$logs$$module$src$log$$.user.win;return $opt_element$jscomp$5$$&&$opt_element$jscomp$5$$.ownerDocument.defaultView!=$JSCompiler_win$jscomp$inline_34$$?$logs$$module$src$log$$.userForEmbed?$logs$$module$src$log$$.userForEmbed:$logs$$module$src$log$$.userForEmbed=$getUserLogger$$module$src$log$$():$logs$$module$src$log$$.user}
function $getUserLogger$$module$src$log$$(){throw Error("failed to call initLogConstructor");};var $hasOwn_$$module$src$utils$object$$=Object.prototype.hasOwnProperty;function $getServiceForDoc$$module$src$service$$($elementOrAmpDoc$$,$id$jscomp$15$$){var $ampdoc$jscomp$2_holder$jscomp$2$$=$getAmpdoc$$module$src$service$$($elementOrAmpDoc$$);$ampdoc$jscomp$2_holder$jscomp$2$$=$getAmpdocServiceHolder$$module$src$service$$($ampdoc$jscomp$2_holder$jscomp$2$$);return $getServiceInternal$$module$src$service$$($ampdoc$jscomp$2_holder$jscomp$2$$,$id$jscomp$15$$)}
function $getAmpdoc$$module$src$service$$($JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$){if($JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$.nodeType){var $JSCompiler_win$jscomp$inline_70$$=($JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$.ownerDocument||$JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$).defaultView;$JSCompiler_win$jscomp$inline_70$$=$JSCompiler_win$jscomp$inline_70$$.__AMP_TOP||$JSCompiler_win$jscomp$inline_70$$;$JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$=$getServiceInternal$$module$src$service$$($JSCompiler_win$jscomp$inline_70$$,
"ampdoc").getAmpDoc($JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$)}return $JSCompiler_temp$jscomp$65_nodeOrDoc$jscomp$3$$}function $getAmpdocServiceHolder$$module$src$service$$($ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$){$ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$=$getAmpdoc$$module$src$service$$($ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$);return $ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$.isSingleDoc()?$ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$.win:$ampdoc$jscomp$4_nodeOrDoc$jscomp$4$$}
function $getServiceInternal$$module$src$service$$($holder$jscomp$4_s$jscomp$10$$,$id$jscomp$19$$){$isServiceRegistered$$module$src$service$$($holder$jscomp$4_s$jscomp$10$$,$id$jscomp$19$$);var $JSCompiler_services$jscomp$inline_37$$=$holder$jscomp$4_s$jscomp$10$$.services;$JSCompiler_services$jscomp$inline_37$$||($JSCompiler_services$jscomp$inline_37$$=$holder$jscomp$4_s$jscomp$10$$.services={});var $services$$=$JSCompiler_services$jscomp$inline_37$$;$holder$jscomp$4_s$jscomp$10$$=$services$$[$id$jscomp$19$$];
$holder$jscomp$4_s$jscomp$10$$.obj||($holder$jscomp$4_s$jscomp$10$$.obj=new $holder$jscomp$4_s$jscomp$10$$.ctor($holder$jscomp$4_s$jscomp$10$$.context),$holder$jscomp$4_s$jscomp$10$$.ctor=null,$holder$jscomp$4_s$jscomp$10$$.context=null,$holder$jscomp$4_s$jscomp$10$$.resolve&&$holder$jscomp$4_s$jscomp$10$$.resolve($holder$jscomp$4_s$jscomp$10$$.obj));return $holder$jscomp$4_s$jscomp$10$$.obj}
function $isServiceRegistered$$module$src$service$$($holder$jscomp$12_service$jscomp$4$$,$id$jscomp$27$$){$holder$jscomp$12_service$jscomp$4$$=$holder$jscomp$12_service$jscomp$4$$.services&&$holder$jscomp$12_service$jscomp$4$$.services[$id$jscomp$27$$];return!(!$holder$jscomp$12_service$jscomp$4$$||!$holder$jscomp$12_service$jscomp$4$$.ctor&&!$holder$jscomp$12_service$jscomp$4$$.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var $scopeSelectorSupported$$module$src$css$$;function $getDataParamsFromAttributes$$module$src$dom$$($element$jscomp$30_params$jscomp$2$$){var $opt_computeParamNameFunc$$=void 0,$opt_paramPattern$$=$PREFIX_DATA_ATTR$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$,$computeParamNameFunc$$=$opt_computeParamNameFunc$$||function($element$jscomp$30_params$jscomp$2$$){return $element$jscomp$30_params$jscomp$2$$},$dataset$$=$element$jscomp$30_params$jscomp$2$$.dataset;$element$jscomp$30_params$jscomp$2$$={};var $paramPattern$$=$opt_paramPattern$$?
$opt_paramPattern$$:/^param(.+)/,$key$jscomp$41$$;for($key$jscomp$41$$ in $dataset$$){var $matches$$=$key$jscomp$41$$.match($paramPattern$$);$matches$$&&($element$jscomp$30_params$jscomp$2$$[$computeParamNameFunc$$($matches$$[1][0].toLowerCase()+$matches$$[1].substr(1))]=$dataset$$[$key$jscomp$41$$])}return $element$jscomp$30_params$jscomp$2$$};function $parseAttribute$$module$extensions$amp_link_rewriter$0_1$config_options$$($attribute$$){var $newAttr$jscomp$2$$={};Object.keys($attribute$$).forEach(function($key$jscomp$44$$){$newAttr$jscomp$2$$[$key$jscomp$44$$]="^"+$attribute$$[$key$jscomp$44$$]+"$"});return $newAttr$jscomp$2$$};function $getScopeElements$$module$extensions$amp_link_rewriter$0_1$scope$$($ampDoc$$,$configOpts$$){var $doc$jscomp$16$$=$ampDoc$$.getRootNode(),$cssSelector$$=$configOpts$$.section.join(" a, "),$selection$$=$doc$jscomp$16$$.querySelectorAll("a"),$filteredSelection$$=[];0!==$configOpts$$.section.length&&($cssSelector$$+=" a",$selection$$=$doc$jscomp$16$$.querySelectorAll($cssSelector$$));$selection$$.forEach(function($ampDoc$$){$hasAttributeValues$$module$extensions$amp_link_rewriter$0_1$scope$$($ampDoc$$,
$configOpts$$)&&$filteredSelection$$.push($ampDoc$$)});return $filteredSelection$$}
function $hasAttributeValues$$module$extensions$amp_link_rewriter$0_1$scope$$($htmlElement$$,$configOpts$jscomp$1$$){var $anchorAttr$$=$configOpts$jscomp$1$$.attribute,$attrKeys$$=Object.keys($anchorAttr$$);return $attrKeys$$.every(function($configOpts$jscomp$1$$){var $key$jscomp$45$$=new RegExp($anchorAttr$$[$configOpts$jscomp$1$$]);return $key$jscomp$45$$.test($htmlElement$$.getAttribute($configOpts$jscomp$1$$))})};var $WL_ANCHOR_ATTR$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$=["href","id","rel","rev"],$PREFIX_DATA_ATTR$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$=/^vars(.+)/,$REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$=/^(?:https?:)?(?:\/\/)?([^\/?]+)/i,$PAGE_PROP_WHITELIST$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$={SOURCE_URL:!0,DOCUMENT_REFERRER:!0};
function $LinkRewriter$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$($referrer$$,$ampElement$$,$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$){this.$ampDoc_$=$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$;$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$=$ampElement$$;try{/^[\w-]+$/.test("script");if(void 0!==$scopeSelectorSupported$$module$src$css$$)var $JSCompiler_temp$jscomp$inline_105$$=$scopeSelectorSupported$$module$src$css$$;else{try{var $JSCompiler_doc$jscomp$inline_107$$=
$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$.ownerDocument,$JSCompiler_testElement$jscomp$inline_108$$=$JSCompiler_doc$jscomp$inline_107$$.createElement("div"),$JSCompiler_testChild$jscomp$inline_109$$=$JSCompiler_doc$jscomp$inline_107$$.createElement("div");$JSCompiler_testElement$jscomp$inline_108$$.appendChild($JSCompiler_testChild$jscomp$inline_109$$);var $JSCompiler_inline_result$jscomp$inline_106$$=$JSCompiler_testElement$jscomp$inline_108$$.querySelector(":scope div")===$JSCompiler_testChild$jscomp$inline_109$$}catch($JSCompiler_e$jscomp$inline_112$$){$JSCompiler_inline_result$jscomp$inline_106$$=
!1}$JSCompiler_temp$jscomp$inline_105$$=$scopeSelectorSupported$$module$src$css$$=$JSCompiler_inline_result$jscomp$inline_106$$}if($JSCompiler_temp$jscomp$inline_105$$)var $JSCompiler_temp$jscomp$inline_104$$=$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$.querySelectorAll("> script".replace(/^|,/g,"$&:scope "));else{$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$.classList.add("i-amphtml-scoped");var $JSCompiler_scopedSelector$jscomp$inline_110$$="> script".replace(/^|,/g,"$&.i-amphtml-scoped "),
$JSCompiler_elements$jscomp$inline_111$$=$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$.querySelectorAll($JSCompiler_scopedSelector$jscomp$inline_110$$);$JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$.classList.remove("i-amphtml-scoped");$JSCompiler_temp$jscomp$inline_104$$=$JSCompiler_elements$jscomp$inline_111$$}var $JSCompiler_inline_result$jscomp$95$$=$JSCompiler_temp$jscomp$inline_104$$;if(1!==$JSCompiler_inline_result$jscomp$95$$.length)throw Error("Found "+$JSCompiler_inline_result$jscomp$95$$.length+
" <script> children. Expected 1.");var $JSCompiler_script$jscomp$inline_82$$=$JSCompiler_inline_result$jscomp$95$$[0];if("SCRIPT"!=$JSCompiler_script$jscomp$inline_82$$.tagName||!$JSCompiler_script$jscomp$inline_82$$.hasAttribute("type")||"APPLICATION/JSON"!=$JSCompiler_script$jscomp$inline_82$$.getAttribute("type").toUpperCase())throw Error('<script> child must have type="application/json"');try{var $JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$=
JSON.parse($JSCompiler_script$jscomp$inline_82$$.textContent)}catch($JSCompiler_unusedError$jscomp$inline_83$$){throw Error("Failed to parse <script> contents. Is it valid JSON?");}var $JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=$JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$}catch($JSCompiler_e$jscomp$inline_84$$){throw $user$$module$src$log$$($JSCompiler_element$jscomp$inline_78_ampDoc$jscomp$1$$).createError("%s: %s",
"amp-link-rewriter",$JSCompiler_e$jscomp$inline_84$$);}$JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$=$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.output;$user$$module$src$log$$().assert($JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$,
"amp-link-rewriter: output config property is required",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0);this.$configOpts_$={output:$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.output.toString(),section:$hasOwn_$$module$src$utils$object$$.call($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$,
"section")?$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.section:[],attribute:$hasOwn_$$module$src$utils$object$$.call($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$,
"attribute")?$parseAttribute$$module$extensions$amp_link_rewriter$0_1$config_options$$($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.attribute):{},vars:$hasOwn_$$module$src$utils$object$$.call($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$,
"vars")?$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.vars:{}};this.$listElements_$=$getScopeElements$$module$extensions$amp_link_rewriter$0_1$scope$$(this.$ampDoc_$,this.$configOpts_$);this.$referrer_$=$referrer$$;this.$rewrittenUrl_$="";a:if($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=
$ampElement$$,$JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$=$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$.ownerDocument.defaultView,$JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$!=
($JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$.__AMP_TOP||$JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$)){if($isServiceRegistered$$module$src$service$$($JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$,"url-replace")&&($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=
$getServiceInternal$$module$src$service$$($JSCompiler_inline_result$jscomp$inline_80_JSCompiler_shouldBeTrueish$jscomp$inline_87_JSCompiler_win$jscomp$inline_91$$,"url-replace")))break a;$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=null}else $JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=
$getAmpdoc$$module$src$service$$($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$),$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=
$getAmpdocServiceHolder$$module$src$service$$($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$),$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$=
$isServiceRegistered$$module$src$service$$($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$,"url-replace")?$getServiceInternal$$module$src$service$$($JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$,
"url-replace"):null;this.$urlReplacementService_$=$JSCompiler_ampdoc$jscomp$inline_99_JSCompiler_config$jscomp$inline_51_JSCompiler_element$jscomp$inline_89_JSCompiler_embedService$jscomp$inline_93_JSCompiler_holder$jscomp$inline_100_JSCompiler_inline_result$jscomp$64_JSCompiler_inline_result$jscomp$69$$}
$LinkRewriter$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$.prototype.handleClick=function($anchor$$){if($anchor$$&&(this.$rewrittenUrl_$=this.$configOpts_$.output,$anchor$$.href.match($REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$)[1]!==this.$rewrittenUrl_$.match($REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$)[1]&&$JSCompiler_StaticMethods_isListed_$$(this,$anchor$$))){var $sourceTrimmedDomain$$=$getServiceForDoc$$module$src$service$$(this.$ampDoc_$,
"documentInfo").get().sourceUrl.match($REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$)[1],$canonicalTrimmedDomain$$=$getServiceForDoc$$module$src$service$$(this.$ampDoc_$,"documentInfo").get().canonicalUrl.match($REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$)[1];if(!$JSCompiler_StaticMethods_isInternalLink_$$($anchor$$,[$sourceTrimmedDomain$$,$canonicalTrimmedDomain$$])){var $JSCompiler_htmlElement$jscomp$inline_54$$=$anchor$$;this.$rewrittenUrl_$=
this.$urlReplacementService_$.expandUrlSync(this.$rewrittenUrl_$,{DOCUMENT_REFERRER:this.$referrer_$},void 0,$PAGE_PROP_WHITELIST$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$);var $JSCompiler_vars$jscomp$inline_55$$=this.$configOpts_$.vars;$JSCompiler_vars$jscomp$inline_55$$ instanceof Object&&($JSCompiler_htmlElement$jscomp$inline_54$$.href=$JSCompiler_StaticMethods_replaceVars_$$(this,$JSCompiler_htmlElement$jscomp$inline_54$$,$JSCompiler_vars$jscomp$inline_55$$))}}};
function $JSCompiler_StaticMethods_isListed_$$($JSCompiler_StaticMethods_isListed_$self$$,$anchor$jscomp$2$$){if(null===$JSCompiler_StaticMethods_isListed_$self$$.$listElements_$||0===$JSCompiler_StaticMethods_isListed_$self$$.$listElements_$.length)return!0;var $filtered$$=$JSCompiler_StaticMethods_isListed_$self$$.$listElements_$.filter(function($JSCompiler_StaticMethods_isListed_$self$$){return $JSCompiler_StaticMethods_isListed_$self$$===$anchor$jscomp$2$$});return 0<$filtered$$.length?!0:!1}
function $JSCompiler_StaticMethods_isInternalLink_$$($htmlElement$jscomp$1$$,$trimmedDomains$$){var $href$$=$htmlElement$jscomp$1$$.href;return $trimmedDomains$$.some(function($htmlElement$jscomp$1$$){var $trimmedDomains$$=$href$$.match($REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$);return $trimmedDomains$$?$REG_DOMAIN_URL$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$.test($href$$)&&$trimmedDomains$$[1]===$htmlElement$jscomp$1$$:!0})}
function $JSCompiler_StaticMethods_replaceVars_$$($JSCompiler_StaticMethods_replaceVars_$self$$,$htmlElement$jscomp$3$$,$vars$jscomp$1$$){$WL_ANCHOR_ATTR$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$.forEach(function($JSCompiler_StaticMethods_replaceVars_$self$$){$htmlElement$jscomp$3$$.getAttribute($JSCompiler_StaticMethods_replaceVars_$self$$)&&($vars$jscomp$1$$[$JSCompiler_StaticMethods_replaceVars_$self$$]=$htmlElement$jscomp$3$$.getAttribute($JSCompiler_StaticMethods_replaceVars_$self$$))});
var $dataset$jscomp$1$$=$getDataParamsFromAttributes$$module$src$dom$$($htmlElement$jscomp$3$$);Object.assign($vars$jscomp$1$$,$dataset$jscomp$1$$);$vars$jscomp$1$$.random=Math.random().toString(32).substr(2);Object.keys($vars$jscomp$1$$).forEach(function($htmlElement$jscomp$3$$){$vars$jscomp$1$$[$htmlElement$jscomp$3$$]&&($JSCompiler_StaticMethods_replaceVars_$self$$.$rewrittenUrl_$=$JSCompiler_StaticMethods_replaceVars_$self$$.$rewrittenUrl_$.replace("${"+$htmlElement$jscomp$3$$+"}",encodeURIComponent($vars$jscomp$1$$[$htmlElement$jscomp$3$$])))});
$JSCompiler_StaticMethods_replaceVars_$self$$.$rewrittenUrl_$=$JSCompiler_StaticMethods_replaceVars_$self$$.$rewrittenUrl_$.replace(/\${[A-Za-z0-9]+}+/,function(){return""});return $JSCompiler_StaticMethods_replaceVars_$self$$.$rewrittenUrl_$};function $AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$($$jscomp$super$this_element$jscomp$71$$){$$jscomp$super$this_element$jscomp$71$$=AMP.BaseElement.call(this,$$jscomp$super$this_element$jscomp$71$$)||this;$$jscomp$super$this_element$jscomp$71$$.$ampDoc_$=$$jscomp$super$this_element$jscomp$71$$.getAmpDoc();$$jscomp$super$this_element$jscomp$71$$.$rewriter_$=null;$$jscomp$super$this_element$jscomp$71$$.$referrer_$="";$$jscomp$super$this_element$jscomp$71$$.$navigation_$=
$getServiceForDoc$$module$src$service$$($$jscomp$super$this_element$jscomp$71$$.$ampDoc_$,"navigation");return $$jscomp$super$this_element$jscomp$71$$}var $JSCompiler_parentCtor$jscomp$inline_60$$=AMP.BaseElement;$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.prototype=$$jscomp$objectCreate$$($JSCompiler_parentCtor$jscomp$inline_60$$.prototype);$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.prototype.constructor=$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$;
if($$jscomp$setPrototypeOf$$)$$jscomp$setPrototypeOf$$($AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$,$JSCompiler_parentCtor$jscomp$inline_60$$);else for(var $JSCompiler_p$jscomp$inline_61$$ in $JSCompiler_parentCtor$jscomp$inline_60$$)if("prototype"!=$JSCompiler_p$jscomp$inline_61$$)if(Object.defineProperties){var $JSCompiler_descriptor$jscomp$inline_62$$=Object.getOwnPropertyDescriptor($JSCompiler_parentCtor$jscomp$inline_60$$,$JSCompiler_p$jscomp$inline_61$$);$JSCompiler_descriptor$jscomp$inline_62$$&&
Object.defineProperty($AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$,$JSCompiler_p$jscomp$inline_61$$,$JSCompiler_descriptor$jscomp$inline_62$$)}else $AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$[$JSCompiler_p$jscomp$inline_61$$]=$JSCompiler_parentCtor$jscomp$inline_60$$[$JSCompiler_p$jscomp$inline_61$$];$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.$superClass_$=$JSCompiler_parentCtor$jscomp$inline_60$$.prototype;
$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.prototype.buildCallback=function(){var $$jscomp$this$jscomp$5$$=this,$viewer$jscomp$4$$=$getServiceForDoc$$module$src$service$$(this.$ampDoc_$,"viewer");return this.$ampDoc_$.whenBodyAvailable().then(function(){return $viewer$jscomp$4$$.getReferrerUrl()}).then(function($viewer$jscomp$4$$){return $$jscomp$this$jscomp$5$$.$referrer_$=$viewer$jscomp$4$$}).then(this.$letsRockIt_$.bind(this))};
$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.prototype.$letsRockIt_$=function(){this.$rewriter_$=new $LinkRewriter$$module$extensions$amp_link_rewriter$0_1$link_rewriter$$(this.$referrer_$,this.element,this.$ampDoc_$);$JSCompiler_StaticMethods_attachClickEvent_$$(this)};
function $JSCompiler_StaticMethods_attachClickEvent_$$($JSCompiler_StaticMethods_attachClickEvent_$self$$){$JSCompiler_StaticMethods_attachClickEvent_$self$$.$navigation_$.registerAnchorMutator(function($anchor$jscomp$3$$){$JSCompiler_StaticMethods_attachClickEvent_$self$$.$rewriter_$.handleClick($anchor$jscomp$3$$)},0)}$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$.prototype.isLayoutSupported=function($layout$jscomp$3$$){return"nodisplay"===$layout$jscomp$3$$};
(function($AMP$jscomp$1$$){$AMP$jscomp$1$$.registerElement("amp-link-rewriter",$AmpLinkRewriter$$module$extensions$amp_link_rewriter$0_1$amp_link_rewriter$$)})(self.AMP);
})});

//# sourceMappingURL=amp-link-rewriter-0.1.js.map
