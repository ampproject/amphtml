language: node_js
sudo: required  # See http://docs.travis-ci.com/user/trusty-ci-environment/
dist: trusty
node_js:
  - "stable"
python:
  - "2.7"
notifications:
  webhooks:
    - http://savage.nonblocking.io:8080/savage/travis
addons:
  sauce_connect: true
  hosts:
    - ads.localhost
    - iframe.localhost
    # Requested by some tests because they need a valid font host,
    # but should not resolve in tests.
    - fonts.googleapis.com
  apt:
    packages:
    - protobuf-compiler
    - python-protobuf
before_install:
  - export CHROME_BIN=google-chrome
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
  - sudo dpkg -i google-chrome*.deb
before_script:
  - pip install --user protobuf
script: node build-system/pr-check.js
branches:
  only:
    - master
    - release
    - canary
    - /^amp-release-.*$/
env:
  global:
    - NPM_CONFIG_PROGRESS="false"
    - secure: VBayrHk04Pp/Masg2korKH40hzkMts54cJIlZ5xbmjmDGGWuD7HJD44WfBHKWKP0p2KEEtmge1WGyLg67CEiqG6FhCT93ex9KNRo51NyhPyG3yzUG7zltSj7iURM3l2115ncKp8wusaoE2KBLJja6q1F7hEse6mgTMG4PzayziUxJmU7qdnK/rBJ0Jqt05alT1ALwy5ahUmjcyumr8u5IkLaecBL84f4TjQA8s7mEWRjD0oTYV2FT44WRVHXvfyo6K5lagp6BAB8wWC38uYUXbHfZhbXNzESE3IXmuvM2fjxQjnaCsyxe+zhA/Hcelud2Qb0rWWVQpW8BvkNiX9ZkGUSb62YhaNf3Y9uYJ9dz9geeqCYq7HG2gHP0As9UHYoNekqA+JGY4c+xlth3sC1yqO1tLwESlwqY6DZav1Hxa9ZIfZmwukP5CsNIP7T6jSP3vF0J9xSTUfK2mOEbI1RbGEAPWS4NPqKCPy21EA0k5m4hq6ZuZoyyNUp61x1etT/G+hi1xg3/5pNS7hGbf/LUY89PI+1F3uMLQZyTUPZXMdDMGQOqzpJLlHg5PljTGS44dONPHw8fidrI2Fj+gGjRtzlzMhA91HuhLIL5g86ku7XI5Bq4ntOuzP0fB54GQAx70YCsnBtU4DiNM02koK+WOFfx5DooCLhqNJlLiczWi0=
    - secure: G/FzEGC3Dc0dECWXNPiJzqXCTmXkUHEHZLvUwVXsIM1lGIcBcRe4ua97A1LOdngg4m8AA0X9/vR/y8nIfBjC8ugq971xbVT35B/qpa3Sqbz7ECFD886KEhXBLIbFBGC82iVKUP/6/nB2M9MFtlYEEDqBI4NPE5iHn9zztJCksAqQ3j8quyNoNsXNXJTUg/y/OygnS5S97hAxZFKYaZ93Y3xEzfWk7/rGuB0QOiRXQpk+OLNFwXvquugVWJRJh9hCb2AfIuZbcHnk6M5iXgUskS+s4ZS5wFpny5CWMmmjFDlEQe6BWcdwte4c2y3plxhlm+UqYkEjWKP0e38lBI29G23YKwUX3JMQ9r9JTgSyYewbVjkOz3HULxEBt13ZWuOKYs3ydtM3Iz5UOYtjjTWzN2WfFr7FIf8oGaLFP9fvwDYuR7xApTiNY4Wm6U0l+PrYZ+tPCu+WZaUrp+qvUBLP33BZmBua8eYezhFW0bziUiVCGzmBLEbgxP2QqXrcVSWmSzxmuI8xxYlWmwaDw3ZzfYzmKHnI8ZuA1+FZ68MbClPZbfqdQGJD9iHsNGuOMaUN2i3ZQNKXd7Xqo/MATtMTIUKl+or3C4+iN0wrfz2bugLHU4iWD4NG8nh8ZccXLFlPWY0xmIr8VOp8t2OXVGDL3cd/tKcXMO/JHPVBRSqrq7k=
cache:
  yarn: true
  directories:
  - node_modules
